/*! @name @brightcove/videojs-ima3 @version 5.4.9 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e),n="7.5.2";
/*! @name videojs-contrib-ads @version 7.5.2 @license Apache-2.0 */var r=function(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}},i=function(e,t,a){r(0,a),e.trigger({type:t+a.type,originalEvent:a})};function o(e){"playing"===e.type?function(e,t){e.ads.isInAdMode()&&(e.ads.isContentResuming()?e.ads._contentEnding&&i(e,"content",t):i(e,"ad",t))}(this,e):"ended"===e.type?function(e,t){e.ads.isInAdMode()?e.ads.isContentResuming()?(r(0,t),e.trigger("resumeended")):i(e,"ad",t):e.ads._contentHasEnded||e.ads.stitchedAds()||(i(e,"content",t),e.trigger("readyforpostroll"))}(this,e):"loadstart"===e.type||"loadeddata"===e.type||"loadedmetadata"===e.type?function(e,t){if(!("loadstart"===t.type&&!e.ads._hasThereBeenALoadStartDuringPlayerLife||"loadeddata"===t.type&&!e.ads._hasThereBeenALoadedData||"loadedmetadata"===t.type&&!e.ads._hasThereBeenALoadedMetaData))if(e.ads.inAdBreak())i(e,"ad",t);else{if(e.currentSrc()!==e.ads.contentSrc)return;i(e,"content",t)}}(this,e):"play"===e.type?function(e,t){e.ads.inAdBreak()?i(e,"ad",t):e.ads.isContentResuming()&&i(e,"content",t)}(this,e):this.ads.isInAdMode()&&(this.ads.isContentResuming()?i(this,"content",e):i(this,"ad",e))}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d.apply(this,arguments)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}var u={},A=function(){!function(e){if(a.default.dom.isInFrame()&&"function"!=typeof window.__tcfapi){for(var t,n=window,r={};n;){try{if(n.frames.__tcfapiLocator){t=n;break}}catch(e){}if(n===window.top)break;n=n.parent}if(!t)return;window.__tcfapi=function(e,a,n,i){var o=Math.random()+"",d={__tcfapiCall:{command:e,parameter:i,version:a,callId:o}};r[o]=n,t.postMessage(d,"*")},window.addEventListener("message",(function(e){var t={};try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){}var a=t.__tcfapiReturn;a&&"function"==typeof r[a.callId]&&(r[a.callId](a.returnValue,a.success),r[a.callId]=null)}),!1)}}(),"function"==typeof window.__tcfapi&&window.__tcfapi("addEventListener",2,(function(e,t){t&&(u=e)}))},c="",g=function(e,t){if(void 0===t&&(t=window),t.__uspapi)t.__uspapi("getUSPData",1,(function(t,a){var n=a?t.uspString:null;c=n,e(n)}));else{var a=function(e){for(var t=e.parent;t!==e.top;){try{if(t.frames&&t.frames.__uspapiLocator)return t}catch(e){}t=t.parent}try{if(e.top.frames&&e.top.frames.__uspapiLocator)return e.top}catch(e){}return null}(t);if(!a)return void e(null);var n=Math.random().toString(36).substring(2),r={__uspapiCall:{command:"getUSPData",version:1,callId:n}};t.addEventListener("message",(function a(r){if(r&&r.data&&r.data.__uspapiReturn&&r.data.__uspapiReturn.callId===n){t.removeEventListener("message",a,!1);var i=r.data.__uspapiReturn,o=i.returnValue,d=i.success?o.uspString:null;c=d,e(d)}}),!1),a.postMessage(r,"*")}},m={AdsBeforePrerollError:"ads-before-preroll-error",AdsPrerollError:"ads-preroll-error",AdsMidrollError:"ads-midroll-error",AdsPostrollError:"ads-postroll-error",AdsMacroReplacementFailed:"ads-macro-replacement-failed",AdsResumeContentFailed:"ads-resume-content-failed"},p=function(e,t){return t?encodeURIComponent(e):e},f=function(e,t){var a={};return["description","tags","reference_id","ad_keys"].forEach((function(n){e&&e[n]?a["{mediainfo."+n+"}"]=e[n]:t["{mediainfo."+n+"}"]?a["{mediainfo."+n+"}"]=t["{mediainfo."+n+"}"]:a["{mediainfo."+n+"}"]=""})),["custom_fields","customFields"].forEach((function(t){!function(e,t,a){if(e&&e[a])for(var n=e[a],r=Object.keys(n),i=0;i<r.length;i++)t["{mediainfo."+a+"."+r[i]+"}"]=n[r[i]]}(e,a,t)})),a},h=function(e,t,n,r,i){for(var o in void 0===r&&(r={}),t){var d=r.hasOwnProperty(o)?r[o]:o;if(d.startsWith("r:"))try{var s=new RegExp(d.slice(2),"g");e=e.replace(s,p(t[o],n))}catch(e){i.ads.error({errorType:m.AdsMacroReplacementFailed,macro:o,error:e}),a.default.log.warn('Unable to replace macro with regex "'+d+'". The provided regex may be invalid.')}else e=e.split(d).join(p(t[o],n))}return e};function y(e,t,n){void 0===t&&(t=!1),void 0===n&&(n={});var r=n.disableDefaultMacros||!1,i=n.macroNameOverrides||{};delete n.disableDefaultMacros,delete n.macroNameOverrides;var o=n;if(r)return h(e,o,t,i);var s,l,A,g=function(e){var t={},a=e.replace(/{([^}=]+)=([^}]*)}/g,(function(e,a,n){return t["{"+a+"}"]=n,"{"+a+"}"}));return{defaults:t,modifiedString:a}}(e),m=g.defaults,p=g.modifiedString;for(var y in e=p,d(o,{"{player.id}":(A=this).options_["data-player"]||A.id_,"{player.height}":A.currentHeight(),"{player.width}":A.currentWidth(),"{player.heightInt}":Math.round(A.currentHeight()),"{player.widthInt}":Math.round(A.currentWidth()),"{player.autoplay}":A.autoplay()?1:0,"{player.muted}":A.muted()?1:0,"{player.language}":A.language()||"","{mediainfo.id}":A.mediainfo?A.mediainfo.id:"","{mediainfo.name}":A.mediainfo?A.mediainfo.name:"","{mediainfo.duration}":A.mediainfo?A.mediainfo.duration:"","{player.duration}":A.duration(),"{player.durationInt}":Math.round(A.duration()),"{player.live}":A.duration()===1/0?1:0,"{player.pageUrl}":a.default.dom.isInFrame()?document.referrer:window.location.href,"{playlistinfo.id}":A.playlistinfo?A.playlistinfo.id:"","{playlistinfo.name}":A.playlistinfo?A.playlistinfo.name:"","{timestamp}":(new Date).getTime(),"{document.referrer}":document.referrer,"{window.location.href}":window.location.href,"{random}":Math.floor(1e12*Math.random())},f(this.mediainfo,m),(s=u,l={},Object.keys(s).forEach((function(e){l["{tcf."+e+"}"]=s[e]})),l["{tcf.gdprAppliesInt}"]=s.gdprApplies?1:0,l),{"{usp.uspString}":c},function(e,t,n){var r=new RegExp("{pageVariable\\.([^}]+)}","g"),i={},o=(e.match(r)||[]).concat(Object.keys(n).filter((function(t){return r.test(t)&&e.includes(n[t])})));if(o)return o.forEach((function(e){for(var n,r=e,o=e.slice(14,-1),d=o.split("."),s=window,l=0;l<d.length;l++)if(l===d.length-1)n=s[d[l]];else if(void 0===(s=s[d[l]]))break;var u=typeof n;null===n?i[r]="null":void 0===n?t[r]?i[r]=t[r]:(a.default.log.warn('Page variable "'+o+'" not found'),i[r]=""):"string"!==u&&"number"!==u&&"boolean"!==u?(a.default.log.warn('Page variable "'+o+'" is not a supported type'),i[r]=""):i[r]=n})),i}(e,m,i)),e=h(e,o,t,i,this),m)e=e.replace(y,m[y]);return e}var v={processMetadataTracks:function(e,t){for(var a=e.textTracks(),n=function(a){"metadata"===a.kind&&(e.ads.cueTextTracks.setMetadataTrackMode(a),t(e,a))},r=0;r<a.length;r++)n(a[r]);a.addEventListener("addtrack",(function(e){n(e.track)}))},setMetadataTrackMode:function(e){},getSupportedAdCue:function(e,t){return t},isSupportedAdCue:function(e,t){return!0},getCueId:function(e,t){return t.id}},S=function(e,t){return void 0!==t&&e.ads.includedCues[t]},C=function(e,t){void 0!==t&&""!==t&&(e.ads.includedCues[t]=!0)};function b(){!1!==this.ads._shouldBlockPlay&&(this.paused()||(this.ads.debug("Playback was canceled by cancelContentPlay"),this.pause()),this.ads._cancelledPlay=!0)}v.processAdTrack=function(e,t,n,r){e.ads.includedCues={};for(var i=0;i<t.length;i++){var o=t[i],d=this.getSupportedAdCue(e,o);if(!this.isSupportedAdCue(e,o))return void a.default.log.warn("Skipping as this is not a supported ad cue.",o);var s=this.getCueId(e,o),l=o.startTime;if(S(e,s))return void a.default.log("Skipping ad already seen with ID "+s);r&&r(e,d,s,l),n(e,d,s,l),C(e,s)}};var M={},_=a.default;M.isMiddlewareMediatorSupported=function(){return!_.browser.IS_IOS&&!_.browser.IS_ANDROID&&!!(_.use&&_.middleware&&_.middleware.TERMINATOR)},M.playMiddleware=function(e){return{setSource:function(e,t){t(null,e)},callPlay:function(){if(e.ads&&!0===e.ads._shouldBlockPlay)return e.ads.debug("Using playMiddleware to block content playback"),e.ads._playBlocked=!0,_.middleware.TERMINATOR},play:function(t,n){e.ads&&e.ads._playBlocked&&t?(e.ads.debug("Play call to Tech was terminated."),e.trigger("play"),e.addClass("vjs-has-started"),e.ads._playBlocked=!1):n&&n.catch&&n.catch((function(t){"NotAllowedError"!==t.name||a.default.browser.IS_SAFARI||e.trigger("pause")}))}}},M.testHook=function(e){_=e};var P=M.playMiddleware,R=M.isMiddlewareMediatorSupported;var T={src:"data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAxJtZGF03ABMYXZjNjEuMy4xMDAAQiAIwRg4AAACrgYF//+q3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2NCByMzEwOCAzMWUxOWY5IC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMyAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTcgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAAn//71sXwKaunqigzoMi7hlyTJrrYi4m0AwABFxzcqWKGahTaoBcQAAMWK4AlcFlIICBeldSEQBGCMHAAABVNtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAAIgABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAACQXRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAIgAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAABQAAAAPAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAACIAAAAAAAEAAAAAAbltZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAADwAAAACAFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAFkbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABJHN0YmwAAADAc3RzZAAAAAAAAAABAAAAsGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABQADwAEgAAABIAAAAAAAAAAEUTGF2YzYxLjMuMTAwIGxpYngyNjQAAAAAAAAAAAAAAAAY//8AAAA2YXZjQwFkAA3/4QAZZ2QADazZQUH7ARAAAAMAEAAAAwPA8UKZYAEABmjr48siwP34+AAAAAAQcGFzcAAAAAEAAAABAAAAFGJ0cnQAAAAAAALAEAACwBAAAAAYc3R0cwAAAAAAAAABAAAAAQAAAgAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAC7wAAAAEAAAAUc3RjbwAAAAAAAAABAAAARQAAAj10cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAAABgAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAAXAAAEAAABAAAAAAG1bWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAACsRAAACABVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAABYG1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABJHN0YmwAAAB+c3RzZAAAAAAAAAABAAAAbm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAACsRAAAAAAANmVzZHMAAAAAA4CAgCUAAgAEgICAF0AVAAAAAAH0AAAAEisFgICABRIQVuUABoCAgAECAAAAFGJ0cnQAAAAAAAH0AAAAEisAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAAVAAAABgAAABhzdGNvAAAAAAAAAAIAAAAwAAADNAAAABpzZ3BkAQAAAHJvbGwAAAACAAAAAf//AAAAHHNiZ3AAAAAAcm9sbAAAAAEAAAACAAAAAQAAAGF1ZHRhAAAAWW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALGlsc3QAAAAkqXRvbwAAABxkYXRhAAAAAQAAAABMYXZmNjEuMS4xMDA=",type:"video/mp4"},k=function(){function e(){}return e.getState=function(t){if(t)return e.states_&&e.states_[t]?e.states_[t]:void 0},e.registerState=function(t,a){if("string"!=typeof t||!t)throw new Error('Illegal state name, "'+t+'"; must be a non-empty string.');return e.states_||(e.states_={}),e.states_[t]=a,a},e}(),w=function(){function e(e){this.player=e}e._getName=function(){return"Anonymous State"};var t=e.prototype;return t.transitionTo=function(e){var t=this.player;this.cleanup(t);var a=new e(t);t.ads._state=a,t.ads.debug(this.constructor._getName()+" -> "+a.constructor._getName());for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];a.init.apply(a,[t].concat(r))},t.init=function(){},t.cleanup=function(){},t.onPlay=function(){},t.onPlaying=function(){},t.onEnded=function(){},t.onAdEnded=function(){},t.onAdsReady=function(){a.default.log.warn("Unexpected adsready event")},t.onAdsError=function(){},t.onAdsCanceled=function(){},t.onAdTimeout=function(){},t.onAdStarted=function(){},t.onAdSkipped=function(){},t.onContentChanged=function(){},t.onContentResumed=function(){},t.onReadyForPostroll=function(){a.default.log.warn("Unexpected readyforpostroll event")},t.onNoPreroll=function(){},t.onNoPostroll=function(){},t.startLinearAdMode=function(){a.default.log.warn("Unexpected startLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.endLinearAdMode=function(){a.default.log.warn("Unexpected endLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.skipLinearAdMode=function(){a.default.log.warn("Unexpected skipLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.isAdState=function(){throw new Error("isAdState unimplemented for "+this.constructor._getName())},t.isWaitingForAdBreak=function(){return!1},t.isContentResuming=function(){return!1},t.inAdBreak=function(){return!1},t.handleEvent=function(e){var t=this.player;"play"===e?this.onPlay(t):"adsready"===e?this.onAdsReady(t):"adserror"===e?this.onAdsError(t):"adscanceled"===e?this.onAdsCanceled(t):"adtimeout"===e?this.onAdTimeout(t):"ads-ad-started"===e?this.onAdStarted(t):"ads-ad-skipped"===e?this.onAdSkipped(t):"contentchanged"===e?this.onContentChanged(t):"contentresumed"===e?this.onContentResumed(t):"readyforpostroll"===e?this.onReadyForPostroll(t):"playing"===e?this.onPlaying(t):"ended"===e?this.onEnded(t):"nopreroll"===e?this.onNoPreroll(t):"nopostroll"===e?this.onNoPostroll(t):"adended"===e&&this.onAdEnded(t)},e}();k.registerState("State",w);var I=function(e){function t(t){var a;return(a=e.call(this,t)||this).contentResuming=!1,a.waitingForAdBreak=!1,a}s(t,e);var a=t.prototype;return a.isAdState=function(){return!0},a.onPlaying=function(){var e=k.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},a.onContentResumed=function(){var e=k.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},a.isWaitingForAdBreak=function(){return this.waitingForAdBreak},a.isContentResuming=function(){return this.contentResuming},a.inAdBreak=function(){return!0===this.player.ads._inLinearAdMode},t}(w);k.registerState("AdState",I);var E=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.isAdState=function(){return!1},a.onContentChanged=function(e){var t=k.getState("BeforePreroll"),a=k.getState("Preroll");e.ads.debug("Received contentchanged event (ContentState)"),e.paused()?this.transitionTo(t):(this.transitionTo(a,!1),e.pause(),e.ads._pausedOnContentupdate=!0)},t}(w);k.registerState("ContentState",E);var B,L=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"AdsDone"};var n=t.prototype;return n.init=function(e){e.ads._contentHasEnded=!0,e.trigger("ended")},n.startLinearAdMode=function(){a.default.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")},t}(k.getState("ContentState"));k.registerState("AdsDone",L);var D={start:function(e){e.ads.debug("Starting ad break"),e.ads._inLinearAdMode=!0,e.trigger("adstart"),e.ads.shouldTakeSnapshots()&&(e.ads.snapshot=function(e){var t;t=a.default.browser.IS_IOS&&e.ads.isLive(e)&&e.seekable().length>0?e.currentTime()-e.seekable().end(0):e.currentTime();var n=e.$(".vjs-tech"),r=e.textTracks?e.textTracks():[],i=[],o={ended:e.ended(),currentSrc:e.currentSrc(),sources:e.currentSources(),src:e.tech_.src(),currentTime:t,type:e.currentType()};n&&(o.style=n.getAttribute("style"));for(var d=0;d<r.length;d++){var s=r[d];i.push({track:s,mode:s.mode}),s.mode="disabled"}return o.suppressedTracks=i,o}(e)),e.ads.shouldPlayContentBehindAd(e)&&!e.ads.settings.stitchedAds&&(e.ads.preAdVolume_=e.volume(),e.volume(0)),e.addClass("vjs-ad-playing"),e.hasClass("vjs-live")&&e.removeClass("vjs-live"),e.ads.removeNativePoster(),e.ads.preAdPlaybackRate_=e.playbackRate(),e.playbackRate(1),e.controlBar&&e.controlBar.playbackRateMenuButton&&e.controlBar.playbackRateMenuButton.playbackRateSupported&&!e.controlBar.playbackRateMenuButton.hasClass("vjs-hidden")?(e.controlBar.playbackRateMenuButton.hide(),e.ads.showPlaybackMenuOnAdEnd_=!0):e.ads.showPlaybackMenuOnAdEnd_=!1},end:function(e,t){e.ads.debug("Ending ad break"),void 0===t&&(t=function(){}),e.ads.adType=null,e.ads._inLinearAdMode=!1,e.trigger("adend"),e.removeClass("vjs-ad-playing"),e.ads.isLive(e)&&e.addClass("vjs-live"),e.ads.shouldTakeSnapshots()?function(e,t){var n=e.ads.snapshot;if(void 0===t&&(t=function(){}),!0===e.ads.disableNextSnapshotRestore)return e.ads.disableNextSnapshotRestore=!1,delete e.ads.snapshot,void t();var r,i=e.$(".vjs-tech"),o=20,d=n.suppressedTracks,s=function(){for(var e=0;e<d.length;e++)(r=d[e]).track.mode=r.mode},l=function(){var t;if(a.default.browser.IS_IOS&&e.ads.isLive(e)){if(n.currentTime<0&&(t=e.seekable().length>0?e.seekable().end(0)+n.currentTime:e.currentTime(),e.currentTime(t)),e.paused()){var r=e.play();r&&r.catch&&r.catch((function(e){a.default.log.warn("Play promise rejected in IOS snapshot resume",e)}))}}else if(n.ended)e.currentTime(e.duration());else{e.currentTime(n.currentTime);var i=e.play();i&&i.catch&&i.catch((function(e){a.default.log.warn("Play promise rejected in snapshot resume",e)}))}e.ads.shouldRemoveAutoplay_&&(e.autoplay(!1),e.ads.shouldRemoveAutoplay_=!1)},u=function t(){if(e.off("contentcanplay",t),B&&e.clearTimeout(B),(i=e.el().querySelector(".vjs-tech")).readyState>1)return l();if(void 0===i.seekable)return l();if(i.seekable.length>0)return l();if(o--)e.setTimeout(t,50);else try{l()}catch(t){e.ads.error({errorType:m.AdsResumeContentFailed,error:t}),a.default.log.warn("Failed to resume the content after an advertisement",t)}};if("style"in n&&i.setAttribute("style",n.style||""),e.ads.videoElementRecycled())e.one("resumeended",(function(){delete e.ads.snapshot,t()})),e.one("contentloadedmetadata",s),a.default.browser.IS_IOS&&!e.autoplay()&&"function"==typeof e.techCall_&&(e.techCall_("setAutoplay",!0),e.ads.shouldRemoveAutoplay_=!0),e.src(n.sources),e.one("contentcanplay",u),B=e.setTimeout(u,2e3);else{if(s(),!e.ended()){var A=e.play();A&&A.catch&&A.catch((function(e){a.default.log.warn("Play promise rejected in snapshot restore",e)}))}delete e.ads.snapshot,t()}}(e,t):(e.ads.preAdVolume_&&e.volume(e.ads.preAdVolume_),t()),e.playbackRate(e.ads.preAdPlaybackRate_),e.ads.showPlaybackMenuOnAdEnd_&&e.controlBar.playbackRateMenuButton.show()}},O=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Preroll"};var n=t.prototype;return n.init=function(e,t,a){if(this.waitingForAdBreak=!0,e.addClass("vjs-ad-loading"),a||e.ads.nopreroll_)return this.resumeAfterNoPreroll(e);var n=e.ads.settings.timeout;"number"==typeof e.ads.settings.prerollTimeout&&(n=e.ads.settings.prerollTimeout),this._timeout=e.setTimeout((function(){e.trigger("adtimeout")}),n),t?this.handleAdsReady():this.adsReady=!1},n.onAdsReady=function(e){e.ads.inAdBreak()?a.default.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.handleAdsReady=function(){this.adsReady=!0,this.readyForPreroll()},n.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",(function(){t.ads.debug("Received loadstart event"),e()})))},n.noPreroll=function(){var e=this;this.afterLoadStart((function(){e.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)"),e.resumeAfterNoPreroll(e.player)}))},n.readyForPreroll=function(){var e=this.player;this.afterLoadStart((function(){e.ads.debug("Triggered readyforpreroll event (Preroll)"),e.trigger("readyforpreroll")}))},n.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (Preroll)"),this.afterLoadStart((function(){t.resumeAfterNoPreroll(e)}))},n.onAdsError=function(e){var t=this;a.default.log("adserror (Preroll)"),e.ads.error({errorType:m.AdsPrerollError}),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart((function(){t.resumeAfterNoPreroll(e)}))},n.startLinearAdMode=function(){var e=this.player;!this.adsReady||e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected startLinearAdMode invocation (Preroll)"):(this.clearTimeout(e),e.ads.adType="preroll",this.waitingForAdBreak=!1,D.start(e),e.ads._shouldBlockPlay=!1)},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(e.removeClass("vjs-ad-loading"),e.addClass("vjs-ad-content-resuming"),this.contentResuming=!0,D.end(e))},n.skipLinearAdMode=function(){var e=this,t=this.player;t.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart((function(){t.trigger("adskip"),t.ads.debug("skipLinearAdMode (Preroll)"),e.resumeAfterNoPreroll(t)}))},n.onAdTimeout=function(e){var t=this;this.afterLoadStart((function(){e.ads.debug("adtimeout (Preroll)"),t.resumeAfterNoPreroll(e)}))},n.onNoPreroll=function(e){e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected nopreroll event (Preroll)"):this.noPreroll()},n.resumeAfterNoPreroll=function(e){if(this.contentResuming=!0,e.ads._shouldBlockPlay=!1,this.cleanupPartial(e),e.ads._playRequested||e.ads._pausedOnContentupdate)if(e.paused()){e.ads.debug("resumeAfterNoPreroll: attempting to resume playback (Preroll)");var t=e.play();t&&t.then&&t.then(null,(function(e){}))}else e.ads.debug("resumeAfterNoPreroll: already playing (Preroll)"),e.trigger("play"),e.trigger("playing")},n.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||a.default.log.warn("Leaving Preroll state before loadstart event can cause issues."),this.cleanupPartial(e)},n.cleanupPartial=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),this.clearTimeout(e)},n.clearTimeout=function(e){e.clearTimeout(this._timeout),this._timeout=null},t}(k.getState("AdState"));k.registerState("Preroll",O);var N=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"BeforePreroll"};var a=t.prototype;return a.init=function(e){this.adsReady=!1,this.shouldResumeToContent=!1,e.ads._shouldBlockPlay=!e.ads.settings.allowVjsAutoplay||!e.autoplay()},a.onAdsReady=function(e){e.ads.debug("Received adsready event (BeforePreroll)"),this.adsReady=!0},a.onPlay=function(e){var t=k.getState("Preroll");e.ads.debug("Received play event (BeforePreroll)"),this.transitionTo(t,this.adsReady,this.shouldResumeToContent)},a.onAdsCanceled=function(e){e.ads.debug("adscanceled (BeforePreroll)"),this.shouldResumeToContent=!0},a.onAdsError=function(){this.player.ads.debug("adserror (BeforePreroll)"),this.player.ads.error({errorType:m.AdsBeforePrerollError}),this.shouldResumeToContent=!0},a.onNoPreroll=function(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)"),this.shouldResumeToContent=!0},a.skipLinearAdMode=function(){var e=this.player;e.trigger("adskip"),e.ads.debug("skipLinearAdMode (BeforePreroll)"),this.shouldResumeToContent=!0},a.onContentChanged=function(){this.init(this.player)},t}(k.getState("ContentState"));k.registerState("BeforePreroll",N);var j=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Midroll"};var a=t.prototype;return a.init=function(e){e.ads.adType="midroll",D.start(e),e.addClass("vjs-ad-loading")},a.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},a.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(this.contentResuming=!0,e.addClass("vjs-ad-content-resuming"),e.removeClass("vjs-ad-loading"),D.end(e))},a.onAdsError=function(e){e.ads.error({errorType:m.AdsMidrollError}),this.inAdBreak()&&e.ads.endLinearAdMode()},a.cleanup=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming")},t}(k.getState("AdState"));k.registerState("Midroll",j);var q=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Postroll"};var n=t.prototype;return n.init=function(e){if(this.waitingForAdBreak=!0,e.ads._contentEnding=!0,e.ads.nopostroll_){this.resumeContent(e);var t=k.getState("AdsDone");this.transitionTo(t)}else{e.addClass("vjs-ad-loading");var a=e.ads.settings.timeout;"number"==typeof e.ads.settings.postrollTimeout&&(a=e.ads.settings.postrollTimeout),this._postrollTimeout=e.setTimeout((function(){e.trigger("adtimeout")}),a)}},n.startLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected startLinearAdMode invocation (Postroll)"):(e.ads.adType="postroll",e.clearTimeout(this._postrollTimeout),this.waitingForAdBreak=!1,D.start(e))},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this,t=this.player,a=k.getState("AdsDone");this.inAdBreak()&&(t.removeClass("vjs-ad-loading"),this.resumeContent(t),D.end(t,(function(){e.transitionTo(a)})))},n.skipLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected skipLinearAdMode invocation"):(e.ads.debug("Postroll abort (skipLinearAdMode)"),e.trigger("adskip"),this.abort(e))},n.onAdTimeout=function(e){e.ads.debug("Postroll abort (adtimeout)"),this.abort(e)},n.onAdsError=function(e){e.ads.debug("Postroll abort (adserror)"),e.ads.error({errorType:m.AdsPostrollError}),e.ads.inAdBreak()?e.ads.endLinearAdMode():this.abort(e)},n.onContentChanged=function(e){if(this.isContentResuming()){var t=k.getState("BeforePreroll");this.transitionTo(t)}else if(!this.inAdBreak()){var a=k.getState("Preroll");this.transitionTo(a)}},n.onNoPostroll=function(e){this.isContentResuming()||this.inAdBreak()?a.default.log.warn("Unexpected nopostroll event (Postroll)"):this.abort(e)},n.resumeContent=function(e){this.contentResuming=!0,e.addClass("vjs-ad-content-resuming")},n.abort=function(e){var t=k.getState("AdsDone");this.resumeContent(e),e.removeClass("vjs-ad-loading"),this.transitionTo(t)},n.cleanup=function(e){e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._postrollTimeout),e.ads._contentEnding=!1},t}(k.getState("AdState"));k.registerState("Postroll",q);var U=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"ContentPlayback"};var a=t.prototype;return a.init=function(e){e.ads._shouldBlockPlay=!1},a.onAdsReady=function(e){e.ads.debug("Received adsready event (ContentPlayback)"),e.ads.nopreroll_||(e.ads.debug("Triggered readyforpreroll event (ContentPlayback)"),e.trigger("readyforpreroll"))},a.onReadyForPostroll=function(e){var t=k.getState("Postroll");e.ads.debug("Received readyforpostroll event"),this.transitionTo(t)},a.startLinearAdMode=function(){var e=k.getState("Midroll");this.transitionTo(e)},t}(k.getState("ContentState"));k.registerState("ContentPlayback",U);var x=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"StitchedContentPlayback"};var a=t.prototype;return a.init=function(){this.player.ads._shouldBlockPlay=!1},a.onContentChanged=function(){this.player.ads.debug("Received contentchanged event ("+this.constructor._getName()+")")},a.startLinearAdMode=function(){var e=k.getState("StitchedAdRoll");this.transitionTo(e)},t}(k.getState("ContentState"));k.registerState("StitchedContentPlayback",x);var V=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"StitchedAdRoll"};var a=t.prototype;return a.init=function(){this.waitingForAdBreak=!1,this.contentResuming=!1,this.player.ads.adType="stitched",D.start(this.player)},a.onPlaying=function(){},a.onContentResumed=function(){},a.onAdEnded=function(){this.endLinearAdMode(),this.player.trigger("ended")},a.endLinearAdMode=function(){var e=k.getState("StitchedContentPlayback");D.end(this.player),this.transitionTo(e)},t}(k.getState("AdState"));k.registerState("StitchedAdRoll",V);var F=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"OutstreamPending"};var a=t.prototype;return a.init=function(e){this.adsReady=!1},a.onPlay=function(e){var t=k.getState("OutstreamPlayback");e.ads.debug("Received play event (OutstreamPending)"),this.transitionTo(t,this.adsReady)},a.onAdsReady=function(e){e.ads.debug("Received adsready event (OutstreamPending)"),this.adsReady=!0},a.onAdsError=function(){this.player.ads.debug("adserror (OutstreamPending)"),this.adsReady=!1},t}(k.getState("AdState"));k.registerState("OutstreamPending",F);var H=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"OutstreamPlayback"};var n=t.prototype;return n.init=function(e,t){e.addClass("vjs-ad-loading"),t?this.handleAdsReady():this.abort(e)},n.onAdsReady=function(e){e.ads.inAdBreak()?a.default.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.abort=function(e){var t=k.getState("OutstreamDone");e.removeClass("vjs-ad-loading"),this.transitionTo(t)},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.handleAdsReady=function(){this.adsReady=!0,this.readyForOutstreamPlayback()},n.readyForOutstreamPlayback=function(){var e=this.player;this.afterLoadStart((function(){e.trigger("readyforoutstream")}))},n.startLinearAdMode=function(){var e=this.player;this.adsReady&&!e.ads.inAdBreak()&&D.start(e)},n.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||a.default.log.warn("Leaving OutstreamPlayback state before loadstart event can cause issues."),this.cleanupPartial(e)},n.cleanupPartial=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),this.clearTimeout(e)},n.clearTimeout=function(e){e.clearTimeout(this._timeout),this._timeout=null},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.onAdsError=function(e){var t=this;a.default.log("adserror (OutstreamPlayback)"),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart((function(){t.abort(e)}))},n.onAdTimeout=function(e){var t=this;this.afterLoadStart((function(){e.ads.debug("adtimeout (OutstreamPlayback)"),t.abort(e)}))},n.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (OutstreamPlaybac)"),this.afterLoadStart((function(){t.abort(e)}))},n.endLinearAdMode=function(){var e=this;if(this.inAdBreak()){this.player.removeClass("vjs-ad-loading");var t=k.getState("OutstreamDone");D.end(this.player,(function(){e.transitionTo(t)}))}},n.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",(function(){t.ads.debug("Received loadstart event"),e()})))},n.skipLinearAdMode=function(){var e=this,t=this.player,n=k.getState("OutstreamDone");this.inAdBreak()?a.default.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart((function(){t.trigger("adskip"),t.ads.debug("skipLinearAdMode (OutstreamPlayback)"),e.transitionTo(n)}))},t}(k.getState("AdState"));k.registerState("OutstreamPlayback",H);var W=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"OutstreamDone"};var n=t.prototype;return n.init=function(e){e.trigger("ended")},n.startLinearAdMode=function(){a.default.log.warn("Unexpected startLinearAdMode invocation (OutstreamDone)")},t}(k.getState("AdState"));k.registerState("OutstreamDone",W);var G=M.isMiddlewareMediatorSupported,Z=a.default.getTech("Html5").Events,Q={timeout:5e3,prerollTimeout:void 0,postrollTimeout:void 0,debug:!1,stitchedAds:!1,contentIsLive:void 0,liveCuePoints:!0,allowVjsAutoplay:a.default.options.normalizeAutoplay||!1},Y=function(e){var t=this,r=a.default.obj.merge(Q,e),i=[];Z.concat(["firstplay","loadedalldata"]).forEach((function(e){-1===i.indexOf(e)&&i.push(e)})),t.on(i,o),G()||function(e,t){t&&a.default.log("Using cancelContentPlay to block content playback"),e.on("play",b)}(t,r.debug),t.setTimeout((function(){t.ads._hasThereBeenALoadStartDuringPlayerLife||""===t.src()||a.default.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds after being initialized, but a source is present. This indicates that videojs-contrib-ads was initialized too late. It must be initialized immediately after video.js in the same tick. As a result, some ads will not play and some media events will be incorrect. For more information, see http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")}),5e3),t.on("ended",(function(){t.hasClass("vjs-has-started")||t.addClass("vjs-has-started")})),t.on("contenttimeupdate",(function(){t.removeClass("vjs-waiting")})),t.on(["addurationchange","adcanplay"],(function(){if(!t.ads.settings.stitchedAds&&!t.hasStarted()&&(!t.ads.snapshot||t.currentSrc()!==t.ads.snapshot.currentSrc)&&t.ads.inAdBreak()){var e=t.play();e&&e.catch&&e.catch((function(e){a.default.log.warn("Play promise rejected when playing ad",e)}))}})),t.on("nopreroll",(function(){t.ads.debug("Received nopreroll event"),t.ads.nopreroll_=!0})),t.on("nopostroll",(function(){t.ads.debug("Received nopostroll event"),t.ads.nopostroll_=!0})),t.on("playing",(function(){t.ads._cancelledPlay=!1,t.ads._pausedOnContentupdate=!1})),t.on("play",(function(){t.ads._playRequested=!0})),t.one("loadstart",(function(){t.ads._hasThereBeenALoadStartDuringPlayerLife=!0})),t.on("loadeddata",(function(){t.ads._hasThereBeenALoadedData=!0})),t.on("loadedmetadata",(function(){t.ads._hasThereBeenALoadedMetaData=!0})),t.ads=function(e){return{disableNextSnapshotRestore:!1,_contentEnding:!1,_contentHasEnded:!1,_hasThereBeenALoadStartDuringPlayerLife:!1,_hasThereBeenALoadedData:!1,_hasThereBeenALoadedMetaData:!1,_inLinearAdMode:!1,_shouldBlockPlay:!1,_playBlocked:!1,_playRequested:!1,_error:null,adType:null,VERSION:n,reset:function(){e.ads.disableNextSnapshotRestore=!1,e.ads._contentEnding=!1,e.ads._contentHasEnded=!1,e.ads.snapshot=null,e.ads.adType=null,e.ads._hasThereBeenALoadedData=!1,e.ads._hasThereBeenALoadedMetaData=!1,e.ads._cancelledPlay=!1,e.ads._shouldBlockPlay=!1,e.ads._playBlocked=!1,e.ads.nopreroll_=!1,e.ads.nopostroll_=!1,e.ads._playRequested=!1,e.ads._error=null},startLinearAdMode:function(){e.ads._state.startLinearAdMode()},endLinearAdMode:function(){e.ads._state.endLinearAdMode()},skipLinearAdMode:function(){e.ads._state.skipLinearAdMode()},stitchedAds:function(e){return void 0!==e&&(a.default.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, it should be set as an option upon initialization of contrib-ads."),this.settings.stitchedAds=!!e),this.settings.stitchedAds},videoElementRecycled:function(){if(e.ads.shouldPlayContentBehindAd(e))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var t=e.tech_.src()!==this.snapshot.src,a=e.currentSrc()!==this.snapshot.currentSrc;return t||a},isLive:function(t){return void 0===t&&(t=e),"boolean"==typeof t.ads.settings.contentIsLive?t.ads.settings.contentIsLive:t.duration()===1/0||"8"===a.default.browser.IOS_VERSION&&0===t.duration()},shouldPlayContentBehindAd:function(t){if(void 0===t&&(t=e),t)return!!t.ads.settings.liveCuePoints&&!a.default.browser.IS_IOS&&!a.default.browser.IS_ANDROID&&t.duration()===1/0;throw new Error("shouldPlayContentBehindAd requires a player as a param")},shouldTakeSnapshots:function(t){return void 0===t&&(t=e),!this.shouldPlayContentBehindAd(t)&&!this.stitchedAds()},isInAdMode:function(){return this._state.isAdState()},isWaitingForAdBreak:function(){return this._state.isWaitingForAdBreak()},isContentResuming:function(){return this._state.isContentResuming()},isAdPlaying:function(){return this._state.inAdBreak()},inAdBreak:function(){return this._state.inAdBreak()},removeNativePoster:function(){var t=e.$(".vjs-tech");t&&t.removeAttribute("poster")},debug:function(){if(this.settings.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&"string"==typeof t[0]?a.default.log("ADS: "+t[0]):a.default.log.apply(a.default,["ADS:"].concat(t))}},error:function(t){if(void 0===t)return this._error||null;null!==t&&t.errorType?(this._error=t,a.default.log.error("An error with Ads occured. Type: "+t.errorType+"."),e.trigger({type:"vjsadserror",error:this._error})):this._error=null}}}(t),t.ads.settings=r,r.stitchedAds=!!r.stitchedAds,"outstream"===r.playerMode?(t.src(T),t.ads._state=new(k.getState("OutstreamPending"))(t)):r.stitchedAds?t.ads._state=new(k.getState("StitchedContentPlayback"))(t):t.ads._state=new(k.getState("BeforePreroll"))(t),t.ads._state.init(t),t.ads.cueTextTracks=v,t.ads.adMacroReplacement=y.bind(t),function(e){e.ads.contentSrc=e.currentSrc(),e.ads._seenInitialLoadstart=!1,e.on("loadstart",(function(){if(!e.ads.inAdBreak()){var t=e.currentSrc();t!==e.ads.contentSrc&&(e.ads._seenInitialLoadstart&&e.trigger({type:"contentchanged"}),e.trigger({type:"contentupdate",oldValue:e.ads.contentSrc,newValue:t}),e.ads.contentSrc=t),e.ads._seenInitialLoadstart=!0}}))}(t),t.on("contentchanged",t.ads.reset);var d=function(){var e=t.textTracks();if(!t.ads.shouldPlayContentBehindAd(t)&&t.ads.inAdBreak()&&t.tech_.featuresNativeTextTracks&&a.default.browser.IS_IOS&&!Array.isArray(t.textTracks()))for(var n=0;n<e.length;n++){var r=e[n];"showing"===r.mode&&(r.mode="disabled")}};t.ready((function(){t.textTracks().addEventListener("change",d)})),t.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","ads-ad-skipped","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],(function(e){t.ads._state.handleEvent(e.type)})),t.on("dispose",(function(){t.ads.reset(),t.textTracks().removeEventListener("change",d)})),A(),g((function(){})),t.ads.listenToTcf=A,t.ads.updateUsPrivacyString=function(e){return g(e)}};Y.Error=m,Y.VERSION=n,function(e){!function(){if(a.default.getPlugin)return Boolean(a.default.getPlugin("ads"));var e=a.default.getComponent("Player");return Boolean(e&&e.prototype.ads)}()&&((a.default.registerPlugin||a.default.plugin)("ads",e),R()&&!a.default.usingContribAdsMiddleware_&&(a.default.use("*",P),a.default.usingContribAdsMiddleware_=!0,a.default.log.debug("Play middleware has been registered with videojs")))}(Y);(a.default.registerPlugin||a.default.plugin)("contribAds6Shim",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=void 0,r=void 0,i=0,o=!1;this.contribAds6Shim={VERSION:"1.0.1"},t.ads.state=n=r="content-set",Object.defineProperty(t.ads,"state",{get:function(){return(!0===e.warnOnGetState||"number"==typeof e.warnOnGetState&&i<e.warnOnGetState)&&(a.default.log.warn("player.ads.state is deprecated. Please use the public methods provided by videojs-contrib-ads 6 instead: https://github.com/videojs/videojs-contrib-ads#public-methods"),i++),e.stateUsageEvent&&!o&&(t.trigger({type:"usage",name:"contrib-ads-state-access"}),o=!0),r},set:function(t){t!==r&&(n=r,r=t,e.debug&&a.default.log("CA6Shim: "+n+" -> "+r))}}),t.on("contentchanged",(function(){t.paused()?t.ads.state="content-set":t.ads.state="ads-ready?"})),t.on("play",(function(){"content-set"===r?t.ads.state="ads-ready?":"ads-ready"===r&&(t.ads.state="preroll?")})),t.on("adsready",(function(){"content-set"===r?t.ads.state="ads-ready":"ads-ready?"===r&&(t.ads.state="preroll?")})),t.on(["adserror","adtimeout","adskip"],(function(){"ads-ready?"!==r&&"preroll?"!==r||(t.ads.state="content-playback")})),t.on("adstart",(function(){t.ads.state="ad-playback"})),t.on("adend",(function(){t.ads.state="content-resuming"})),t.on("playing",(function(){"content-playback"!==r&&(t.trigger("contentplayback"),e.debug&&a.default.log("CA6Shim: Triggered contentplayback")),t.ads.state="content-playback"})),t.on("contentended",(function(){"content-playback"===r&&(t.ads.state="postroll?")})),t.on("ended",(function(){t.ads.state="content-playback"}))}));const z={VmapCancelledError:"ima-vmap-cancelled-error",AdsManagerStartError:"ima-ads-manager-start-error",InvalidVpaidMode:"ima-invalid-vpaid-mode",SdkLoadError:"ima-sdk-load-error",NoAdAvailable:"ima-no-ad-available",InvalidCueError:"ima-invalid-cue-error",CueParsingError:"ima-cue-parsing-error"};let X;const J=function(e,t){const a=t.cues,n=t.label,r=t.inBandMetadataTrackDispatchType,i=t.kind;if("metadata"===i)return"media-cues"===n||(!(!r||"metadata"!==i)||(!a||!a.length||e.ima3.cueState_.cueModule.isSupportedAdCue(e,a[0])))},$=function(e,t,a,n,r){0===n&&e.ima3.cueState_.prerollPlayed||r<=1&&e.ima3.cueState_.postrollPlayed||(!function(e,t,a){const n=Math.abs(a-e.duration()),r=Math.abs(a-e.currentTime());let i;if(0===a){if(e.ima3.cueState_.prerollPlayed)return;e.ima3.cueState_.prerollPlayed=!0,e.ads.adType="preroll"}if(n<=1){if(e.ima3.cueState_.postrollPlayed)return;e.ima3.cueState_.postrollPlayed=!0}r>=1||(i=!e.ima3.settings.useMediaCuePoints&&t.serverUrl?t.serverUrl:e.ima3.settings.serverUrl,i=e.ima3.adMacroReplacement(i),t.duration&&(/\?/.test(i)?i+="&breaklength="+t.duration:i+="?breaklength="+t.duration),e.ima3.isReady_&&(e.ima3.log(`Oncue ad request at ${a} seconds`),e.ima3.adrequest(i)))}(e,t,n),e.ima3.cueState_.usedActiveCues[a]=!0)},K=function(e,t,a,n,r){0===n&&0===e.currentTime()&&(e.ima3.cueState_.prerollPlayed||e.ima3.cueState_.prerollHandledEarly||(e.paused()&&!e.ads._playRequested?(e.ima3.cueState_.prerollHandledEarly=!0,e.ima3.oneUnlessContentUpdate_("play",(()=>{$(e,t,a,n,r)}))):e.ads.isInAdMode()&&!e.ads.isContentResuming()&&e.ads._playRequested&&$(e,t,a,n,r)))},ee=function(e){return e.mediainfo?Math.max(e.duration(),e.mediainfo.duration):e.duration()},te=function(e,t,a,n){const r=ee(e),i=Math.abs(n-r);if(!e.ads.isAdPlaying()||!((o=t)&&o.text&&"ad"===o.text.toLowerCase()||o&&o.name&&"adcue"===o.name.toLowerCase())){if(!a)return e.ads.error({errorType:z.InvalidCueError,cueName:t.name&&t.name.toLowerCase()}),void e.ima3.log.error("The cue does not have an ID and cannot be used",t);var o;if(!e.ima3.cueState_.usedActiveCues[a])if(!t.name||"adcancel"!==t.name.toLowerCase())0===n?K(e,t,a,n,i):i<=1&&!e.ima3.cueState_.postrollHandled?(e.ima3.cueState_.postrollHandled=!0,e.ima3.oneUnlessContentUpdate_("contentended",(()=>{$(e,t,a,n,i)}))):e.ima3.isReady_&&!e.ads.isInAdMode()&&$(e,t,a,n,i)}},ae=function(e,t,a,n){e.ima3.settings.useMediaCuePoints||"adCancel"!==t.name||!e.ima3.adsManager||e.ima3.cueState_.usedActiveCues[a]||(e.ima3.cueState_.usedActiveCues[a]=!0,e.ima3.adsManager.stop(),e.ima3.log("Cancelling oncue ad at "+n+" seconds"))},ne=function(e){return function(){const t=this.activeCues;if(!e.scrubbing()&&t&&t.length){const a=[t[t.length-1]];if(!J(e,this))return void this.removeEventListener("cuechange",e.ima3.cueState_.adCueChangeHandler);e.ima3.cueState_.cueModule.processAdTrack(e,a,te,ae)}}},re=function(e,t){const a=t.cues;let n,r;if(J(e,t)){if(a&&void 0!==a.length){for(let t=0;t<a.length;t++){const i=e.mediainfo?Math.max(e.duration(),e.mediainfo.duration):e.duration();Math.abs(a[t].startTime-i)<=1?n=a[t]:0===a[t].startTime&&(r=a[t])}if(r||"media-cues"!==t.label){if(r){const t=e.ima3.cueState_.cueModule.getSupportedAdCue(e,r),a=e.ima3.cueState_.cueModule.getCueId(e,r),n=r.startTime,i=Math.abs(n-ee(e));K(e,t,a,n,i)}}else e.trigger("nopreroll");n||"media-cues"!==t.label||e.trigger("nopostroll")}t.addEventListener("cuechange",e.ima3.cueState_.adCueChangeHandler)}};X={init:(e,t)=>{t.useMediaCuePoints||e.on("loadedmetadata",(()=>{e.trigger("nopreroll"),X.liveCuePointHandler(e,e.ads.cueTextTracks)})),e.trigger("adsready"),e.on("contentchanged",(()=>{e.trigger("adsready")}))},liveCuePointHandler:(e,t)=>{!function(e,t){e.ima3.cueState_={cueModule:t,adCueChangeHandler:ne(e),usedActiveCues:{},prerollHandledEarly:!1,prerollPlayed:!1,postrollHandled:!1,postrollPlayed:!1}}(e,t),e.ima3.cueState_.cueModule.setMetadataTrackMode=function(e){e.mode="hidden"},e.ima3.cueState_.cueModule.getCueId=function(e,t){const a=e.ima3.cueState_.cueModule.getSupportedAdCue(e,t);return a?a.id:null},e.ima3.cueState_.cueModule.isSupportedAdCue=function(e,t){return null!==e.ima3.cueState_.cueModule.getSupportedAdCue(e,t)},e.ima3.cueState_.cueModule.getSupportedAdCue=function(e,t){return"oncue"!==e.ima3.settings.requestMode||e.ima3.settings.useMediaCuePoints?null:function(e,t){let n;if(t&&!t.value||"TXXX"!==t.value.key)return null;try{n=JSON.parse(t.value.data)}catch(t){return e.ads.error({errorType:z.CueParsingError,cueName:n.name&&n.name.toLowerCase()}),a.default.log.error("ERROR: Parsing JSON. Please confirm that JSON is valid.",t.message),null}if(!n.name)return null;const r=n.name.toLowerCase();return"adcue"!==r&&"adcancel"!==r?null:n}(e,t)},e.ima3.cueState_.cueModule.processMetadataTracks(e,re)}};var ie=X;function oe(e){let t=!1,n=!1,r=null,i=null;const o=()=>{e.tech(!0).trigger("durationchange"),e.trigger("timeupdate"),e.trigger("progress")};e.on("ima3-started",(function(){e.removeClass("vjs-ima3-paused"),e.trigger("play"),t=!1,e.ads.inAdBreak()&&!e.ads.videoElementRecycled()&&(r=e.volume(),i=e.muted())})),e.on("ads-ad-started",(function(){n=!0,"boolean"==typeof i&&i?e.muted(i):"number"==typeof r&&e.volume(r),o()})),e.on("ima3-resumed",(function(){e.removeClass("vjs-ima3-paused"),e.trigger("play"),t=!1})),e.on("ima3-paused",(function(){e.addClass("vjs-ima3-paused"),e.trigger("pause"),t=!0})),e.on(["ima3-complete","ima3-content-resume-requested"],(function(){n=!1,o()}));const d=t=>a=>e.usingPlugin("ima3")&&e.ads.isAdPlaying()&&e.ima3.adsManager&&n?t(a):a;return{currentTime:d((function(){const t=e.duration();if("number"!=typeof t||!e.ima3.adsManager)return 0;const a=e.ima3.adsManager.getRemainingTime();return"number"!=typeof a||a<=0||a>t?0:t-a})),duration:d((function(){const t=e.ima3.currentAd;if(!t)return 0;const a=t.getDuration();return a>0?a:0})),buffered:d((function(t){const n=[],r=e.duration();for(let e=0;e<t.length;e++){const a=t.start(e),i=t.end(e);a>r||(i>r?n.push([a,r]):n.push([a,i]))}return a.default.createTimeRanges(n)})),callPause:d((function(){return t=!0,e.ima3.adsManager.pause(),e.trigger("pause"),a.default.middleware.TERMINATOR})),paused:d((function(){return t})),callPlay:d((function(){return t=!1,e.ima3.adsManager.resume(),e.trigger("play"),a.default.middleware.TERMINATOR})),setVolume:d((function(t){return e.ima3.adsManager.setVolume(t),e.ima3.volume=t,e.trigger("volumechange"),t})),volume:d((function(){return e.ima3.adsManager.getVolume()||e.ima3.volume})),setMuted:d((function(t){return e.ima3.adsManager.setVolume(t?0:e.ima3.volume||1),t})),muted:d((function(){return 0===e.ima3.adsManager.getVolume()})),ended:d((function(){return!1}))}}function de(e){if("string"!=typeof e)return;const t=e.match(/^([\d]+)\.([\d]+)\.([\d]+)/);return t?[Number(t[1]),Number(t[2]),Number(t[3])]:void 0}const se=de("7.5.2");function le(e){return a.default.getPlugin?a.default.getPlugin(e):a.default.getComponent("Player").prototype[e]}let ue;function Ae(e){return{width:parseInt(ue.computedStyle(e.el(),"width"),10),height:parseInt(ue.computedStyle(e.el(),"height"),10)}}function ce(e){if(+e<0)return a.default.log.error("duration "+e+" can't be a negative number"),"00:00:00.000";if(+e>=86400)return a.default.log.error("duration "+e+" can't be over 24h"),"00:00:00.000";const t=1e3*e;let n=parseInt(t%1e3,10),r=parseInt(t/1e3%60,10),i=parseInt(t/6e4%60,10),o=parseInt(t/36e5%24,10);return o=o<10?"0"+o:o,i=i<10?"0"+i:i,r=r<10?"0"+r:r,n<10?n="00"+n:n<100&&(n="0"+n),o+":"+i+":"+r+"."+n}function ge(e){e.ima3.adsManager&&(e.ima3.log("[util.destroyAdsManager] Call AdsManager.destroy."),e.ima3.adsManager.destroy(),e.ima3.adsManager=null),e.ima3.managerCleanup&&(e.ima3.managerCleanup(),e.ima3.managerCleanup=null)}function me(e){for(let t=1;t<arguments.length;t++){const a=arguments[t];for(const t in a)a.hasOwnProperty(t)&&(e[t]=a[t])}return e}const pe=e=>{const t=e.ima3.ad;if(void 0!==t)return"application/javascript"===t.getContentType();throw e.ads.error({errorType:z.NoAdAvailable}),new Error("Cannot check if the current ad is a VPAID when there is no ad.")},fe=e=>!(!e||0!==e.getCuePoints().length),he=e=>e&&"object"==typeof e&&"function"==typeof e.trigger;function ye(e,t){e&&e.bcAnalytics&&e.bcAnalytics.insightsBeacons&&"function"==typeof e.bcAnalytics.insightsBeacons[t]&&e.bcAnalytics.insightsBeacons[t]()}const ve=e=>{let t=!1;try{t=new URL(e)}catch(e){}return t};ue={assignIfTruthy:(e,t,a)=>{a&&(e[t]=a)},computedStyle:function(e,t){return"function"==typeof getComputedStyle?window.getComputedStyle(e)[t]:e.currentStyle[t]},destroyAdsManager:ge,extend:me,getPlayerDimensions:Ae,includesPostroll:e=>e.getCuePoints().indexOf(-1)>=0,includesPreroll:e=>fe(e)||e.getCuePoints().indexOf(0)>=0,isEconomicsFree:e=>"object"==typeof e.mediainfo&&"FREE"===e.mediainfo.economics,isLive:e=>{const{mediainfo:t,liveTracker:a}=e,n=t&&t.duration||e.duration&&e.duration()||null;return a&&a.isLive()||n===1/0},isValidUrl:ve,isVast:fe,isVmap:e=>!(!e||0===e.getCuePoints().length),isVpaid:pe,loadScript:function(e,t){let a=document.createElement("script");const n=document.querySelector("head");a.async=!0,a.charset="utf-8",a.src=e,a.onload=()=>t(null),a.onerror=e=>{t(e),a.parentNode.removeChild(a),a=null},n.insertBefore(a,n.firstChild)},secondsToTime:ce,sendInsightsBeacon:ye,usingAutoAdvance:he,usingMediaCuepoints:e=>"oncue"===e.requestMode&&e.useMediaCuePoints,usingLiveAdCuepoints:e=>"oncue"===e.requestMode&&!e.useMediaCuePoints};var Se=ue;function Ce(e,t,a,n,r,i,o){try{var d=e[i](o),s=d.value}catch(e){return void a(e)}d.done?t(s):Promise.resolve(s).then(n,r)}function be(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){Ce(i,n,r,o,d,"next",e)}function d(e){Ce(i,n,r,o,d,"throw",e)}o(void 0)}))}}function Me(){const e=ve(document.referrer),t=ve(window.location.href);return a.default.dom.isInFrame()&&e?e:t||{}}function _e(e){return`${e.origin||""}${e.pathname||""}`}const Pe=(e,t="",a)=>{const n=_e(Me()),r=(e=>{try{const t=new URL(e);return t.hostname.includes("tv.springserve.com")||t.hostname.includes("vid.springserve.com")}catch(e){return!1}})(t),i=r?(e=>{const t=Me(),a=_e(t);return{macroNameOverrides:{"{player.width}":"{{WIDTH}}","{player.height}":"{{HEIGHT}}","{player.autoplay}":"{{AUTOPLAY}}","{player.muted}":"{{MUTE}}","{player.language}":"{{LANGUAGE}}","{mediainfo.duration}":"{{DURATION}}","{mediainfo.description}":"{{DESCRIPTION}}","{mediainfo.id}":"r:(\\{\\{)(MEDIA|VIDEO|CONTENT)(_ID)(\\}\\})","{mediainfo.name}":"r:(\\{\\{(ENCODED_VIDEO|CONTENT)_TITLE\\}\\})","{tcf.tcString}":"{{CONSENT}}","{tcf.gdprApplies}":"{{GDPR}}","{random}":"{{CACHEBUSTER}}","{usp.uspString}":"{{US_PRIVACY}}"},"{{DOMAIN}}":t.hostname,"{{ENCODED_URL}}":a,"{{DOUBLE_ENCODED_URL}}":encodeURIComponent(a),"{{CONTENT_LIVESTREAM}}":e.mediainfo&&-1===e.mediainfo.duration?1:0,"{{KEYWORDS}}":Array.isArray(e.mediainfo&&e.mediainfo.tags)?e.mediainfo.tags.join(","):""}})(e):{};if(e.bcinfo&&(i["{player.url}"]=e.bcinfo.scriptUrl,i["{player.accountId}"]=e.bcinfo.accountId),r&&t.includes("{{URL}}")&&(t=t.replace("{{URL}}",n)),a&&a.metadata&&-1!==t.indexOf("{mediainfo.ad_keys}")){const e=encodeURIComponent(a.metadata);t=t.replace("{mediainfo.ad_keys}",e)}return e.ads.adMacroReplacement(t,!0,i)},Re={adMacroReplacement:Pe,getPageUrl:Me,getPageUrlWithoutQueryString:_e},Te=function(){var e=be((function*(){try{const e=yield this.headerBidding().requestBid((e=>{const{getPageUrl:t,getPageUrlWithoutQueryString:a}=Re,n=e.ima3.adMacroReplacement("{tcf.gdprAppliesInt} {tcf.tcString}").split(" "),r=a(t()),i={};i.w=e.currentWidth(),i.h=e.currentHeight(),i.cb=Math.floor(1e9*Math.random()),i.url=r,i.dnt=window.dnt||window.navigator.doNotTrack||window.navigator.globalPrivacyControl?1:0,i.lmt="",i.us_privacy="";const o=+n[0];i.gdpr=o,i.gdpr_consent=o&&!n[1].startsWith("{tcf.")?n[1]:"",["coppa","gpp","gpp_sid"].forEach((e=>{let t;t="coppa"===e?window.tfcd:window[e],i[e]=t||0===t?t:""}));const d=e.language();return d&&(i.language=d),i.ap=e.autoplay()?1:0,i.mute=e.muted()?1:0,i})(this));e&&this.headerBidding().setBid(e)}catch(e){this.ima3.log.warn("Failed to set bid after request: ",e)}}));return function(){return e.apply(this,arguments)}}();let ke;ke={_addPlayerDimensions:(e,t)=>{(0,a.default.ima3.extend)(t,{linearAdSlotWidth:e.width,linearAdSlotHeight:e.height,nonLinearAdSlotWidth:e.width,nonLinearAdSlotHeight:e.height})},_addVmap:(e,t,a)=>{e.ima3.isReady_?t.adsResponse=a:e.ima3.oneUnlessContentUpdate_("ima3-ready",(()=>{t.adsResponse=a}))},_adsRequest:(e,t,a)=>{const n=e.ima3.settings.requestMode,r=e.ima3.settings.useMediaCuePoints,i=window.google.ima;if(!i||i&&!i.AdsRequest)throw new Error("An ad request was made before the plugin is ready");e.ima3.log("[adsRequest] Create ima.AdsRequest.");const o=new i.AdsRequest;ke._addPlayerDimensions(Se.getPlayerDimensions(e),o),"oncue"===n&&r&&a?ke._addVmap(e,o,a):o.adTagUrl=t,e.ima3.adsRequest=o;const d=t=>{const a=!(!t||"autoplay-success"!==t.type);o.setAdWillAutoPlay(a),o.setAdWillPlayMuted(e.muted()),(t=>{const a=e.ima3.settings.omidAccessModeRules||{};t.omidAccessModeRules=e.ima3.adsRequest.omidAccessModeRules||{};for(const e in a){const n=a[e],r=i.OmidVerificationVendor[e];r&&(t.omidAccessModeRules[i.OmidVerificationVendor[r]]=i.OmidAccessMode[n])}t.omidAccessModeRules.OTHER||(t.omidAccessModeRules.OTHER="LIMITED")})(o),e.trigger({type:"ads-before-request",adsRequest:o}),e.ima3.adsLoader.requestAds(o),e.trigger("ads-request")};if(e.ima3._contentchangedSeen){d({type:e.autoplay()?"autoplay-success":"autoplay-failure"})}else!1===e.autoplay()?d():e.ima3._autoplayResultEvent?d(e.ima3._autoplayResultEvent):e.any(["autoplay-success","autoplay-failure"],d)},_handleEconomicsFree:e=>{e.trigger("nopreroll"),e.trigger("nopostroll")},_isRepeatForSourceAllowed:e=>{const t=e.ima3.settings.requestMode;return"onload"!==t&&"onplay"!==t},_isRepeatForSource:e=>e.ima3.lastSrc_===e.currentSrc(),_handleMissingAdTagUrl:e=>{e.removeClass("vjs-ad-loading"),e.trigger("adscanceled"),e.trigger("nopreroll"),e.trigger("nopostroll"),e.ima3._falseyAdTagUrl=!0},_afterServerUrlFunctionCheck:(e,t,a)=>{const{headerBidding:n}=e,r=function(){var r=be((function*(){const r=e.ima3.settings.requestMode;let i;null!=t&&(i=e.ima3.adMacroReplacement(t)),"oncue"===r||i?(n&&("bid-received"===n().state.step||(yield(e=>{const{state:t,logger:a,options:n}=e.headerBidding();return new Promise((r=>{e.setTimeout((()=>{"bid-received"!==t.step&&(a.warn("IMA3 bid request timed out. Unable to add bid data to adTagUrl"),e.off("bidding-bid-set",r),r())}),n.timeout),e.one("bidding-bid-set",r)}))})(e)),i=n().updateUrlString(i)),ke._adsRequest(e,i,a)):ke._handleMissingAdTagUrl(e)}));return function(){return r.apply(this,arguments)}}();e.ads.updateUsPrivacyString((()=>{r()}))},_handleServerUrlFunctionResponse:(e,t)=>{Se.isEconomicsFree(e)?ke._handleEconomicsFree(e):ke._afterServerUrlFunctionCheck(e,t)},_afterPlay:(e,t,a)=>{const n=e.ima3.settings.useMediaCuePoints;Se.isEconomicsFree(e)?ke._handleEconomicsFree(e):(n||(t=t||e.ima3.settings.serverUrl),n||"function"!=typeof t?ke._afterServerUrlFunctionCheck(e,t,a):t((t=>{ke._handleServerUrlFunctionResponse(e,t)})))},_shouldWaitUntilPlay:e=>{const t=e.ima3.settings.requestMode,a=e.ima3.settings.useMediaCuePoints;return("onplay"===t&&(!e.playlist||!e.playlist()||"number"!=typeof e.playlist.autoadvance_.delay||e.ima3._loadstartSeen)||"oncue"===t&&a)&&!e.ima3._playSeen&&e.paused()&&!e.ads._pausedOnContentupdate},_waitUntilPlay:(e,t,a)=>{Se.isEconomicsFree(e)?ke._handleEconomicsFree(e):(e.ima3._requestAdsOnPlay=()=>{ke._afterPlay(e,t,a)},e.one("play",e.ima3._requestAdsOnPlay))},requestAds:(e,t,a)=>{e.ima3.log("[requestAds] Beginning ad request process."),!ke._isRepeatForSource(e)||ke._isRepeatForSourceAllowed(e)?ke._shouldWaitUntilPlay(e)?ke._waitUntilPlay(e,t,a):ke._afterPlay(e,t,a):e.ima3.log("Cancelling repeat adsRequest for "+e.currentSrc())}};var we=ke;const Ie=e=>{e.trigger("nopreroll"),e.trigger("nopostroll")},Ee=(e,t)=>{t.ima3.isReady_?"AdsDone"!==t.ads._state.constructor._getName()?t.mediainfo&&"FREE"===t.mediainfo.economics?t.ima3.log("On demand adRequest attempted on video with advertising disabled."):e?(t.ima3.log("Clearing any previous VAST ad data and triggering ondemand adrequest."),t.ads.startLinearAdMode(),ge(t),we.requestAds(t,e),t.addClass("ima3-ad-loading")):t.ima3.log("On demand adRequest attempted without an adTagUrl."):t.ima3.log("On demand adRequest cannot occur when player.ads is in AdsDone state."):t.ima3.log.error("Cannot make an ad request when the plugin is not ready. Skipping ad...")};class Be{constructor(e){this.player=e,this.audibleState=this.playerAudibleState(e),this.audibleTracking={totalAudibleSec:0,start:0}}isAudible(e){return e.volume>=.01&&!e.muted}playerAudibleState(e){return{volume:e.volume(),muted:e.muted()}}audibleStateChanged(e,t){return this.isAudible(e)&&!this.isAudible(t)?1:!this.isAudible(e)&&this.isAudible(t)?2:0}handleVolumeChange(){const e=this.audibleStateChanged(this.audibleState,this.playerAudibleState(this.player));1===e&&(this.audibleTracking.totalAudibleSec+=this.player.ads.ad.currentTime-this.audibleTracking.start),2===e&&(this.audibleTracking.start=this.player.ads.ad.currentTime),this.audibleState=this.playerAudibleState(this.player)}handleAdComplete(){this.isAudible(this.playerAudibleState(this.player))&&(this.audibleTracking.totalAudibleSec+=this.player.ads.ad.currentTime-this.audibleTracking.start),this.player.ads.ad.audible_duration=this.audibleTracking.totalAudibleSec}}const Le={0:"PREROLL","-1":"POSTROLL"},De=(e,t,a)=>{""!==a&&(e.currentAdEventInfo[t]?e.currentAdEventInfo[t].push(a):e.currentAdEventInfo[t]=[a])};const Oe=(e,t,a)=>{if(a&&(e.ima3.currentAd=a),void 0!==e.ima3.currentAd){try{e.ads.ad.id=e.ima3.currentAd.getAdId(),e.ads.ad.duration=e.ima3.currentAd.getDuration(),e.ads.ad.currentTime=e.ima3.adsManager?e.ima3.currentAd.getDuration()-e.ima3.adsManager.getRemainingTime():e.ima3.currentAd.getDuration(),e.ads.ad.timeOffset=e.ima3.currentAd.getAdPodInfo().getTimeOffset(),e.ads.ad.index=e.ima3.currentAd.getAdPodInfo().getAdPosition()-1,e.ads.ad.type=Le[e.ima3.currentAd.getAdPodInfo().getTimeOffset()]||"MIDROLL";const t=e.ima3.currentAd.getAdPodInfo().getPodIndex();e.ads.pod.id=t,e.ads.pod.index=t,e.ads.pod.size=e.ima3.currentAd.getAdPodInfo().getTotalAds()}catch(t){e.ima3.log.error("Could not update ad data for Brightcove Analytics, probably due to an unexpected data value:",t)}"ima3-started"===t&&(((e,t)=>{if(void 0===t)return;const a=e.ima3;a.currentAdEventInfo.adPodId=e.ads.pod.id,a.currentAdEventInfo.adPodLength=e.ads.pod.size,a.currentAdEventInfo.adType=e.ads.adType,De(a,"adId",e.ads.ad.id),De(a,"creativeLength",e.ads.ad.duration),De(a,"creativeIndex",e.ads.ad.index),De(a,"creativeId",t.getCreativeId()),De(a,"creativeAdId",t.getCreativeAdId()),De(a,"creativeFormat",t.getContentType()),De(a,"creativeUrl",t.getMediaUrl()),De(a,"surveyUrl",t.getSurveyUrl()),De(a,"adTitle",t.getTitle()),De(a,"wrapperCreativeIds",t.getWrapperCreativeIds()),De(a,"advertiserName",t.getAdvertiserName()),De(a,"dealId",t.getDealId()),De(a,"adSystem",t.getAdSystem()),De(a,"wrapperAdSystems",t.getWrapperAdSystems())})(e,e.ima3.currentAd),De(e.ima3,"started",e.ads.ad.index)),function(e,t){const a={0:"pre","-1":"post"},n=e.ima3.currentAd,{ad:r,pod:i}=e.ads,o=n.getAdPodInfo().getTimeOffset(),d=n.getWrapperAdSystems(),s=e.ima3.currentAd.getSkipTimeOffset(),l=e.ima3.adsManager?e.ima3.adsManager.getRemainingTime():0,u=e.ima3.currentAd.getDuration(),A=u-l;if("ima3-started"===t&&(Se.isLive(e)||(e.ads.pod.index=e.ima3.currentAd.getAdPodInfo().getPodIndex()),"function"==typeof e.on)){const t=new Be(e);e.on("advolumechange",t.handleVolumeChange.bind(t)),e.one(["ima3-complete","ima3-skip"],(a=>{e.off("advolumechange",t.handleVolumeChange),t.handleAdComplete.bind(t)()}))}Se.assignIfTruthy(r,"deal_id",n.getDealId()),Se.assignIfTruthy(r,"wrapper_systems",Array.isArray(d)&&d.join(",")),Se.assignIfTruthy(r,"system",n.getAdSystem()),Se.assignIfTruthy(r,"advertiser",n.getAdvertiserName()),Se.assignIfTruthy(r,"content_type",n.getContentType()),Se.assignIfTruthy(r,"isci",n.getCreativeAdId()),Se.assignIfTruthy(r,"creative_id",n.getCreativeId()),Se.assignIfTruthy(r,"title",n.getTitle());try{const{host:e}=new URL(n.getMediaUrl());Se.assignIfTruthy(r,"media_url_domain",e)}catch(a){"ima3-started"===t&&e.ima3.log.warn("No media URL available at ad start. There may be a problem with the source ad data")}if(r.currentTime=A,"number"==typeof u&&u>=0&&l<=u?r.play_duration="number"==typeof l&&l>=0?u-l:u:"number"==typeof u&&u>=0&&l>u&&(r.play_duration=0),-1!==s&&(r.skip_time_offset=s),i.ad_count=n.getAdPodInfo().getTotalAds(),"number"==typeof o&&(i.type=a[o]||"mid"),i.time_offset=-1!==o?o:e.duration(),"number"==typeof n.getAdPodInfo().getPodIndex()){if(void 0===i.durationTracker)i.durationTracker={podIndex:n.getAdPodInfo().getPodIndex(),adIndex:e.ima3.currentAd.getAdPodInfo().getAdPosition(),total:e.ima3.currentAd.getDuration()};else{const e=i.durationTracker.podIndex,t=i.durationTracker.adIndex;n.getAdPodInfo().getPodIndex()!==e?(i.durationTracker.podIndex=n.getAdPodInfo().getPodIndex(),i.durationTracker.adIndex=n.getAdPodInfo().getAdPosition(),i.durationTracker.total=n.getDuration()):n.getAdPodInfo().getAdPosition()!==t&&(i.durationTracker.adIndex=n.getAdPodInfo().getAdPosition(),i.durationTracker.total=i.durationTracker.total+n.getDuration())}Se.assignIfTruthy(i,"duration",i.durationTracker&&i.durationTracker.total)}}(e,t)}"ima3-complete"===t&&De(e.ima3,"completed",e.ads.ad.index)};var Ne="5.4.9";const je=(e,t)=>{const a=e.el().querySelector(".vjs-tech"),n=e.log.createLogger("IMA3"),r={readyQueue_:[],isReady_:!1,player:e,tech:a,settings:t,ready:t=>(t&&(e.ima3.isReady_?t.call(e):(void 0===e.ima3.readyQueue_&&(e.ima3.readyQueue_=[]),e.ima3.readyQueue_.push(t))),e.ima3),adMacroReplacement:t=>Pe(e,t),insertAdContainer:t=>{((e,t)=>{const a=e.el().querySelector(".vjs-big-play-button");e.el().insertBefore(t,a)})(e,t)},currentAdEventInfo:{},addToCurrentAdEventInfo:(t,a)=>{De(e,t,a)},setAdsRenderingSettings(t){((e,t)=>{if(e.ima3.adsRenderingSettings_=t,e.ima3.adsManager){let a;const n=window.google.ima;t instanceof n.AdsRenderingSettings?a=t:(a=new n.AdsRenderingSettings,Object.keys(t).forEach((e=>{a[e]=t[e]}))),e.ima3.adsManager.updateAdsRenderingSettings(a)}})(e,t)},log:n,toggleLogger(e){e?(n.level("debug"),n.history.enable()):(n.level("warn"),n.history.disable())},oneHandlers_:[],oneUnlessContentUpdate_(t,a){((e,t,a)=>{e.ima3.oneHandlers_.push({type:t,handler:a}),e.one(t,a)})(e,t,a)},isVpaid:()=>pe(e),version:Ne,VERSION:Ne};return e.on("contentupdate",(function(){const t=e.ima3.oneHandlers_;for(let a=0;a<t.length;a++){const n=t[a];e.off(n.type,n.handler)}e.ima3.oneHandlers_=[]})),e.on("ima3-ready",(function(){e.ima3.isReady_=!0;for(let t=0;t<e.ima3.readyQueue_.length;t++)e.ima3.readyQueue_[t].call(e);e.ima3.readyQueue_=[]})),r.toggleLogger(t.debug),e.on("debugon",(()=>e.ima3.toggleLogger(!0))),e.on("debugoff",(()=>e.ima3.toggleLogger(!1))),r};function qe(e){const t=e.mediainfo,a=e.ima3.settings.serverUrl;if(t&&"AD_SUPPORTED"===t.economics&&t.cuePoints.length>0&&t.cuePoints.some((e=>"AD"===e.type))){let n='<vmap:VMAP xmlns:vmap="http://www.iab.net/videosuite/vmap" version="1.0">\n';for(let r=0;r<t.cuePoints.length;r++)if("AD"===t.cuePoints[r].type){t.cuePoints[r].time<1?n+='<vmap:AdBreak timeOffset="start" breakType="linear" breakId="'+t.cuePoints[r].name+'">\n':t.duration-t.cuePoints[r].time<1?n+='<vmap:AdBreak timeOffset="end" breakType="linear" breakId="'+t.cuePoints[r].name+'">\n':n+='<vmap:AdBreak timeOffset="'+ce(t.cuePoints[r].time)+'" breakType="linear" breakId="'+t.cuePoints[r].name+'">\n';const i=Pe(e,a,t.cuePoints[r]);n+=' <vmap:AdSource id="'+t.cuePoints[r].id+'" allowMultipleAds="true" followRedirects="true">\n<vmap:AdTagURI templateType="vast3">\n<![CDATA['+i+"]]>\n</vmap:AdTagURI>\n</vmap:AdSource>\n</vmap:AdBreak>\n"}return n+="</vmap:VMAP>",n}return null}const Ue={"ima3-click":"ads-click","ima3-started":"ads-ad-started","ima3-complete":"ads-ad-ended","ima3-first-quartile":"ads-first-quartile","ima3-midpoint":"ads-midpoint","ima3-third-quartile":"ads-third-quartile","ima3-volume-changed":"ads-volumechange","ima3-paused":"ads-pause","ima3-resumed":"ads-play","ima3-skipped":"ads-ad-skipped","ima3-all-ads-completed":"ads-allpods-completed","ads-request":"ads-request","ads-pod-ended":"ads-pod-ended","ads-pod-started":"ads-pod-started","ads-load":"ads-load"},xe=(e,t,a,n)=>{const r=function(r){e.trigger({type:n,emitter:t,originalEvent:r});const i=Boolean(r.getAdData)&&r.getAdData()&&void 0===r.getAdData().adError;i&&Oe(e,n,r.getAd()),"start"===a&&(i||Oe(e,n),ye(e,"adBegin")),"skip"!==a&&"complete"!==a||ye(e,"adComplete");const o=Ue[n];if(o){const t={type:o};"ads-ad-started"!==o&&"ads-ad-ended"!==o||(t.indexInBreak=e.ads.ad.index),e.trigger(t)}};return t.addEventListener(a,r,!1),r},Ve=(e,t,a)=>{const n={},r=t.ima3._eventMapping.eventTypes;void 0===a&&(a=xe);for(const i in r)n[i]=a(t,e,i,r[i]);return function(){for(const t in n)e.removeEventListener(t,n[t])}},Fe=function(e){return"ima3-"+e.toLowerCase().replace(/_/g,"-")},He=(e,t,a,n,r,i)=>{const o=Ae(e);return()=>{t===a.ViewMode.FULLSCREEN?e.ima3.adsManager.resize(e.el().offsetWidth,e.el().offsetHeight,t):e.ima3.adsManager.resize(o.width,o.height,t),o.width===r&&o.height===i||n>=0&&setTimeout(He(e,t,a,n-1,o.width,o.height),1e3)}},We=e=>{const t=e.textTracks();for(let e=0;e<t.length;e++)"metadata"===t[e].kind&&"disabled"===t[e].mode&&(t[e].mode="hidden")},Ge=e=>{e.on("fullscreenchange",(t=>{const n=window.google.ima;a.default.IS_ANY_SAFARI&&We(e);const r=e.hasClass("vjs-fullscreen");if(!e.ima3||!e.ima3.adsManager)return;const i=r?n.ViewMode.FULLSCREEN:n.ViewMode.NORMAL,o=Ae(e);i===n.ViewMode.FULLSCREEN?e.ima3.adsManager.resize(e.el().offsetWidth,e.el().offsetHeight,i):e.ima3.adsManager.resize(o.width,o.height,i),setTimeout(He(e,i,n,3,o.width,o.height),1e3)})),e.on("playerresize",(()=>{if(e.ima3.adsManager){const t=Ae(e);e.ima3.adsManager.resize(t.width,t.height,window.google.ima.ViewMode.NORMAL)}}))},Ze=(e,t)=>{const a=e.AdError.ErrorCode;for(const e in a)if(a.hasOwnProperty(e)&&!e.match("COMPANION|NONLINEAR|OVERLAY")&&t.getErrorCode()===a[e]&&"adLoadError"===t.getType())return!0;return!1},Qe=e=>{const t=e.ima3.adsManager;Se.isVast(t)?(e.ima3.log("[hardTimeout] Call util.destroyAdsManager for VAST ads."),Se.destroyAdsManager(e),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout")):Se.isVmap(t)&&Se.includesPreroll(t)&&(e.ima3.log("[hardTimeout] Call adsManager.discardAdBreak for VMAP."),e.ima3.adsManager.discardAdBreak(),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout"))},Ye=e=>{e.ima3.adDisplayContainer&&!e.ima3.adDisplayContainer.initialized&&(e.ima3.log("[initializeAdDisplayContainer] Call adDisplayContainer.initialize()."),e.ima3.adDisplayContainer.initialize(),e.ima3.adDisplayContainer.initialized=!0)},ze=e=>{const t=window.google.ima,a=Se.getPlayerDimensions(e);e.ima3.log("[startAdsManager]");try{e.muted()&&e.ima3.adsManager.setVolume(0),Ye(e),e.trigger("ads-load"),e.ima3.log("[startAdsManager] trigger ads-load."),e.ima3.log("[startAdsManager] Call AdsManager.init()."),e.ima3.adsManager.init(a.width,a.height,t.ViewMode.NORMAL),e.ima3.log("[startAdsManager] Call AdsManager.start()."),e.ima3.adsManager.start()}catch(t){e.ima3.log("[startAdsManager] adError caught, trigger adserror."),e.ima3.log.warn("Error starting ads manager",t),e.ads.error({errorType:z.AdsManagerStartError}),e.trigger("adserror")}},Xe=e=>{e.ima3.adsManager.discardAdBreak(),e.ima3.adsManager.skip(),e.ima3.managerCleanup=null,e.ads.inAdBreak()&&e.ads.endLinearAdMode()},Je=(e,t)=>{if(t.ima3SdkSettings)for(const n in t.ima3SdkSettings){const r="set"+n.charAt(0).toUpperCase()+n.slice(1);"function"==typeof e.settings[r]?e.settings[r](t.ima3SdkSettings[n]):a.default.log.warn('Invalid ima3SdkSetting: "'+n+'"')}},$e=(e,t,n)=>{const r=window.google.ima,i={};if(e.trigger({type:"ima3-ready",imaSdk:"ondemand"===t.requestMode?r:null}),e.ima3.log("[onSdkLoad]"),(e=>{e._eventMapping={},e.settings.eventMap=Ue;const t=window.google.ima,a={},n=["AdErrorEvent","AdEvent","AdsManagerLoadedEvent"];let r=n.length;for(;r--;){if(!t[n[r]]||!t[n[r]].Type)continue;const e=t[n[r]].Type;for(const t in e)e.hasOwnProperty(t)&&(a[e[t]]=Fe(t))}e._eventMapping.eventTypes=a})(e.ima3),Je(r,t),t.vpaidMode){if("number"!=typeof r.ImaSdkSettings.VpaidMode[t.vpaidMode])throw e.ads.error({errorType:z.InvalidVpaidMode,mode:t.vpaidMode}),new Error('Invalid VPAID Mode: "'+t.vpaidMode+'"');r.settings.setVpaidMode(r.ImaSdkSettings.VpaidMode[t.vpaidMode])}const o=e.el().querySelector(".vjs-tech");e.ima3.log("[onSdkLoad] Create ima.adDisplayContainer."),e.ima3.adDisplayContainer=new r.AdDisplayContainer(n,o,t.clickTrackingElement),e.ima3.adDisplayContainer.initialized=!1;let d="click";if((a.default.browser.IS_IOS||a.default.browser.IS_ANDROID)&&(d="touchend"),e.one(d,(()=>{Ye(e)})),e.ima3.log("[onSdkLoad] Create ima.AdsLoader."),e.ima3.adsLoader=new r.AdsLoader(e.ima3.adDisplayContainer),e.ima3.adsLoader){const t=e.ima3.adsLoader.getVersion();e.ima3.log("[onSdkLoad] IMA SDK Version: "+t)}const s=e.ima3.adsLoader.getSettings();s.setPlayerVersion(e.ima3.version),s.setPlayerType("brightcove/player-html5"),e.ima3.loaderCleanup=Ve(e.ima3.adsLoader,e);const l=e.currentSrc();Se.usingMediaCuepoints(t)&&((e,t,a)=>{e.ima3.log("[handleMediaCuepoints]"),e.ima3._loadstartSeen&&e.ima3.settings.serverUrl&&e.mediainfo?(e.ima3.log("[handleMediaCuepoints] Call createMediaCuepointVmap to set adRequestData.vmap if loadstart was previously seen."),a.vmap=qe(e)):e.ima3.oneUnlessContentUpdate_("loadstart",(()=>{e.ima3.log("[handleMediaCuepoints.oneUnlessContentUpdate.player.on] loadstart: Received loadstart event."),setTimeout((()=>{e.ima3.settings.serverUrl?(e.ima3.log("[handleMediaCuepoints.oneUnlessContentUpdate_] Call createMediaCuepointVmap to set adRequestData.vmap."),a.vmap=qe(e)):e.ima3.log.error("[handleMediaCuepoints.oneUnlessContentUpdate_] IMA3 serverUrl isnt provided.")}),0)}))})(e,0,i),((e,t,a)=>{if(e.ima3.log("[handleWaitForLoadstart]"),"ondemand"!==t.requestMode&&!Se.usingLiveAdCuepoints(t)){const t=()=>{e.mediainfo&&"FREE"===e.mediainfo.economics?(e.trigger("adscanceled"),e.trigger("nopreroll"),e.trigger("nopostroll")):(e.ima3.log("[handleWaitForLoadstart] Call adsRequest.requestAds with adRequestData.vmap after loadstart."),we.requestAds(e,null,a.vmap))};e.ima3._loadstartSeen?(e.ima3.log("[handleWaitForLoadstart] Call afterLoadStart if loadstart was seen."),t()):e.one("loadstart",(()=>{e.ima3.log("[handleWaitForLoadstart.player.on] loadstart: Received loadstart event."),setTimeout((()=>{e.ima3.log("[handleWaitForLoadstart.setTimeout] Call afterLoadStart on loadstart event."),t()}),0)}))}})(e,t,i),e.ima3.currentSrc_=e.currentSrc(),e.on("dispose",(()=>{e.ima3.log("[onSdkLoad.player.on] dispose: Call destroyAdsManager."),Se.destroyAdsManager(e),a.default._ima3sawDispose=!0})),e.on("contentchanged",(()=>{e.ima3.log("[onSdkLoad.player.on] contentchanged: Call handleContentChanged."),((e,t,a,n,r)=>{e.ima3.log("[handleContentChanged]"),setTimeout((()=>{if(a=e.currentSrc(),e.ima3.log("[handleContentChanged] Call util.destroyAdsManager on contentchanged event."),Se.destroyAdsManager(e),e.ima3._checkedForAdManagerStart=!1,e.ima3.lastSrc_=e.ima3.currentSrc_,e.ima3.currentSrc_=e.currentSrc(),Se.isEconomicsFree(e))return e.trigger("adscanceled"),e.trigger("nopreroll"),void e.trigger("nopostroll");"ondemand"!==t.requestMode?a&&""!==a&&"ondemand"!==t.requestMode&&!Se.usingLiveAdCuepoints(t)&&(Se.usingMediaCuepoints(t)&&(e.ima3.log("[handleContentChanged] Call mediaCuePoints.createMediaCuepointVmap to check current video cue point data and refresh ad VMAP"),n.vmap=qe(e)),e.ima3.log(`[handleContentChanged] ${n.vmap?"Call adRequest.requestAds":"No adRequestData.vmap data available, making adRequest.requestAds call"} with adRequestData.vmap =`,n.vmap),r.requestAds(e,null,n.vmap)):Ie(e)}),0)})(e,t,l,i,we)}));const u=()=>{(e=>{e.ima3&&e.ima3.adsManager&&e.ima3.adsManager.skip&&e.ima3.adsManager.skip(),e.ima3.log("[postrollAdtimeoutHandler] Call util.destroyAdsManager."),Se.destroyAdsManager(e),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout")})(e)};e.on("contentended",(()=>{e.ima3.log("[onSdkLoad.player.on] contentended: Call adsLoader.contentComplete."),e.one("adtimeout",u),e.ima3.adsLoader.contentComplete()})),e.on("contentupdate",(()=>{e.off("adtimeout",u),e.ima3.log("[onSdkLoad.player.on] contentupdate: Call adsLoader.contentComplete."),e.ima3.adsLoader.contentComplete()})),e.on(["contentupdate","adend","ima3-ready"],(()=>{"function"==typeof e.ads.ad.reset?e.ads.ad.reset():e.ads.ad={},"function"==typeof e.ads.pod.reset?e.ads.pod.reset():e.ads.pod={}})),e.ima3.el=n},Ke=e=>{const t=e.ima3.adsManager.getCuePoints(),a=t&&t.length>0,n=!(!e.ima3.adsRequest||!e.ima3.adsRequest.adsResponse);return Se.usingMediaCuepoints(e.ima3.settings)&&a&&!n},et=(e,t)=>{e.ima3.log("[onContentPauseRequested]"),"ondemand"===t.requestMode||Se.usingLiveAdCuepoints(t)||(e.ima3.log("[onContentPauseRequested] Call startLinearAdMode if requestmode not ondemand or not usingLiveAdCuepoints."),e.ads.startLinearAdMode()),a.default._ima3sawDispose&&!a.default._ima3adAfterDispose&&(e.trigger({type:"usage",name:"ima3-ad-after-dispose"}),a.default._ima3adAfterDispose=!0)},tt=e=>{e.ima3.log("[onContentResumeRequested]"),e.ads.inAdBreak()?(e.ima3.log("[onContentResumeRequested] Call endLinearAdMode if inAdBreak."),e.ads.endLinearAdMode(),e.removeClass("ima3-ad-loading"),e.removeClass("vjs-vpaid-playing"),e.trigger("ads-pod-ended")):(e.ima3.log("[onContentResumeRequested] Call skipLinearAdMode if not inAdBreak."),e.ads.skipLinearAdMode())},at=e=>{let t="Non-fatal error occurred";if(e){const a=e.getErrorCode(),n=e.getMessage();a&&(t+=": AdError "+a),n&&(t+=": "+n)}return t},nt=e=>{e.ima3.log("[onPluginInit]"),e.on("analytics_request",(t=>{e.ima3.log("[onPluginInit.player.on] analytics_request: "+t.params.event+" event triggered.")})),e.on(["ima3-ads-manager-loaded","ima3-ready","ima3-loaded","ima3-impression","ima3-viewable-impression","ima3-started","ima3-first-quartile","ima3-midpoint","ima3-third-quartile","ima3-skippable-state-changed","ima3-complete","ima3-all-ads-completed","ima3-ad-error","ima3-click","ima3-paused","ima3-resumed","ima3-content-pause-requested","ima3-content-resume-requested","ima3-skip","ima3-user-closed","ima3-linear-changed","ima3-ad-buffering","ima3-ad-metadata","ima3-interaction"],(t=>{e.ima3.log("[onPluginInit.player.on] IMA SDK Event "+t.type+" received.")})),e.on("adstart",(t=>{e.ima3.log("[onPluginInit.player.on] adstart: Received adstart event."),e.ads.shouldPlayContentBehindAd(e)||(e.ima3.log("[onPluginInit.player.on] adstart: Pause player if not LIVE and playing content behind ad."),e.pause()),e.hasStarted(!0),e.ima3.currentAdEventInfo={},"oncue"!==e.ima3.settings.requestmode&&e.duration()===1/0&&e.trigger({type:"usage",name:"ima3-live-preroll"})})),e.on("adend",(()=>{e.ima3.log("[onPluginInit.player.on] adend: Received adend event."),e.duration()===1/0&&e.trigger("playing")}))},rt=(e,t)=>{const n=document.createElement("div");n.className="vjs-ima3-ad-container",e.ima3.insertAdContainer(n),e.ima3.adrequest=a=>{Ee(a||t.serverUrl,e)},e.on("ima3-content-pause-requested",(a=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-pause-requested: Received ON_CONTENT_PAUSE_REQUESTED event."),et(e,t)})),e.on("ima3-content-resume-requested",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-resume-requested: Received ON_CONTENT_RESUME_REQUESTED event."),e.ads.inAdBreak()&&tt(e)})),e.on("ima3-ad-break-fetch-error",(()=>{e.ima3.log("[onPlayerReady.player.on] ima3-ad-break-fetch-error: Received AD_BREAK_FETCH_ERROR event.");const t=()=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-resume-requested: Received ON_CONTENT_RESUME_REQUESTED event."),e.ads.inAdBreak()||tt(e)};e.one("ima3-content-resume-requested",t),e.one("ima3-loaded",(()=>{e.off("ima3-content-resume-requested",t)}))})),Ge(e),e.on("ima3-started",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-started: Received STARTED event indicating ad has initiated playback."),e.removeClass("ima3-ad-loading"),e.ima3.log("ima3-started")})),e.on("ima3-log",(t=>{const a=t.originalEvent.getAdData().adError;e.ima3.log("ima3-log:",at(a))})),e.on("ima3-ad-error",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-ad-error: Received AD_ERROR event.");let n,r={};t.originalEvent&&(r=t.originalEvent.getError(),n=r.getErrorCode(),e.ima3.log("ima3-ad-error",r.toString()),(Ze(window.google.ima,r)&&"onload"===e.ima3.settings.requestMode||"onplay"===e.ima3.settings.requestMode)&&e.trigger("nopostroll")),e.removeClass("ima3-ad-loading"),e.trigger({type:"adserror",errorCode:n,adData:a.default.obj.merge(e.ads.ad,{})})})),e.on("ima3-all-ads-completed",(()=>{e.ended()||(e.ima3.log("[onPlayerReady.player.on] ima3-all-ads-completed: Ads completed before postroll"),e.trigger("nopostroll"))})),t.hardTimeouts&&e.on("adtimeout",(()=>{if(e.ima3.log("[onPlayerReady.player.on] adtimeout: Received adtimeout event"),e.ima3.adsManager)Qe(e);else{const t=()=>{Qe(e)};e.one("ima3-ads-manager-loaded",t),e.one(["adstart","contentupdate","dispose"],(a=>{e.off("ima3-ads-manager-loaded",t)}))}})),e.on("ima3-loaded",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-loaded: Received LOADED event indicating ad has loaded.");const a=t.originalEvent.getAd();e.ima3.log("[onPlayerReady.player.on] ima3-loaded: Ad",(e=>{const t=e.getAdPodInfo();return{id:e.getAdId(),adPodInfo:{adPosition:t.getAdPosition(),isBumper:t.getIsBumper(),maxDuration:t.getMaxDuration(),podIndex:t.getPodIndex(),timeOffset:t.getTimeOffset(),totalAds:t.getTotalAds()},adSystem:e.getAdSystem(),advertiserName:e.getAdvertiserName(),apiFramework:e.getApiFramework(),contentType:e.getContentType(),creativeAdId:e.getCreativeAdId(),creativeId:e.getCreativeId(),dealId:e.getDealId(),description:e.getDescription(),duration:e.getDuration(),height:e.getHeight(),width:e.getWidth(),isLinear:e.isLinear(),mediaUrl:e.getMediaUrl(),minSuggestedDuration:e.getMinSuggestedDuration(),skippable:e.isSkippable(),skipTimeOffSet:e.getSkipTimeOffset(),surveyUrl:e.getSurveyUrl(),title:e.getTitle(),universalAdIdRegistry:e.getUniversalAdIdRegistry(),universalAdIds:e.getUniversalAdIds().map((e=>({universalAdRegistry:e.getAdIdRegistry(),universalAdIdValue:e.getAdIdValue()}))),universalAdIdValue:e.getUniversalAdIdValue(),vastMediaBitrate:e.getVastMediaBitrate(),vastMediaHeight:e.getVastMediaHeight(),vastMediaWidth:e.getVastMediaWidth(),wrapperAdIds:e.getWrapperAdIds(),wrapperAdSystems:e.getWrapperAdSystems(),wrapperCreativeIds:e.getWrapperCreativeIds()}})(a)),e.trigger("ads-loading"),e.removeClass("ima3-ad-loading"),a&&!a.isLinear()&&(e.addClass("vjs-ima3-overlay"),e.ima3.log("[onPlayerReady.player.on] ima3-sdk-loaded: Call startLinearAdMode."),e.ads.startLinearAdMode(),e.ima3.log("[onPlayerReady.player.on] imad-sdk-loaded: Call endLinearAdMode."),e.ads.endLinearAdMode())})),e.on("ima3-complete",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-complete: Received COMPLETED event.");const a=t.originalEvent.getAd();e.ima3.log("ima3-complete"),delete e.ima3.currentAd,a&&(a.isLinear()?e.addClass("ima3-ad-loading"):e.removeClass("vjs-ima3-overlay"))})),e.on(["readyforoutstream","readyforpreroll","playing"],(n=>{e.ima3.log("[onPlayerReady.player.on] "+n.type+": Received "+n.type+" event"),(!a.default.browser.IS_ANY_SAFARI||"string"!=typeof e.autoplay()||"playing"!==n.type||e.ima3._checkedForAdManagerStart||e.ima3.adsManager)&&(e.ima3._checkedForAdManagerStart||(e.ima3._checkedForAdManagerStart=!0,!e.ima3.adsManager||Se.usingLiveAdCuepoints(t)||"ondemand"===t.requestMode||Se.isEconomicsFree(e)||(e.ima3.log("[onPlayerReady.player.on] "+n.type+": Call startAdsManager for onload or onplay requestmodes."),ze(e))))})),e.on("adserror",(()=>{e.ima3.log("[onPlayerReady.player.on] adserror: Received ADS_ERROR event."),e.ima3.log("[onPlayerReady.player.on] adserror: Call destroyAdsManager"),Se.destroyAdsManager(e)})),e.on("adscanceled",(()=>{e.ima3.log("[onPlayerReady.player.on] adscanceled: Received ADS_CANCELED event."),e.ima3.log("[onPlayerReady.player.on] adscanceled: Call destroyAdsManager."),Se.destroyAdsManager(e)})),e.on("ima3-ads-manager-loaded",(t=>{e.ima3.log("[onPlayerReady.player.on] ima-ads-manager-loaded: Received LOADED event."),((e,t)=>{e.ima3.log("[onAdsManagerLoaded]"),e.ima3.managerCleanup&&(e.ima3.log("[onAdsManagerLoaded] Call destroyAdsManager."),Se.destroyAdsManager(e));const a={currentTime:e.currentTime(),duration:e.duration()};e.on("timeupdate",(()=>{a.currentTime=e.currentTime()}));const n=t.originalEvent.getAdsManager(a,e.ima3.adsRenderingSettings_);e.ima3.adsManager=n,e.trigger("ads-response-received");const r=e.ima3.settings;if(Ke(e))return Xe(e),e.ads.error({errorType:z.VmapCancelledError}),void e.ima3.log.error("Cancelling VMAP ad because thead server cannot return a vmap when using cuepoints");e.ima3.managerCleanup=Ve(n,e),"ondemand"===r.requestMode||"oncue"===r.requestMode?(e.ima3.log("[onAdsManagerLoaded] Call startAdsManager if requestMode equals ondemand or oncue."),ze(e)):e.trigger("adsready"),"oncue"!==r.requestMode&&(Se.includesPreroll(n)||e.trigger("nopreroll"),Se.includesPostroll(n)||e.trigger("nopostroll"))})(e,t)})),a.default.use&&!a.default._imaMiddlewareSetup&&(a.default.log.debug("Setting up IMA middleware"),a.default.use("*",(e=>({setSource:(t,a)=>{if(e&&e.ads&&"function"==typeof e.ads.inAdBreak&&e.ads.inAdBreak()&&(e.ima3.adsManager.discardAdBreak(),e.ads.disableNextSnapshotRestore=!0,e.ads.endLinearAdMode(),e.trigger("contentresumed"),e.autoplay())){const t=e.play();t&&t.catch&&t.catch((()=>{}))}a(null,t)}}))),a.default._imaMiddlewareSetup=!0),window.google&&window.google.ima?$e(e,t,n):Se.loadScript(t.sdkurl,(a=>{if(a)return e.trigger("nopreroll"),e.trigger("nopostroll"),e.ads.error({errorType:z.SdkLoadError}),e.trigger({type:"adserror",error:a});$e(e,t,n)}))},it=/^(file|data|http):/.test(window.location.protocol)?"http:":"https:",ot={sdkurl:`${it}//imasdk.googleapis.com/js/sdkloader/ima3.js`,serverUrl:`${it}//pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear`,timeout:4e3,requestMode:"onload",hardTimeouts:!0,showVpaidControls:!1,debug:!1};a.default.ima3={extend:me};const dt=function(e){const t=((e,t={})=>{const a=me({},ot,t);if(e.ima3.defaults=ot,t.useMediaCuePoints&&"oncue"!==t.requestMode)throw new Error(`useMediaCuePoints must be used with requestMode "oncue" rather than the currently set ${t.requestMode}`);return"onplay"===a.requestMode&&e.autoplay()&&(a.requestMode="onload"),a.timeout&&(a.prerollTimeout=a.postrollTimeout=a.timeout),a.contribAdsPrerollTimeout&&(a.prerollTimeout=a.contribAdsPrerollTimeout),a.contribAdsPostrollTimeout&&(a.postrollTimeout=a.contribAdsPostrollTimeout),"function"==typeof e.debug&&e.debug()&&(a.debug=!0),t.playerMode&&(a.playerMode=t.playerMode),a.debug&&!t.hasOwnProperty("sdkurl")&&(a.sdkurl=`${it}//imasdk.googleapis.com/js/sdkloader/ima3_debug.js`),a.liveCuePoints="oncue"===a.requestMode,a})(this,e),n=this.getChild("ControlBar"),r=n&&n.getChild("PlaybackRateMenuButton"),i=r&&r.hasClass("vjs-hidden"),o=this.headerBidding;let d;if(e&&e.hasOwnProperty("asyncAutoplaySupport")&&a.default.log.warn("Brightcove IMA3: The asyncAutoplaySupport option no longer has any effect. We recommend removing it."),o&&((e,t)=>{const{state:a,logger:n,options:r}=e.headerBidding(),i=["pixel-set","bid-received"];"pixel-set"===a.step?t():(e.setTimeout((()=>{i.includes(a.step)||(n.warn("Pixel timed out. Unable to proceed with bid request"),e.off("bidding-pixel-set",t))}),r.timeout),e.one("bidding-pixel-set",t))})(this,Te),!1!==this.autoplay()){t.allowVjsAutoplay=!0;const{delayAutoplayIfNotViewable:e,delayAutoplayOnMobileOnly:n}=this.viewability().options;if(("outstream"===t.playerMode||o)&&!e&&!n){const e=this.autoplay();this.autoplay(!1),this.one("adsready",(()=>{this.autoplay(e)}))}this.addClass("vjs-ima3-not-playing-yet"),this.any(["autoplay-success","autoplay-failure"],(e=>{"autoplay-success"!==e.type||this.ima3._adsErrorSeen||this.ima3._falseyAdTagUrl||Se.isEconomicsFree(this)||this.pause(),this.removeClass("vjs-ima3-not-playing-yet"),this.ima3._autoplayResultEvent=e})),a.default.browser.IS_IOS||a.default.browser.IS_ANDROID||this.addClass("vjs-ima3-autoplay")}t.showVpaidControls||this.addClass("vjs-vpaid-controls-disabled"),this.addClass("vjs-ad-controls"),this.on("ima3-content-pause-requested",(e=>{this.addClass("ima3-ad-loading"),this.trigger("ads-pod-started"),"application/javascript"===e.originalEvent.getAd().getContentType()&&this.addClass("vjs-vpaid-playing")})),this.on("ima3-skipped",(()=>{this.ads.ad.skipped=1})),this.on("ima3-click",(()=>{this.ads.ad.interaction=1})),this.on(["ima3-complete","ima3-ad-error","ima3-content-resume-requested"],(e=>{const t=n.getChild("ProgressControl").getChild("SeekBar").getChild("PlayProgressBar");n.removeClass("vjs-ad-control-bar"),t.hasClass("vjs-play-progress-resetting")||t.addClass("vjs-play-progress-resetting"),t.el().style.width="0",a.default.browser.IS_IOS&&(r&&!i&&r.show(),this.one("contentplayback",(()=>{this.one("playing",(()=>{d&&this.playbackRate(d)}))})))})),this.on(["ima3-complete","ima3-ad-error","ima3-content-resume-requested","adend"],(()=>{this.ima3.el.style.removeProperty("pointer-events")})),this.on("ads-request",(function(){const e=Date.now();this.one("ima3-ads-manager-loaded",(function(){this.ads.pod.request_ms=Date.now()-e}))})),this.on("ima3-loaded",(e=>{const t=Date.now();this.one("ima3-started",(()=>{const e=Date.now();this.ads.ad.start_ms=e-t}))})),this.on("ima3-started",(e=>{const t=n.getChild("ProgressControl").getChild("SeekBar").getChild("PlayProgressBar");if(t.el().style.width="0",n.hasClass("vjs-ad-control-bar")||n.addClass("vjs-ad-control-bar"),t.removeClass("vjs-play-progress-resetting"),a.default.browser.IS_IOS&&(r&&!i&&r.hide(),1!==this.playbackRate()&&(d=this.playbackRate()),this.playbackRate(1)),this.ima3.currentAd=e.originalEvent.getAd(),this.ads.ad.skipped=0,this.ads.ad.interaction=0,this.ima3.currentAd.isSkippable()){this.ima3.el.style.setProperty("pointer-events","auto")}})),this.on(["adstart","adend"],(e=>{const{pod:t}=this.ads,{adTagUrl:a}=this.ima3.adsRequest||{};if("string"==typeof a){let e="";try{e=new URL(a).host}catch(e){this.ima3.log.error(e)}Se.assignIfTruthy(t,"host",e)}Se.assignIfTruthy(t,"request_mode",this.ima3.settings&&this.ima3.settings.requestMode),r&&!i&&("adstart"===e.type?r.hide():r.show())})),this.on("ima3-ad-progress",(()=>{this.trigger("timeupdate")})),this.on("adserror",(()=>{this.ima3._adsErrorSeen=!0})),this.on(["dispose","contentchanged"],(()=>{var e;(e=this).ima3._loadstartSeen=!1,e.ima3._playSeen=!1,e.ima3._adsErrorSeen=!1,e.ima3._falseyAdTagUrl=!1,e.ima3._autoplayResultEvent=void 0,void 0!==e.ima3._requestAdsOnPlay&&e.off("play",e.ima3._requestAdsOnPlay)})),this.on("loadstart",(()=>{this.ima3._loadstartSeen=!0})),this.on("play",(()=>{this.ima3._playSeen=!0})),this.on("contentchanged",(()=>{this.pause(),this.ads.settings.allowVjsAutoplay=!1,this.ima3._contentchangedSeen=!0,this.playlist&&he(this.playlist.autoadvance_)&&this.one("adsready",(()=>{this.ima3.log("[onAdsReady.player.on] Autoadvance setting detected, calling play() to initiate playback after BeforePreroll state"),this.play()}))})),this.on("adtimeout",(()=>{this.playlist&&he(this.playlist.autoadvance_)&&this.one("contentchanged",(()=>{this.ima3.log("[onAdsReady.player.on] Autoadvance setting detected, calling play() to initiate playback after ad timeout"),this.play()}))})),this.ads(t),this.ads.ad=this.adDataStore&&this.adDataStore.adData||{},this.ads.ad.skipped=0,this.ads.ad.interaction=0,this.ads.pod=this.adDataStore&&this.adDataStore.podData||{},this.contribAds6Shim(a.default.mergeOptions({},t.contribAds6Shim||{})),"oncue"===t.requestMode?ie.init(this,t):"ondemand"===t.requestMode&&Ie(this),this.ima3=je(this,t),nt(this),this.ready((()=>{const e=a.default.getTech("Html5");if(!e||!e.isSupported())throw new Error("Html5 is not available on this platform.");rt(this,t),this.addClass("vjs-ima3-html5")}),!0)};dt.Error=z,dt.version=Ne,dt.VERSION=Ne,function(e){if(le("ima3"))return!1;const t=le("ads");(function(e,t){const a=de(e),n=t?de(t):se;return!(!n||!a||a[0]!==n[0]||a[1]<n[1]||!(a[1]>n[1]||a[2]>=n[2]))})(t.VERSION)||a.default.log.error(`The IMA plugin depends on contrib-ads version "${se}", but it saw version "${t.VERSION}". This is not a compatible configuration. The IMA plugin will attempt to continue initializing, but this problem should be addressed. If you are using ad failover, please select compatible versions of the SSAI and IMA plugins.`),a.default.use("*",oe),(a.default.registerPlugin||a.default.plugin)("ima3",e)}(dt)}));
