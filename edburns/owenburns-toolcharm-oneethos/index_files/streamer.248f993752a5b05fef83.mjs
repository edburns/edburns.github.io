/*! For license information please see streamer.248f993752a5b05fef83.mjs.LICENSE.txt */
(()=>{var e={1386:(e,t,r)=>{"use strict";r.r(t);var s=r(3379),i=r.n(s),n=r(9037),a=r.n(n),o=r(569),c=r.n(o),l=r(3565),u=r.n(l),h=r(9216),b=r.n(h),f=r(2566),d={};d.setAttributes=u(),d.insert=c().bind(null,"head"),d.domAPI=a(),d.insertStyleElement=b(),i()(f.Z,d);const m=f.Z&&f.Z.locals?f.Z.locals:void 0;var p=r(4149),g=r.n(p);function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},y.apply(this,arguments)}const v="streamer",w="txt",S="data-field",k="data-symbol",M="data-stream",P="data-value",T="value",C="active";class E extends HTMLElement{constructor(){var e,t,r,s;super(),e=this,r=({isIntersecting:e})=>{if(this.isIntersecting=e,e&&!this.subscribed){const e=this.getAttribute(S),t=this.getAttribute(k);this.value=parseFloat(this.getAttribute(P)||this.getAttribute(T)||""),t&&e&&(this.subscribe({symbols:[t],fields:[e]}),this.subscribed=!0)}},(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t="onView"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,this.initialized=!1,this.subscribed=!1,this.isIntersecting=!1,this.cssToggle=!1,this.value=void 0,this.transform=null,this.onUpdate=this.onUpdate.bind(this)}static get observedAttributes(){return[k,S,C]}onUpdate(e,{field:t,quote:r}={field:"",quote:{}}){if(!e&&"number"!=typeof e||this._stopUpdate)return;if(null!=r&&r.symbol&&r.symbol!==this.getAttribute(k))return;const s="object"!=typeof e?{raw:e,fmt:e}:e,{raw:i}=s;if(this.value!==i){const e=this.getAttribute("changeev");e&&this.dispatchEvent(new CustomEvent(`finWebCore_${e}`,{detail:y({},s,{field:t,quote:r}),bubbles:!0})),this.cssToggle=!this.cssToggle;const n=i-this.value;this.value=i,this.render(y({},s,{trend:n}))}}subscribe({symbols:e,fields:t}){var r;e&&t&&e.length&&t.length&&this.hasAttribute(C)&&"function"==typeof(null==(r=window.finStreamer)?void 0:r.subscribe)&&window.finStreamer.subscribe({subscriberType:"quote",symbols:e,fields:t,userId:this.getAttribute("data-userid")||"",type:this.getAttribute(M)||v,priceHint:this.getAttribute("data-pricehint"),formatStyle:this.getAttribute("data-fstyle"),callback:this.onUpdate})}unsubscribe({symbols:e,fields:t}){var r;e&&t&&e.length&&t.length&&"function"==typeof(null==(r=window.finStreamer)?void 0:r.unsubscribe)&&window.finStreamer.unsubscribe({subscriberType:"quote",symbols:e,fields:t,type:this.getAttribute(M)||v,callback:this.onUpdate})}connectedCallback(){var e;this.initialized||(null==(e=window.finStreamer)||e.observe(this,{cb:this.onView}),this.initialized=!0)}disconnectedCallback(){var e;const t=this.getAttribute(S),r=this.getAttribute(k);r&&t&&this.unsubscribe({symbols:[r],fields:[t]}),null==(e=window.finStreamer)||e.unobserve(this),this.initialized=!1,this.isIntersecting=!1,this.subscribed=!1}attributeChangedCallback(e,t,r){if(this.initialized)switch(e){case k:t!==r&&r&&(this._stopUpdate=!0,this.unsubscribe({symbols:[t],fields:[this.getAttribute(S)]}),this.subscribe({symbols:[r],fields:[this.getAttribute(S)]}),this._stopUpdate=!1);break;case S:t!==r&&r&&(this._stopUpdate=!0,this.unsubscribe({symbols:[this.getAttribute(k)],fields:[t]}),this.subscribe({symbols:[this.getAttribute(k)],fields:[r]}),this._stopUpdate=!1);break;case C:{const e=null!==t,s=null!==r;e&&!s?(this._stopUpdate=!0,this.unsubscribe({symbols:[this.getAttribute(k)],fields:[this.getAttribute(S)]}),this._stopUpdate=!1):!e&&s&&this.subscribe({symbols:[this.getAttribute(k)],fields:[this.getAttribute(S)]})}break;case T:case P:if(this.hasAttribute(P)&&e===T)break;this.value=parseFloat(r)}}render(e){if(!this.isIntersecting)return;"function"==typeof this.transform&&(e=this.transform(e));const{raw:t,trend:r}=e,s=this.getAttribute("data-trend")||w,i=this.getAttribute("data-template"),n=this.getAttribute("data-dfield")||"fmt";let a=m.base,o="";if(t>0)switch(s){case"bg":a+=` ${m.posBgColor}`,o="+";break;case w:a+=` ${m.posColor}`,o="+"}else if(t<0)switch(s){case"bg":a+=` ${m.negBgColor}`;break;case w:a+=` ${m.negColor}`}r>0?a+=` ${this.cssToggle?m.trendUp1:m.trendUp2}`:r<0&&(a+=` ${this.cssToggle?m.trendDown1:m.trendDown2}`);let c=o+(e[n]||"");i&&(c=function(e,t){let r=e,s=!1;return Object.keys(t).forEach((e=>{t[e]&&(s=!0),r=r.replace(new RegExp(`{${e}}`,"g"),t[e])})),s?r:""}(i,{raw:t,fmt:c})),this.children[0]?g().mutate((()=>{this.children[0].className=a,this.children[0].textContent=c})):this.innerHTML=`<span class="${a}">${c}</span>`}}window.customElements&&!window.customElements.get("fin-streamer")&&window.customElements.define("fin-streamer",E)},2566:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(8081),i=r.n(s),n=r(3645),a=r.n(n)()(i());a.push([e.id,':root{--finc-text1:var(--text1,#232a31);--finc-text2:var(--text2,#464e56);--finc-text3:var(--text3,#5b636a);--finc-separator:var(--separator,#e0e4e9);--finc-link:var(--link,#0f69ff);--finc-link-active:var(--link-active,#125bd4);--finc-link-selected:var(--link-selected,#7e1fff);--finc-link-inverse:var(--link-inverse,#e0f0ff);--finc-surface1:var(--surface1,#fff);--finc-surface2:var(--surface2,#f0f3f5);--finc-surface3:var(--surface3,#fff);--finc-surface4:var(--surface4,#fff);--finc-positive:var(--positive,#037b4b);--finc-negative:var(--negative,#d60a22);--finc-neutral:var(--neutral,#5b636a);--finc-positive-bg:var(--positive-bg,#00853c1a);--finc-negative-bg:var(--negative-bg,#bd14141a)}.c048f196{color:blue}.d60f3b00{contain:strict;position:relative;white-space:nowrap;z-index:0}.d60f3b00:after,.d60f3b00:before,.dd76d487{content:"";display:block;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%;z-index:-1}.d60f3b00:after,.d60f3b00:before{pointer-events:none;will-change:opacity}.d60f3b00:before{background-color:var(--finc-positive-bg)}.d60f3b00:after{background-color:var(--finc-negative-bg)}.c4af00a5{color:var(--finc-positive)}.d5882186{color:var(--finc-negative)}.dcb80a14{background-color:var(--finc-positive)}.d715d5bd,.dcb80a14{border-radius:3px;color:#fff;padding:2px 10px}.d715d5bd{background-color:var(--finc-negative)}.cf250f61{font-size:0.75rem}.f789f72d{font-size:0.875rem;font-weight:700}.a0e438cd{font-weight:500;margin-left:4px}@keyframes c82607e9{25%{opacity:1}75%{opacity:1}to{opacity:0}}@keyframes f25722dc{25%{opacity:1}75%{opacity:1}to{opacity:0}}@keyframes fd35c30c{25%{opacity:1}75%{opacity:1}to{opacity:0}}@keyframes bc077484{25%{opacity:1}75%{opacity:1}to{opacity:0}}.f95fa3d6{background-color:var(--finc-positive-bg)}.a892b718{background-color:var(--finc-negative-bg)}.ce287acb:before{animation:c82607e9 .7s}.f80689d3:before{animation:f25722dc .7s}.c956d6fc:after{animation:fd35c30c .7s}.fc6ee16d:after{animation:bc077484 .7s}',""]),a.locals={activeMarketColor:"#ff7b12","c-fuji-blurple":"#5d5eff","c-fuji-grape-jelly":"#6001d2",boxShadow:"0 2px 4px rgba(0,0,0,.2)",overlayModalBgColor:"rgba(50,50,50,0.6)",newsItemWidth:"calc(100% - 50px)",xs:"0.688rem",xss:"0.75rem",s:"0.813rem",sm:"0.875rem",m:"0.938rem",ml:"1rem",l:"1.125rem",dummy:"c048f196",base:"d60f3b00",baseCommon:"dd76d487",posColor:"c4af00a5",negColor:"d5882186",posBgColor:"dcb80a14",negBgColor:"d715d5bd",marketNotice:"cf250f61",prepostCont:"f789f72d",prepostChange:"a0e438cd",trendUp:"f95fa3d6",trendDown:"a892b718",trendUp1:"ce287acb",trendAnimUp1:"c82607e9",trendUp2:"f80689d3",trendAnimUp2:"f25722dc",trendDown1:"c956d6fc",trendAnimDown1:"fd35c30c",trendDown2:"fc6ee16d",trendAnimDown2:"bc077484"};const o=a},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",s=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),s&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),s&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,s,i,n){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(s)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);s&&a[u[0]]||(void 0!==n&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=n),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},4149:function(e,t,r){var s;!function(t){"use strict";var i=function(){},n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return setTimeout(e,16)};function a(){var e=this;e.reads=[],e.writes=[],e.raf=n.bind(t),i("initialized",e)}function o(e){e.scheduled||(e.scheduled=!0,e.raf(c.bind(null,e)),i("flush scheduled"))}function c(e){i("flush");var t,r=e.writes,s=e.reads;try{i("flushing reads",s.length),e.runTasks(s),i("flushing writes",r.length),e.runTasks(r)}catch(e){t=e}if(e.scheduled=!1,(s.length||r.length)&&o(e),t){if(i("task errored",t.message),!e.catch)throw t;e.catch(t)}}function l(e,t){var r=e.indexOf(t);return!!~r&&!!e.splice(r,1)}a.prototype={constructor:a,runTasks:function(e){var t;for(i("run tasks");t=e.shift();)t()},measure:function(e,t){i("measure");var r=t?e.bind(t):e;return this.reads.push(r),o(this),r},mutate:function(e,t){i("mutate");var r=t?e.bind(t):e;return this.writes.push(r),o(this),r},clear:function(e){return i("clear",e),l(this.reads,e)||l(this.writes,e)},extend:function(e){if(i("extend",e),"object"!=typeof e)throw new Error("expected object");var t=Object.create(this);return function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}(t,e),t.fastdom=this,t.initialize&&t.initialize(),t},catch:null};var u=t.fastdom=t.fastdom||new a;void 0===(s=function(){return u}.call(u,r,u,e))||(e.exports=s)}("undefined"!=typeof window?window:this)},3379:e=>{"use strict";var t=[];function r(e){for(var r=-1,s=0;s<t.length;s++)if(t[s].identifier===e){r=s;break}return r}function s(e,s){for(var n={},a=[],o=0;o<e.length;o++){var c=e[o],l=s.base?c[0]+s.base:c[0],u=n[l]||0,h="".concat(l," ").concat(u);n[l]=u+1;var b=r(h),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==b)t[b].references++,t[b].updater(f);else{var d=i(f,s);s.byIndex=o,t.splice(o,0,{identifier:h,updater:d,references:1})}a.push(h)}return a}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var n=s(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<n.length;a++){var o=r(n[a]);t[o].references--}for(var c=s(e,i),l=0;l<n.length;l++){var u=r(n[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}n=c}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var s=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(r)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},9037:e=>{"use strict";var t,r=(t=[],function(e,r){return t[e]=r,t.filter(Boolean).join("\n")});function s(e,t,s,i){var n;if(s)n="";else{n="",i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,a&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}")}if(e.styleSheet)e.styleSheet.cssText=r(t,n);else{var o=document.createTextNode(n),c=e.childNodes;c[t]&&e.removeChild(c[t]),c.length?e.insertBefore(o,c[t]):e.appendChild(o)}}var i={singleton:null,singletonCounter:0};e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=i.singletonCounter++,r=i.singleton||(i.singleton=e.insertStyleElement(e));return{update:function(e){s(r,t,!1,e)},remove:function(e){s(r,t,!0,e)}}}},477:e=>{"use strict";e.exports=function(e,t,r,s){var i=self||window;try{try{var n;try{n=new i.Blob([e])}catch(t){(n=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),n=n.getBlob()}var a=i.URL||i.webkitURL,o=a.createObjectURL(n),c=new i[t](o,r);return a.revokeObjectURL(o),c}catch(s){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),r)}}catch(e){if(!s)throw Error("Inline worker is not supported");return new i[t](s,r)}}}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={id:s,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="https://s.yimg.com/uc/finance/webcore/",r.nc=void 0,(()=>{"use strict";class e{constructor(e,t){this.subscriberMap=e.earnings,this.channels=t}addSubscriber(e,t,r=!1){void 0===this.subscriberMap[e]&&(this.subscriberMap[e]={callback:t,paused:r})}subscribeToWorker(e){this.channels.streamer.port1.postMessage({subscriberType:"earnings",cmd:"subscribe",symbols:e})}removeSubscriber(e){delete this.subscriberMap[e]}unsubscribeFromWorker(e){this.channels.streamer.port1.postMessage({subscriberType:"earnings",cmd:"unsubscribe",symbols:e})}onUpdate(e){const t=[],{earningsData:r}=e||{};r&&(Object.values(r).forEach((e=>{const{symbol:s}=e;r&&this.subscriberMap[s]&&t.push([{callback:this.subscriberMap[s].callback},r])})),t.forEach((e=>{e[0].callback(e[1],e[2])})))}}var t=r(477),s=r.n(t);function i(){return s()('/*! For license information please see portfolio.worker.df0761c07d30081fe88f.worker.mjs.LICENSE.txt */\n(()=>{"use strict";function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},e.apply(this,arguments)}function t(e,t,a){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?r:String(r))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const a=["quoteType","regularMarketPrice","regularMarketChange","regularMarketChangePercent","currency"],r=["annualGainPercentage","currentMarketValue","dailyGain","purchasedMarketValue","totalGain"],s=[...r,"dailyPercentGain","totalPercentGain"];function i(e,t){let a;return(...r)=>{clearTimeout(a),a=setTimeout((()=>e(...r)),t)}}class n{constructor({enableStreaming:n=!0,messagePort:o,streamerPort:l,lang:c="en-US",region:u="US"}={messagePort:null,streamerPort:null}){var h=this;t(this,"getCurrentMarketValue",(({quantity:e,price:t,exchangeRate:a=1})=>e&&t?e*t/a:0)),t(this,"getDailyGain",(({quantity:e,change:t,exchangeRate:a=1})=>e&&t?e*t/a:0)),t(this,"getTotalGain",(({quantity:e,purchasePrice:t,price:a,exchangeRate:r=1})=>e&&t&&a?e*(a-t)/r:0)),t(this,"getTotalPercentGain",(({totalGain:e,marketValue:t})=>{const a=Math.abs(t-e);return 0===a?100*e:e?100*e/a:0})),t(this,"getDailyPercentGain",(({dailyGain:e,marketValue:t})=>{const a=Math.abs(t-e);return 0===a?100*e:e?100*e/a:0})),t(this,"getPurchasedMarketValue",(({purchasePrice:e,quantity:t,exchangeRate:a=1})=>Math.abs(t)*e/a)),t(this,"getAnnualGain",((e,t,a,r)=>{if(!e)return 0;let s;if(a)s=new Date(+a.slice(0,4),+a.slice(4,6)-1,+a.slice(6,8)).getTime();else{const e=new Date;e.setHours(0,0,0,0),e.setMonth(0,1),s=e.getTime()}return(t/e)**(365/((r-s)/864e5|0))-1})),t(this,"getExchangeRateSymbol",((e,t)=>`${"USD"===t?"":t}${e}=X`)),t(this,"getExchangeRate",((e,t,a)=>{let r=1;if(e!==t){var s;const i=this.getExchangeRateSymbol(e,t);null!=(s=a[i])&&s.regularMarketPrice&&(r=a[i].regularMarketPrice,"GBp"===e&&(r*=100))}return r})),t(this,"getSymbolExchangeRate",((e,t,a)=>{const r=a[t];return this.getExchangeRate(r.currency,e,a)})),t(this,"getSubscriptionSymbols",(()=>{const e=[],t=[],{quotes:a}=this.portfolios,r=this.portfolios.baseCurrency||"USD",s=Object.keys(this.portfolios.portfolios);for(let n=0;n<s.length;n++){var i;const o=s[n],l=null!=(i=this.portfolios.portfolios[o])?i:{},{baseCurrency:c="USD",cashPosition:u,cashCurrency:h="USD",currentMarketValue:g,positions:f=[]}=l;if(Array.isArray(f)&&"number"==typeof g)for(let r=0;r<f.length;r++){const{lots:s,symbol:i}=f[r];if((null==s?void 0:s.length)>0&&a[i]){const{currency:r}=a[i];r&&r!==c&&(t.push(this.getExchangeRateSymbol(c,r)),t.push(this.getExchangeRateSymbol(r,c))),e.push(i)}}"number"==typeof u&&h!==c&&(t.push(this.getExchangeRateSymbol(c,h)),t.push(this.getExchangeRateSymbol(h,c))),c!==r&&(t.push(this.getExchangeRateSymbol(r,c)),t.push(this.getExchangeRateSymbol(c,r)))}return[...new Set(e.concat(t))]})),t(this,"getPortfolioQuotes",(()=>{const e={all:{price:{priceHint:2}}},t=new Set(this.symbolList.map((e=>e.split(":")[0]))),a=Object.keys(this.portfolios.portfolios);for(let r=0;r<a.length;r++){const i=a[r],n=this.portfolios.portfolios[i],o=t.has(i);o&&(e[i]={price:{priceHint:2}}),s.forEach((t=>{o&&(e[i].price[t]=n[t]||0)}))}return s.forEach((t=>{e.all.price[t]=this.portfolios[t]||0})),e})),t(this,"computePortfolios",(e=>{const t={currentMarketValue:0,purchasedMarketValue:0,totalGain:0,dailyGain:0,totalPercentGain:0,dailyPercentGain:0,annualGainPercentage:0},{baseCurrency:a="USD"}=this.portfolios,i=Object.keys(this.portfolios.portfolios);for(let s=0;s<i.length;s++){const n=i[s],o=this.portfolios.portfolios[n];if(!o.includeInTotalCalculation)continue;this.computePortfolio(o,e);const l=this.getExchangeRate(o.baseCurrency||"USD",a,e);r.forEach((e=>{t[e]+="number"==typeof o[e]?o[e]/l:0}))}t.dailyPercentGain=this.getDailyPercentGain({dailyGain:t.dailyGain,marketValue:t.currentMarketValue}),t.totalPercentGain=this.getTotalPercentGain({marketValue:t.currentMarketValue,totalGain:t.totalGain}),s.forEach((e=>{this.portfolios[e]=t[e]}))})),t(this,"computePortfolio",((t,a)=>{if(!t||!t.includeInTotalCalculation)return;const{positions:i=[],baseCurrency:n="USD",pfId:o}=null!=t?t:{},l={currentMarketValue:0,purchasedMarketValue:0,totalGain:0,dailyGain:0,totalPercentGain:0,dailyPercentGain:0};if("number"==typeof t.cashPosition){const e=this.getExchangeRate(t.cashCurrency,n,a);l.currentMarketValue+=t.cashPosition/e}for(let t=0;t<i.length;t++){const s=i[t],{lots:o,symbol:c}=s,u=a[c],h={currentMarketValue:0,purchasedMarketValue:0,totalGain:0,dailyGain:0,totalPercentGain:0,dailyPercentGain:0,annualGainPercentage:0},g=null==u?void 0:u.currency;if((null==o?void 0:o.length)>0){const s=g?this.getSymbolExchangeRate(n,c,a):1,l=Date.now();for(let a=0;a<o.length;a++){const n=o[a],c={};if(g){const{regularMarketPrice:e,regularMarketChange:t,regularMarketChangePercent:a,quoteType:r}=u,i="OPTION"===r?100*n.quantity:n.quantity;"number"==typeof i&&(c.currentMarketValue=this.getCurrentMarketValue({quantity:i,price:e,exchangeRate:s}),n.purchasePrice&&(c.totalGain=this.getTotalGain({quantity:i,purchasePrice:n.purchasePrice,price:e,exchangeRate:s}),c.purchasedMarketValue=this.getPurchasedMarketValue({purchasePrice:n.purchasePrice,quantity:i,exchangeRate:s})),"number"==typeof t&&(c.dailyGain=this.getDailyGain({quantity:i,change:t,exchangeRate:s}))),"number"==typeof e&&"number"==typeof n.purchasePrice&&(c.totalPercentGain=this.getTotalPercentGain({marketValue:n.currentMarketValue,totalGain:c.totalGain}),c.annualGainPercentage=this.getAnnualGain(n.purchasePrice,e,n.tradeDate,l)),"number"==typeof a&&(c.dailyPercentGain=this.getDailyPercentGain({dailyGain:c.dailyGain,marketValue:c.currentMarketValue}))}i[t].lots[a]=e({},o[a],c),r.forEach((e=>{h[e]+="number"==typeof o[a][e]?o[a][e]:0}))}}r.forEach((e=>{i[t][e]=h[e],l[e]+="number"==typeof i[t][e]?i[t][e]:0})),i[t].dailyPercentGain=this.getDailyPercentGain({dailyGain:i[t].dailyGain,marketValue:i[t].currentMarketValue}),i[t].totalPercentGain=this.getTotalPercentGain({totalGain:i[t].totalGain,marketValue:i[t].currentMarketValue})}l.dailyPercentGain=this.getDailyPercentGain({dailyGain:l.dailyGain,marketValue:l.currentMarketValue}),l.totalPercentGain=this.getTotalPercentGain({totalGain:l.totalGain,marketValue:l.currentMarketValue}),s.forEach((e=>{this.portfolios.portfolios[o][e]=l[e]}))})),t(this,"onStreamerMessage",i((t=>{var a;const{data:r}=t,{quoteData:s}=r||{};s&&0!==this.symbolList.length&&null!=(a=this.portfolios)&&a.portfolios&&this.enableStreaming&&(this.portfolios.quotes=e({},this.portfolios.quotes,s),this.computePortfolios(this.portfolios.quotes),this.sendUpdate())}),500)),t(this,"sendUpdate",(()=>{if(this._recentlyPolled)return;const e=this.getPortfolioQuotes();this.messagePort.postMessage({subscriberType:"quote",quoteData:e})})),t(this,"parsePfResponse",(t=>{const[a]=t.finance.result,r={},{portfolios:i}=a;for(let e=0;e<i.length;e++){const t=i[e];r[t.pfId]=t}this.portfolios=e({},a),this.portfolios.portfolios=r,s.forEach((e=>{"number"==typeof this.portfolios[`${e}WithBeta`]&&(this.portfolios[e]=this.portfolios[`${e}WithBeta`])}))})),t(this,"resetPolling",(()=>{this.intervalHandle&&(clearInterval(this.intervalHandle),this.intervalHandle=null),this._fetching=!1})),t(this,"fetchPortfolios",(async function({crumb:e="",userId:t="",shouldSendUpdate:r=!0}={}){if(h._fetching)return;h._fetching=!0;const s=h.crumb||e||"",i=h.userId||t||"",{lang:n}=h,{region:o}=h;try{const e=await function(e,{method:t="GET",body:a,timeout:r=1e4}={}){return new Promise(((s,i)=>{const n=new XMLHttpRequest;n.open(t,e,!0),n.timeout=r,n.withCredentials=!0,n.onload=()=>{let e=n.responseText;if(n.status>=200&&n.status<300&&e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return void i({status:502,message:e.message})}s(e)}else i({status:n.status||502,message:n.responseText})},n.onerror=()=>{i({status:n.status||500,message:n.responseText})},n.send(a)}))}(`https://query2.finance.yahoo.com/v7/finance/desktop/portfolio?formatted=false&fields=${a.join(",")}&crumb=${s}&userId=${i}&includeBetaVersion=1&lotCount=10&userIdType=guid&lang=${n}&region=${o}`);h._fetching=!1,h.parsePfResponse(e),h.messagePort.postMessage({cmd:"subscribe",subscriberType:"quote",symbols:h.getSubscriptionSymbols()}),r&&(h.sendUpdate(),h._recentlyPolled=!0,setTimeout((()=>{h._recentlyPolled=!1}),500))}catch(e){h._fetching=!1,console.error("> finance portfolio.streamer:",e)}})),t(this,"loadPortfolios",i((async function({crumb:e="",userId:t=""}={}){h.fetchPortfolios({crumb:e,shouldSendUpdate:!1,userId:t}),h.resetPolling(),h.intervalHandle||(h.intervalHandle=setInterval((()=>{h.fetchPortfolios({crumb:e,userId:t})}),h.enableStreaming?3e4:15e3))}),1e3)),t(this,"subscribe",(async function({crumb:e="",userId:t="",symbols:a=[],fields:r=[]}={}){const s=new Set(a),i=h.symbolList.length>0?h.symbolList.filter((e=>!s.has(e))):[...s];0!==i.length&&(h.update({crumb:e,symbols:a,fields:r,userId:t}),i.length>0&&await h.loadPortfolios({crumb:e,userId:t}))})),t(this,"unsubscribe",(({crumb:e="",fields:t=[],symbols:a=[]}={})=>{if(!this.symbolList.length)return;const r=new Set(a),s=this.symbolList.filter((e=>!r.has(e)));this.update({crumb:e,symbols:a,fields:t,userId:""}),s.length>0&&this.messagePort.postMessage({cmd:"unsubscribe",subscriberType:"quote",symbols:this.getSubscriptionSymbols()}),0===this.symbolList.length&&this.resetPolling()})),t(this,"destroy",(()=>{this.portfolios={portfolios:{},quotes:{}},this.symbolList=[],this.fieldList=[],this.userId="",this.crumb=""})),t(this,"update",(({crumb:e,symbols:t,fields:a,userId:r})=>{this.crumb=e||"",this.symbolList=t,this.fieldList=a,r&&(this.userId=r)})),this.portfolios={portfolios:{},quotes:{}},this.messagePort=o,this.enableStreaming=n,this.streamerPort=l,this.lang=c,this.region=u,this.symbolList=[],this.fieldList=[],this.crumb="",this.userId="",this.intervalHandle=null,this._fetching=!1,this._recentlyPolled=!1}}let o=null,l=null,c=!0,u=null,h="en-US",g="US";function f(e){const{data:t}=e;switch(t.cmd){case"subscribe":u||(u=new n({messagePort:o,enableStreaming:c,streamerPort:l,lang:h,region:g})),u.subscribe(t);break;case"unsubscribe":u.unsubscribe(t);break;case"destroy":u&&(u.destroy(),u=null)}}addEventListener("message",(e=>{const{data:t}=e,{enableStreaming:a,lang:r,region:s}=t;switch(t.cmd){case"init":[o]=e.ports,c=a,h=r,g=s,o.onmessage=f;break;case"init-qpf":[l]=e.ports,l.onmessage=e=>{u&&u.onStreamerMessage.call(u,e)}}}),!1)})();',"Worker",void 0,r.p+"js/portfolio.worker.df0761c07d30081fe88f.worker.mjs")}const n={};function a(e,t="en-US",r={}){const s=`${t}${e}`;return n[s]||(n[s]=Intl.NumberFormat(t,r)),n[s]}function o({field:e,value:t,lang:r="en-US",priceHint:s,gmtOffSetMilliseconds:i,timeZoneShort:n,formatStyle:o}){const c={raw:t};switch(e){case"regularMarketVolume":case"marketCap":{c.fmt=function(e,t=3){const r=Math.abs(e);return r>=1e12?`${(e/1e12).toFixed(t)}T`:r>=1e9?`${(e/1e9).toFixed(t)}B`:r>=1e6?`${(e/1e6).toFixed(t)}M`:r>=1e3?`${(e/1e3).toFixed(t)}k`:e.toFixed(0)}(t);const e=a("marketCap",r,{maximumFractionDigits:0});c.longFmt=e.format(t);break}case"dailyPercentGain":case"totalPercentGain":case"extendedMarketChangePercent":case"postMarketChangePercent":case"preMarketChangePercent":case"regularMarketChangePercent":{let e=t;isNaN(t)||(e=t/100);const i=s?{minimumFractionDigits:s,maximumFractionDigits:s}:{minimumFractionDigits:2,maximumFractionDigits:4};i.style="percent";const n=a(`regularMarketChangePercent${s}`,r,i);c.fmt=n.format(e);break}case"extendedMarketTime":case"preMarketTime":case"postMarketTime":case"regularMarketTime":c.fmt=n&&"number"==typeof i?function(e,t,r){let s="string"==typeof(i=t)?Number(i):"number"==typeof i?i:"object"==typeof i&&i instanceof Date?i.getTime():Date.now();var i;return void 0!==e.gmtOffSetMilliseconds&&("string"==typeof e.gmtOffSetMilliseconds&&(e.gmtOffSetMilliseconds=Number(e.gmtOffSetMilliseconds)),n=s,a=e.gmtOffSetMilliseconds,s=isNaN(a)?n:n+6e4*new Date(n).getTimezoneOffset()+a),function(e,t={}){const{useUTC:r=!1,fmt:s="%I:%M%P",timeZoneShort:i=""}=t;let n="",a="",o="",c="",l=0,u=0,h="";for(;-1!==(u=s.indexOf("%",u));){switch(l!==u&&(c+=s.substring(l,u)),u+=1,h=s[u],h){case"l":case"I":a||(a=r?e.getUTCHours():e.getHours(),a<12?(a=0===a?"12":String(a),n="am"):(a>12&&(a-=12),a=String(a),n="pm")),"I"===h&&1===a.length?c+=`0${a}`:c+=a;break;case"M":o||(o=String(r?e.getUTCMinutes():e.getMinutes()),1===o.length&&(o=`0${o}`)),c+=o;break;case"p":case"P":n||(n=(r?e.getUTCHours():e.getHours())<12?"am":"pm"),c+="p"===h?"am"===n?"AM":"PM":n;break;case"Z":c+=i;break;case"%":c+="%";break;case"Y":c+=e.getFullYear();break;case"m":c+=`0${e.getMonth()+1}`.slice(-2);break;case"d":c+=`0${e.getDate()}`.slice(-2)}u+=1,l=u}return l<s.length&&(c+=s.substr(l)),c}(new Date(s),{fmt:r||"%l:%M %p %Z",timeZoneShort:e.timeZoneShort,useUTC:e.useUTC});var n,a}({timeZoneShort:n,gmtOffSetMilliseconds:i},1e3*t,"%l:%M%p %Z"):"-";break;default:{const e=s?{minimumFractionDigits:s,maximumFractionDigits:s}:{minimumFractionDigits:2,maximumFractionDigits:4};o&&(e.style=o);const i=a(`defaultFormatter${s}`,r,e);c.fmt=i.format(t)}}return c}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},c.apply(this,arguments)}const l={exchange:!0,shortName:!0,currency:!0,priceHint:!0,quoteType:!0,marketState:!0,symbol:!0,miniOption:!0,fromCurrency:!0,toCurrency:!0,lastMarket:!0,circulatingSupply:!0,optionsType:!0,longName:!0},u={dailyGain:!0,dailyPercentGain:!0,totalGain:!0,totalPercentGain:!0,annualGainPercentage:!0,currentMarketValue:!0},h="_isPortfolio";class b{constructor(e,t,r,s){this.subscriberMap=e.quotes,this.fieldMap=t,this.streamerCachedData=r,this.channels=s}addSubscriber(e,t,{callback:r,priceHint:s,formatStyle:i,permanent:n=!1}){e&&t&&r&&(this.subscriberMap[e]||(this.subscriberMap[e]={}),t.forEach((t=>{var a;const o=this.subscriberMap[e];o[t]||(o[t]=[]);const c={callback:r};if(s){const e="number"==typeof s?s:Number(s);isNaN(e)||(c.priceHint=e)}"string"==typeof i&&(c.formatStyle=i),!0===n&&(o._permanent=n),o[h]=!!u[t],o[t].push(c),this.fieldMap[t]=(null!=(a=this.fieldMap[t])?a:0)+1})))}removeSubscriber(e,t,r){if(!e||!t||!r)return;const s=this.subscriberMap[e];s&&(t.length||(t=Object.keys(s)),t.forEach((t=>{const i=s[t];if(!i)return;const n=i.findIndex((e=>e.callback===r));-1!==n&&(i.splice(n,1),this.fieldMap[t]--,0===i.length&&(delete this.subscriberMap[e][t],1===Object.keys(this.subscriberMap[e]).length&&delete this.subscriberMap[e]),0===this.fieldMap[t]&&delete this.fieldMap[t])})))}onUpdate(e,t,r){const{finWebCore:s}=window,i=[],{cmd:n,symbols:a,quoteData:u}=e||{};"subscribe"!==n?"unsubscribe"!==n?u&&(Object.entries(u).forEach((([e,t])=>{if(!t)return;const{price:r={},summaryDetail:n={}}=t,a=t.price?c({},r,n):t;this.streamerCachedData[e]=Object.assign({},this.streamerCachedData[e],a);const u=this.subscriberMap[e];u&&Object.entries(a).forEach((([t,r])=>{const n=u[t]||[],a={};for(const c of n){const{priceHint:n,gmtOffSetMilliseconds:u,exchangeTimezoneShortName:h,timeZoneShortName:b}=this.streamerCachedData[e],{priceHint:f,formatStyle:d}=c,m=`${f||n}${d}`;let p=a[m];void 0===p&&(p=l[t]?r:o({field:t,value:r,lang:(null==s?void 0:s.lang)||"en-US",priceHint:f||n,gmtOffSetMilliseconds:u,timeZoneShort:h||b,formatStyle:c.formatStyle}),a[m]=p),this.streamerCachedData[e][t]=p,i.push([c,p,{field:t,quote:this.streamerCachedData[e]}])}}))})),i.forEach((e=>{e[0].callback(e[1],e[2])}))):r({subscriberType:"quote",callback:Function.prototype,symbols:a,fields:["currency","regularMarketPrice","regularMarketChange"]}):t({subscriberType:"quote",callback:Function.prototype,symbols:a,fields:["currency","regularMarketPrice","regularMarketChange"]})}getSymbols(e=!1){const t=[];for(const r in this.subscriberMap){const s=e?this.subscriberMap[r][h]:!this.subscriberMap[r][h];Object.prototype.hasOwnProperty.call(this.subscriberMap,r)&&s&&t.push(r)}return t}subscribeToWorker(e,t){if(!e||0===e.length)return;const r=this.getSymbols(),s=this.getSymbols(!0);if(r.length>0){const t=e.filter((e=>void 0===u[e]));t.length>0&&this.messageToWorker({cmd:"subscribe",symbols:r,fields:t})}if(s.length>0){const r=e.filter((e=>u[e]));r.length>0&&this.messageToWorker({cmd:"subscribe",userId:t,symbols:s,fields:r},"portfolio")}}unsubscribeFromWorker(e){if(!e||0===e.length)return;const t=this.getSymbols(),r=this.getSymbols(!0);if(t.length>0){const r=e.filter((e=>void 0===u[e]));r.length>0&&this.messageToWorker({cmd:"unsubscribe",symbols:t,fields:r})}if(r.length>0){const t=e.filter((e=>u[e]));t.length>0&&this.messageToWorker({cmd:"unsubscribe",symbols:r,fields:t},"portfolio")}}pauseSubscription(e,t=!1){if((null==e?void 0:e.length)>0){const r=[],s=[];e.forEach((e=>{this.subscriberMap[e]._permanent||this.subscriberMap[e][h]||(r.push(e),Object.entries(this.subscriberMap[e]).forEach((([e])=>{"_permanent"!==e&&e!==h&&s.push(e)})))})),r.length>0&&this.messageToWorker({cmd:t?"subscribe":"unsubscribe",symbols:r,fields:Array.from(new Set(s))})}}messageToWorker(e,t="streamer"){const{finWebCore:r}=window;e.subscriberType="quote",e.crumb=(null==r?void 0:r.crumb)||"",e.channels=this.channels,void 0===e.userId&&(e.userId=(null==r?void 0:r.userId)||""),this.channels[t].port1.postMessage(JSON.parse(JSON.stringify(e)))}}function f(){return s()('/*! For license information please see streamer.worker.4db981fe5b4e331576b3.worker.mjs.LICENSE.txt */\n(()=>{"use strict";function e(e,t){let s;return(...r)=>{clearTimeout(s),s=setTimeout((()=>e(...r)),t)}}function t(e,t){if(isNaN(e))return e;const s=Math.pow(10,t);return+Math.round(e*s)/s}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},s.apply(this,arguments)}class r{constructor(t,r,n){var o,i,a,c;o=this,a=e=>{try{const{EarningSignals:t}=this.protobuf.roots.default.earningsignals;let r=t.decode(e);r=t.toObject(r,{enums:String}),Array.isArray(r)||(r=[r]);const n={};r.forEach((e=>{const{symbol:t}=null!=e?e:{};t&&(n[t]=s({},r[0]))})),this.messagePort.postMessage({subscriberType:"earnings",earningsData:n})}catch(e){console.error("> Error from Finance Earnings Streamer:",e)}},(i="symbol"==typeof(c=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i="handleWebSocketUpdate"))?c:String(c))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,this.symbolList=[],this.connection=n,this.retries=0,this.protobuf=t,this.messagePort=r,this.sendConnection=e(this.sendConnection.bind(this),1e3)}sendConnection(e){this.connection.send(e)}reset(){this.symbolList=[]}subscribe(e){const t=e.symbols.filter((e=>e.toLowerCase().indexOf("_earnings")>-1));this.symbolList=[...new Set([...this.symbolList,...t])],this.sendConnection(JSON.stringify({subscribe:this.symbolList}))}unsubscribe(e){var t;const{symbols:s}=e,r=new Set(s),n=this.symbolList.filter((e=>!r.has(e)));this.symbolList=this.symbolList.filter((e=>!n[e])),(null==(t=this.connection)?void 0:t.readyState)===WebSocket.OPEN&&n.length>0&&this.sendConnection(JSON.stringify({unsubscribe:n}))}}function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},n.apply(this,arguments)}function o(e,t,s){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?r:String(r))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const i={id:"symbol",dayVolume:"volume",dayHigh:"high",dayLow:"low",marketcap:"marketCap",marketHours:"marketState",openPrice:"regularMarketOpen",fromcurrency:"fromCurrency",vol_24hr:"volume24Hr",volAllCurrencies:"volumeAllCurrencies"},a={ask:!0,askSize:!0,bid:!0,bidSize:!0,dayLow:!0,dayHigh:!0,expireDate:!0},c={},u={change:!0,changePercent:!0,previousClose:!0,price:!0},l=["currency","fromCurrency","toCurrency","exchangeTimezoneName","exchangeTimezoneShortName","gmtOffSetMilliseconds","regularMarketChange","regularMarketChangePercent","regularMarketPrice","regularMarketTime","preMarketTime","postMarketTime","extendedMarketTime"];class b{constructor(s,r,l,b){o(this,"handleWebSocketUpdate",(e=>{try{const{PricingData:s}=this.protobuf.roots.default.quotefeeder;let r=s.decode(e);r=s.toObject(r,{enums:String}),Array.isArray(r)||(r=[r]),r.forEach((e=>{const{id:s}=null!=e?e:{};if(s){const r=function(e){const s={},r={},{marketHours:n}=e,o=e.priceHint||2;let l,b="";switch(n){case"PRE_MARKET":b="preMarket",l="PRE";break;case"REGULAR_MARKET":b="regularMarket",l="REGULAR";break;case"POST_MARKET":b="postMarket",l="POST";break;case"EXTENDED_HOURS_MARKET":b="extendedMarket",l="EXTENDED"}for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const h=i[n]||n;let m=e[n];if(null==m||""===m)continue;let d=h;switch(h){case"previousClose":case"price":case"time":case"dayHigh":case"dayLow":case"volume":case"changePercent":case"change":u[h]&&!isNaN(m)&&(m=t(m,o)),"time"===h&&(m/=1e3),d=b+h[0].toUpperCase()+h.substr(1);break;case"marketState":m=l}a[d]?(r[d]=m,d!==h&&(r[h]=m)):c[d]||(s[d]=m,d!==h&&(s[h]=m))}return{price:s,summaryDetail:r}}(e);this.quoteData[s]=n({},this.quoteData[s],r.price,r)}})),this.messagePort.postMessage({subscriberType:"quote",quoteData:this.quoteData}),this.pfMessagePort.postMessage({quoteData:this.quoteData})}catch(e){console.error("> Error from Finance Quote Streamer:",e)}})),o(this,"handleQuoteRequest",((e,t)=>{if(!e&&t){var s;const e=null==(s=t.quoteResponse)?void 0:s.result;if(!e)return;for(let t=0;t<e.length;t++){const s=e[t],{symbol:r}=s;this.quoteData[r]=n({},this.quoteData[r],s)}this.messagePort.postMessage({subscriberType:"quote",quoteData:this.quoteData}),this.pfMessagePort.postMessage({quoteData:this.quoteData})}else console.error("> Error from Finance Quote Streamer:",e)})),this.crumb="",this.symbolList=[],this.fieldList=[],this.connection=b,this.retries=0,this.quoteData={},this.protobuf=s,this.messagePort=r,this.pfMessagePort=l,this.sendConnection=e(this.sendConnection.bind(this),1e3)}seedQuoteData(){const e=this.symbolList.filter((e=>{var t;return!(null!=(t=this.quoteData[e])&&t.exchangeTimezoneName)}));if(e.length>0&&this.crumb){e.sort();const s=[[]];let r=0;for(let n=0;n<e.length;n++){var t;null!=(t=this.quoteData[n])&&t.currency||s[r].push(e[n]),30===s[r].length&&(r++,s[r]=[])}s.forEach((e=>{!function(e,{timeout:t=1e3,callback:s}){const r=new XMLHttpRequest;r.timeout=t,r.withCredentials=!0,r.open("GET",e,!0),r.onload=()=>{let e=r.responseText;if(r.status>=200&&r.status<300&&e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return void s({status:502,message:e.message})}s(null,e)}else s({status:r.status||502,message:r.responseText})},r.onerror=()=>{s({status:r.status||500,message:r.responseText})},r.send()}(`https://query1.finance.yahoo.com/v7/finance/quote?&symbols=${e.join(",")}&fields=${l.join(",")}&crumb=${this.crumb||""}&formatted=false&region=US&lang=en-US`,{callback:this.handleQuoteRequest})}))}}subscribe(e){const{crumb:t,symbols:s=[],fields:r=[]}=e||{};this.update({crumb:t,symbols:s,fields:r}),this.symbolList.length>0&&this.sendConnection(JSON.stringify({subscribe:this.symbolList}))}unsubscribe(e){var t;const{crumb:s,symbols:r=[],fields:n=[]}=e||{},o=new Set(r),i=this.symbolList.filter((e=>o.has(e)));this.update({crumb:s,symbols:r,fields:n}),(null==(t=this.connection)?void 0:t.readyState)===WebSocket.OPEN&&i.length>0&&this.sendConnection(JSON.stringify({unsubscribe:i}))}update({crumb:e,symbols:t,fields:s}){this.crumb=e||"",this.symbolList=t,this.fieldList=s}reset(){this.fieldList=[],this.symbolList=[]}sendConnection(e){this.connection.send(e),e.includes("subscribe")&&this.seedQuoteData()}}try{"function"==typeof importScripts&&(importScripts("https://cdn.jsdelivr.net/npm/protobufjs@7.1.2/dist/minimal/protobuf.min.js"),importScripts("https://s.yimg.com/uc/finance/webcore/js/_staticFinProtobuf.4b1559b8e4645fd93a12.mjs"))}catch(e){console.error("> Finance Streamer: Importing protobuff failed.",e)}protobuf||console.error("> Finance Streamer: Protobuff library missing so cannot use streamer");let h=null,m=null,d=null,f=null,p=null,g=0;function y(e=void 0){return e?"earnings"===e?(m||(m=new r(protobuf,d,p)),m):"quote"===e?(h||(h=new b(protobuf,d,f,p)),h):void 0:null}function v(e){const t=JSON.parse(e.data.toString()),s=function(e){const t=atob(e),s=t.length,r=new Uint8Array(s);for(let e=0;e<s;e++)r[e]=t.charCodeAt(e);return r}(t.message);"earnings"===t.type&&y("earnings").handleWebSocketUpdate(s),"pricing"===t.type&&y("quote").handleWebSocketUpdate(s)}function S(e){const{data:t}=e;switch(t.cmd){case"subscribe":y(t.subscriberType).subscribe(t);break;case"unsubscribe":y(t.subscriberType).unsubscribe(t);break;case"destroy":y("quote").reset(),y("earnings").reset(),p&&(p.close(),p=null)}}addEventListener("message",(async e=>{const{data:t}=e;switch(t.cmd){case"init":[d]=e.ports,d.onmessage=S,await new Promise(((e,t)=>{const s=()=>{g>10?t(new Error("Connection retries exceeded")):(p=new WebSocket("wss://streamer.finance.yahoo.com?version=2"),p.addEventListener("open",(()=>{e()})),p.addEventListener("error",(e=>{e&&"ECONNREFUSED"===e.code&&(g++,s())})),p.addEventListener("close",(e=>{e&&1e3!==e.code&&(g++,s())})),p.addEventListener("message",v))};s()})),p?d.postMessage({cmd:"connected"}):d.postMessage({cmd:"error",message:"Connection failed"});break;case"init-qpf":[f]=e.ports,f.onmessage=()=>{},f.postMessage({cmd:"Hello Portfolio worker from streamer worker"})}}),!1)})();',"Worker",void 0,r.p+"js/streamer.worker.4db981fe5b4e331576b3.worker.mjs")}function d(e="error",t,r={}){try{var s;if("function"==typeof(null==(s=window.context)?void 0:s.getActionContext)){const s=window.context.getActionContext();"function"==typeof s.beacon&&s.beacon(e,t,r)}else console["error"===e?"error":"log"](e,t,JSON.stringify(r))}catch(e){console.error(e)}}function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},m.apply(this,arguments)}const p=["https://query1.finance.yahoo.com","https://query2.finance.yahoo.com"],g=1e3;async function y(){var e;if(null!=(e=window.finWebCore)&&e.crumb)return window.finWebCore.crumb;const t=new URL(`${function(){const e=Math.floor(Math.random()*p.length);return p[e]}()}/v1/test/getcrumb`),r=await function(e,{method:t="GET",withCredentials:r=!0,headers:s={},body:i,timeout:n=g,errorMsg:a="Request failed",beaconString:o="financeWebCore",isFetchDisabled:c=!1,returnErrorInfo:l=!1}={}){return new Promise(((u,h)=>{const b=Date.now();function f(t={}){"object"==typeof t&&t&&(t.timestamp=b),d("info",o,{code:200,surl:e}),u(t)}function p(t={}){t.status=t.status||500,t.message=t.message||a,d("error",o,{code:t.status,msg:t.message,surl:e}),h(t)}c||void 0===window.fetch?function(e,{method:t="GET",withCredentials:r=!0,headers:s={},body:i,timeout:n=g,successCb:a,errorCb:o}){const c=new window.XMLHttpRequest;c.open(t,e,!0),c.timeout=n,c.withCredentials=r,c.onload=()=>{let e=c.responseText;if(c.status>=200&&c.status<300){if("string"==typeof e)try{e=""!==e?JSON.parse(e):{}}catch(e){return void o({status:502,message:e.message})}a(e)}else o({status:c.status||502,message:c.responseText})},c.onerror=()=>{o({status:c.status||500,message:c.responseText})};const l=m({},"GET"!==t?{"Content-Type":"application/json"}:{},s);Object.keys(l).forEach((e=>{c.setRequestHeader(e,l[e])})),c.send(i?JSON.stringify(i):void 0)}(e,{method:t,withCredentials:r,headers:s,body:i,timeout:n,successCb:f,errorCb:p}):function(e,{method:t="GET",withCredentials:r=!0,headers:s={},body:i,returnErrorInfo:n,timeout:a=g,successCb:o,errorCb:c}){const l=new window.AbortController;let u=!1;const h=setTimeout((function(){u=!0,l.abort(),clearTimeout(h),c({status:502,message:"Request Timeout"})}),a);window.fetch(e,{method:t,mode:"cors",credentials:r?"include":"omit",headers:m({},"GET"!==t?{"Content-Type":"application/json"}:{},s),signal:l.signal,body:i?JSON.stringify(i):null}).then((async e=>{if(!u){if(clearTimeout(h),!e.ok){let s;var t,r;throw n&&(s=null==(r=((null==(t=e.headers)||null==t.get||null==(t=t.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{}).finance)?void 0:r.error),m({status:e.status||502,message:e.statusText},s&&{info:s})}return e.text()}})).then((e=>{let t=e;"application/json"===((null==s?void 0:s["Content-Type"])||"application/json")&&(t=""!==e?JSON.parse(e):{}),o(t)})).catch((e=>{u||c(m({status:e.status||502,message:e.message},e.info&&{info:e.info}))}))}(e,{method:t,withCredentials:r,headers:s,body:i,returnErrorInfo:l,timeout:n,successCb:f,errorCb:p})}))}(t.toString(),{errorMsg:"crumb fetch failed",headers:{"Content-Type":"text/plain"},timeout:1e3});return window.finWebCore.crumb=r,r}function v(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=new WeakMap;"undefined"!=typeof window&&(window.finStreamer=new class{constructor(){var t,s,n,a=this;v(this,"updateSubscribers",(async function(e,t,{symbols:r,fields:s,callback:i,priceHint:n,formatStyle:o,permanent:c=!1}){for(const l of r)switch(e){case"add":switch(t){case"quote":a.streamers.quoteStreamer.addSubscriber(l,s,{callback:i,priceHint:n,formatStyle:o,permanent:c});break;case"earnings":a.streamers.earningsStreamer.addSubscriber(l,i)}break;case"remove":switch(t){case"quote":a.streamers.quoteStreamer.removeSubscriber(l,s,i);break;case"earnings":a.streamers.earningsStreamer.removeSubscriber(l)}}})),v(this,"onUpdate",(e=>{const{data:t}=e;if("connected"===t.cmd)return(r=this,s=w,i=function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(r,s),function(e,t){return t.get?t.get.call(e):t.value}(r,i)).call(this),this.initialized=!0,void window.dispatchEvent(new Event("FIN_STREAMER_READY"));var r,s,i;"error"!==t.cmd?"quote"===t.subscriberType?this.streamers.quoteStreamer.onUpdate(t,this.subscribe,this.unsubscribe):"earnings"===t.subscriberType&&this.streamers.earningsStreamer.onUpdate(t):window.dispatchEvent(new Event("FIN_STREAMER_ERROR"))})),v(this,"handleFocus",(()=>{const e=this.streamers.quoteStreamer.getSymbols();e.length>0&&this.pauseSubscription({subscriberType:"quote",symbols:e},!0)})),v(this,"handleBlur",(()=>{const e=this.streamers.quoteStreamer.getSymbols();e.length>0&&this.pauseSubscription({subscriberType:"quote",symbols:e})})),v(this,"subscribe",(({subscriberType:e,symbols:t,fields:r,userId:s,callback:i,priceHint:n,formatStyle:a,permanent:o=!1})=>{this.updateSubscribers("add",e,{symbols:t,fields:r,priceHint:n,formatStyle:a,permanent:o,callback:i}),this.initialized&&("quote"===e?this.streamers.quoteStreamer.subscribeToWorker(r,s):"earnings"===e&&this.streamers.earningsStreamer.subscribeToWorker(t))})),v(this,"unsubscribe",(({subscriberType:e,symbols:t,fields:r,callback:s})=>{this.initialized&&("quote"===e?this.streamers.quoteStreamer.unsubscribeFromWorker(r):"earnings"===e&&this.streamers.earningsStreamer.unsubscribeFromWorker(t),this.updateSubscribers("remove",e,{symbols:t,fields:r,callback:s}))})),v(this,"pauseSubscription",(({subscriberType:e,symbols:t},r=!1)=>{this.initialized&&"quote"===e&&this.streamers.quoteStreamer.pauseSubscription(t,r)})),v(this,"observe",((e,t)=>{this.intersectSubscribers.set(e,t),this.intersectObserver.observe(e)})),v(this,"unobserve",(e=>{this.intersectSubscribers.delete(e),this.intersectObserver.unobserve(e)})),v(this,"handleIntersection",(e=>{for(let t=0;t<e.length;t++){const r=e[t],{target:s}=r,{cb:i}=this.intersectSubscribers.get(s)||{};"function"==typeof i&&i({isIntersecting:r.isIntersecting,entry:r,observer:this.intersectObserver})}})),n={writable:!0,value:async function(){a.initialized||Promise.resolve().then(r.bind(r,1386)).then((()=>{a.initialized=!0}))}},function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,s=w),s.set(t,n),v(this,"init",(()=>{const e=new URLSearchParams(window.location.search);let t=!1;if(e.has("disableStreaming"))return;e.has("useStagingStreamer")&&(t=!0);const{finWebCore:r}=window,s=(null==r?void 0:r.lang)||"en-US",n=(null==r?void 0:r.region)||"US";var a,o;this.intersectSubscribers=new Map,this.intersectObserver||"undefined"==typeof IntersectionObserver||(this.intersectObserver=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0]})),void 0===f||this.worker||(this.worker=new f,this.channels.streamer.port1.onmessage=this.onUpdate,this.worker.postMessage({cmd:"init",useStagingStreamer:t},[this.channels.streamer.port2]),this.worker.postMessage({cmd:"init-qpf"},[this.channels["streamer:pf"].port2])),void 0===f||this.portfolioWorker||(this.portfolioWorker=new i,this.channels.portfolio.port1.onmessage=this.onUpdate,this.portfolioWorker.postMessage({cmd:"init",enableStreaming:null!=(a=null==r||null==(o=r.features)?void 0:o.includes("enablePfStreaming"))&&a,lang:s,region:n},[this.channels.portfolio.port2]),this.portfolioWorker.postMessage({cmd:"init-qpf"},[this.channels["streamer:pf"].port1])),addEventListener("focus",this.handleFocus),addEventListener("blur",this.handleBlur)})),this.subscriberMap={quotes:{},earnings:{}},this.fieldMap={},this.worker=null,this.portfolioWorker=null,this.channels={streamer:new MessageChannel,portfolio:new MessageChannel,"streamer:pf":new MessageChannel},this.initialized=!1,this.streamerCachedData={},this.streamers={earningsStreamer:new e(this.subscriberMap,this.channels),quoteStreamer:new b(this.subscriberMap,this.fieldMap,this.streamerCachedData,this.channels)}}},(async()=>{await y(),window.finStreamer.init()})())})()})();