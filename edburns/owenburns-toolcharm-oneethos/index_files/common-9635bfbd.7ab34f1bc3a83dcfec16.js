/*! For license information please see common-9635bfbd.7ab34f1bc3a83dcfec16.js.LICENSE.txt */
"use strict";(self.webpackChunk_vzmi_finance_cosaic=self.webpackChunk_vzmi_finance_cosaic||[]).push([[6158],{6027:(t,e,i)=>{var a=i(4603);var r,n;r="undefined"!=typeof window?window:i.g,(n=void 0!==a.mE?a.mE:r.CIQ).ChartEngine.prototype.setRange=function(t,e){n.isEmpty(t)&&(t={dtLeft:arguments[0],dtRight:arguments[1],padding:arguments[2],chart:arguments[3]},e=arguments[4]),this.staticRange&&(t.goIntoPast=t.goIntoFuture=!0),t.chart||(t.chart=this.chart),void 0===t.padding&&(t.padding=0);var i,a=!1,r=t.chart,o="string"==typeof t.dtLeft?new Date(t.dtLeft):t.dtLeft,s=new Date;t.dtRight&&(s="string"==typeof t.dtRight?new Date(t.dtRight):t.dtRight),o||(i=this.standardMarketIterator(s,null,r),o=i.previous(r.maxTicks),t.periodicity||(a=!0)),r.inflectionPoint=o,this.layout.range={dtLeft:o,dtRight:s};var l=this;function d(i){void 0===i&&(i=null);var n=0,d=0,h=new Date,c=t.base,u=t.periodicity,y=l.layout;if(t.goIntoFuture&&(!r.masterData.length||o>r.masterData[r.masterData.length-1].DT)){var g=r.masterData.length?r.masterData.pop():{DT:o},p=l.doCleanupGaps([g,{DT:s}],r,{cleanupGaps:"gap",noCleanupDates:!0});l.setMasterData(r.masterData.concat(p),r,{noCleanupDates:!0}),l.createDataSet(null,null,{appending:!0})}var v,m=r.dataSet,D=m.length;if(!m||0===D)return l.draw(),void(e&&e(i));if("day"===c&&u&&"day"===u.interval){var f=t.multiplier;n=D<f?0:D-f,d=D-1}else if("today"===c&&m[D-1].DT.getDate()<h.getDate()){var b=new Date(m[D-1].DT.getTime());b.getTime(),v=0;for(var w=D-1;w>=0;w--)if(m[w]&&m[w].DT.getDate()!=b.getDate()){b=new Date(+m[w+1].DT),v=w+1;break}n=v,d=D-1}else n="all"!=t.base&&(o.getTime()>=m[0].DT.getTime()||t.goIntoPast)?l.tickFromDate(o,r,null,!0):0,"all"!=t.base&&(s.getTime()<=m[D-1].DT.getTime()||t.goIntoFuture)?(d=l.tickFromDate(s,r))>D-1&&d--:d=D-1;var k=d-n+1;if(k<1)return l.draw(),void(e&&e(i));var T=t.padding||0;d<D-1&&(T=0);var M=(r.width-T)/k;for(var C in l.setCandleWidth(M,r),r.scroll=k-(d-D)-1,l.micropixels=1,l.panels)l.calculateYAxisMargins(l.panels[C].yAxis);t.dontSaveRangeToLayout?delete y.range:(delete t.chart,delete y.setSpan,y.range=t,l.changeOccurred("layout")),l.draw(),a||l.dispatch("periodicity",{stx:l,differentData:H,prevPeriodicity:{interval:j,periodicity:W,timeUnit:_}}),e&&e(i)}var h,c,u,y,g,p,v,m=0;function D(t){return t&&0===m?(r.scroll=L,l.setCandleWidth(x),l.layout.interval=j,l.layout.periodicity=W,l.layout.timeUnit=_,void(e&&e(t))):++m>10?(console.log("CIQ.ChartEngine.setRange(): Too many loads (10) from server. Stopping. Check periodicity logic."),void d()):void d()}if(this.quoteDriver){var f,b,w;if(a)f=this.layout.interval,w=this.layout.timeUnit,b=this.layout.periodicity;else if(t.periodicity){var k=n.cleanPeriodicity(t.periodicity.period,t.periodicity.interval,t.periodicity.timeUnit);f=k.interval,w=k.timeUnit,b=k.period}else{var T=s.getTime()-o.getTime();if(this.autoPickCandleWidth.turnOn){var M=0;M=this.autoPickCandleWidth.candleWidth?this.autoPickCandleWidth.candleWidth:this.chart.barsHaveWidth?5:2;var C,S=r.width/M,R=this.dynamicRangePeriodicityMap;f=R[0].interval,b=1;for(var U=0;U<R.length;U++){var I=T/R[U].rangeInMS;if(I<S){R[U-1]?(f=R[U-1].interval,w=R[U-1].timeUnit,b=Math.ceil(C/S)):(f=R[U].interval,w=R[U].timeUnit,b=1);break}C=I}}else{for(var O=this.staticRangePeriodicityMap,P=null,E=0;E<O.length;E++){var F=O[E];if(T/F.rangeInMS<1.001){P=F;break}}f=P.interval,b=P.periodicity,w=P.timeUnit}}var L=this.chart.scroll,x=this.layout.candleWidth,j=this.layout.interval,W=this.layout.periodicity,_=this.layout.timeUnit;this.chart.maxTicks=(h=s.getTime(),c=o.getTime(),u=f,y=b,g=w,this.dontRoll,p=0,v=h-c,n.ChartEngine.isDailyInterval(u)?p="month"==u?v/n.MONTH/y:"week"==u?v/n.WEEK/y:v/n.DAY/y:isNaN(u)||(p="millisecond"==g?v/(y*u):"second"==g?v/n.SECOND/(y*u):v/n.MINUTE/(y*u)),Math.round(p));var H=this.needDifferentData({period:b,interval:f,timeUnit:w}),z=!t.dtRight&&n.ChartEngine.isDailyInterval(f)?new Date(s.toDateString()):s;if(Object.keys(this.chart.endPoints).length&&(this.chart.endPoints.begin>o||this.chart.endPoints.end<z)&&(H=!0),t.useExistingData&&(H=!1),!this.chart.masterData||!this.chart.masterData.length||H||t.forceLoad){this.layout.interval=f,this.layout.periodicity=b,this.layout.timeUnit=w,this.layout.timeUnit||(n.ChartEngine.isDailyInterval(this.layout.interval)?this.layout.timeUnit=null:"second"==this.layout.interval?this.layout.timeUnit="second":"tick"!=this.layout.interval&&(this.layout.timeUnit="minute"));var A={symbol:r.symbol,symbolObject:r.symbolObject,chart:r,nodraw:!0};"tick"==this.layout.interval&&(A.startDate=o,A.endDate=s),this.displayInitialized||(A.initializeChart=!0);var Y={symbol:r.symbol,symbolObject:r.symbolObject,interval:this.layout.interval};"month"!=Y.interval&&"week"!=Y.interval||this.dontRoll||(Y.interval="day");var N=this.quoteDriver.getQuoteFeed(Y).behavior.bufferSize;i=this.standardMarketIterator(o,null,r),A.startDate=new Date(i.previous(N).getTime()),i=this.standardMarketIterator(s,null,r),A.endDate=new Date(i.next(N).getTime()),A.endDate<Date.now()&&(this.isHistoricalModeSet=!0);const e=new Date(Date.now()+6e4);A.endDate>e&&!t.dtRight&&(A.endDate=e),this.clearCurrentMarketData(this.chart),clearTimeout(this.streamParameters.timeout),this.quoteDriver.newChart(A,D)}else this.layout.interval==f&&this.layout.periodicity==b&&this.layout.timeUnit==w&&this.chart.dataSegment&&this.chart.dataSegment[0]&&this.chart.dataSegment[0].DT==r.inflectionPoint||(this.layout.interval=f,this.layout.periodicity=b,this.layout.timeUnit=w,this.createDataSet()),D()}else d()},n.ChartEngine.prototype.setSpan=function(t,e){var i=arguments[0],a=arguments[1],r=arguments[2],o=arguments[3];"object"==typeof t?(i=t.period?t.period:t.multiplier?t.multiplier:1,a=t.interval?t.interval:t.base?t.base:t.span?t.span:t.period,r=t.padding,o=t.chart):(t={period:i,interval:a,padding:r,chart:o},e=arguments[5]),o||(o=this.chart);var s,l=o.market;if("all"==(a=a.toLowerCase()))return t.dontSaveRangeToLayout=!0,void this.displayAll(t,e);var d=a,h=1;"today"==a?d="day":"year"==a&&(d="month",h=12);var c=n.shallowClone(t),u={begin:l.marketZoneNow(),interval:d,period:h},y=u.begin;function g(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}var p=n.Market.Symbology.isForexSymbol(o.symbol);function v(t,e){return p?(e?t.setHours(t.getHours()+7):(t.setHours(t.getHours()-7),l.isMarketDate(t)||t.setDate(t.getDate()-2)),t):t}if("ytd"===a)(y=g(y)).setMonth(0),y.setDate(1);else if("month"===a)(y=g(new Date)).setMonth(y.getMonth()-i);else if("year"===a)(y=g(new Date)).setFullYear(y.getFullYear()-i);else if("week"===a)(y=g(new Date)).setDate(y.getDate()-7*i);else if("day"===a&&1==i&&l.isMarketDay()){var m=y.getHours(),D=y.getMinutes(),f=y.getSeconds(),b=y.getMilliseconds();(y=(s=l.newIterator(u)).previous()).setHours(m,D,f,b),y=l._convertFromMarketTZ(y)}else"today"===a?(u.begin=v(y,!0),s=l.newIterator(u),(l.isOpen()||l.getPreviousOpen().getDate()==y.getDate())&&s.next(),v(y=s.previous()),c.goIntoFuture=!0,c.dtRight=new Date(+y),c.dtRight.setDate(y.getDate()+1),c.dtRight=l._convertFromMarketTZ(c.dtRight),p||(y.setHours(s.market.zopen_hour),y.setMinutes(s.market.zopen_minute),y.setSeconds(0)),y=l._convertFromMarketTZ(y)):("day"==a&&(u.begin=v(y,!0)),1==i&&i++,y=(s=l.newIterator(u)).previous(i-1),"day"==a&&(y=l._convertFromMarketTZ(v(y))));c.dtLeft=y,c.maintainPeriodicity&&(c.periodicity={},c.periodicity.interval=this.layout.interval,c.periodicity.period=this.layout.periodicity),o.spanLock=!1,c.dontSaveRangeToLayout=!0;var w=this;this.setRange(c,(function(i){w.layout.setSpan=t,w.changeOccurred("layout"),"today"==a&&(o.spanLock=!0),e&&e(i)}))},n.ChartEngine.prototype.getSpanCandleWidth=function(t){if(t&&t.base&&t.multiplier){var e=parseFloat(t.multiplier),i=t.base,a=new Date,r=new Date;"year"==i?r.setFullYear(r.getFullYear()-e):"month"==i?r.setMonth(r.getMonth()-e):"day"==i?r.setDate(r.getDate()-e):"week"==i?r.setDate(r.getDate()-7*e):"YTD"==i&&(r.setMonth(0),r.setDate(1));var n=(a.getTime()-r.getTime())/1e3/60/60/24;return n=5*n/7,this.chart.width/n}},n.ChartEngine.prototype.displayAll=function(t,e){var{chart:i,layout:a}=this,r=[];t&&t.chart&&(i=t.chart);const o=this;function s(){if(i.masterData&&i.masterData.length){var s=n.clone(t);s.dtLeft=i.endPoints.begin,s.dtRight=i.endPoints.end,s.periodicity={},s.periodicity.interval=a.interval,s.periodicity.period=a.periodicity,s.periodicity.timeUnit=a.timeUnit,o.setRange(s,(function(i){for(var a in o.layout.setSpan={base:t.base,multiplier:t.multiplier},o.changeOccurred("layout"),o.panels)o.calculateYAxisMargins(o.panels[a].yAxis);r.length&&!o.drawingObjects.length&&o.importDrawings(r),o.draw(),e&&e(i)}))}else e&&e("No data to display.")}function l(t){t||o.quoteDriver.loadAll(i,s)}if(this.quoteDriver){var d=t.maintainPeriodicity?{period:a.periodicity,interval:a.interval,timeUnit:a.timeUnit}:{period:1,interval:"month",timeUnit:null};d=t.periodicity?t.periodicity:d,d=n.cleanPeriodicity(d.period,d.interval,d.timeUnit);var h=this.needDifferentData(d);this.layout.periodicity=d.period,this.layout.interval=d.interval,this.layout.timeUnit=d.timeUnit,t.forceLoad||h?(r=this.drawingObjects.map((t=>t.serialize())),this.clearCurrentMarketData(this.chart),this.quoteDriver.newChart({nodraw:!0,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,chart:this.chart,initializeChart:!0,fetchMaximumBars:!0},l)):i.moreAvailable||!i.upToDate?l():(this.createDataSet(),s())}else s()},n.ChartEngine.prototype.drawWithRange=function(t){const{setSpan:e,range:i}=this.layout;e&&Object.keys(e).length?this.setSpan(Object.assign({},e,{forceLoad:!1,useExistingData:!0})):i&&Object.keys(i).length?this.setRange(Object.assign({},i,{forceLoad:!1,useExistingData:!0})):this.draw(t)}}}]);