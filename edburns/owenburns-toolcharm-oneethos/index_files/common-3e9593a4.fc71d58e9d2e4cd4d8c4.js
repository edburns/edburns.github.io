/*! For license information please see common-3e9593a4.fc71d58e9d2e4cd4d8c4.js.LICENSE.txt */
"use strict";(self.webpackChunk_vzmi_finance_cosaic=self.webpackChunk_vzmi_finance_cosaic||[]).push([[3888],{2403:(t,e,i)=>{var s=i(4603);(t=>{var e=void 0!==s.mE?s.mE:t.CIQ,i=void 0!==s.vn?s.vn:t.timezoneJS,n=36e5,r=864e5,a=e.Market;e.Market=function(t){this.market_def=!1,this.rules=!1,this.normalHours=[],this.extraHours=[],this.class_name="Market",i.Date?this.tz_lib=i.Date:this.tz_lib=Date,this.market_tz="",this.hour_aligned=!1,this.convertOnDaily=!1,this.enabled_by_default=!1,void 0!==t&&t&&!e.isEmpty(t)?(t.market_definition&&(t=t.market_definition),t.rules&&(this.rules=t.rules),t.market_tz&&(this.market_tz=t.market_tz),t.convertOnDaily&&(this.convertOnDaily=t.convertOnDaily),t.hour_aligned,this.hour_aligned=t.hour_aligned,void 0!==t.beginningDayOfWeek&&(this.beginningDayOfWeek=t.beginningDayOfWeek),void 0!==t.minimum_session_length&&(this.minimumSessionLength=t.minimum_session_length),void 0!==t.enabled_by_default&&t.enabled_by_default instanceof Array&&(this.enabled_by_default=t.enabled_by_default),this.market_def=t,void 0===this.market_def.name&&(this.market_def.name="no market name specified"),e.Market._createTimeSegments(this),this.getSessionNames()):this.hour_aligned=!0},e.Market.Symbology=function(){},e.Market.Symbology.isForeignSymbol=function(t){return!1},e.Market.Symbology.isFuturesSymbol=function(t){return!1},e.Market.Symbology.isRateSymbol=function(t){return!1},e.Market.Symbology.isForexSymbol=function(t){return!1},e.Market.Symbology.isForexMetal=function(t,e){return!1},e.Market.Symbology.isForexCrypto=function(t){return!1},e.Market.Symbology.isForexFuturesSymbol=function(t){return!!e.Market.Symbology.isForexSymbol(t)||!!e.Market.Symbology.isFuturesSymbol(t)},e.Market.Symbology.factory=function(t){return null},e.Market.Symbology.encodeTermStructureInstrumentSymbol=function(t,e){console.warn("You are trying to call `CIQ.Market.Symbology.encodeTermStructureInstrumentSymbol` but have not implemented it.")},a&&e.extend(e.Market,a),e.Market.prototype.sessions=null,e.Market.prototype.beginningDayOfWeek=0,e.Market.prototype.minimumSessionLength=30,e.Market.prototype.tradingDays=function(){if("_tradingDays"in this)return this._tradingDays;let t=[];if(this.rules)for(let e of this.rules)e.dayofweek>=0&&t.push(e.dayofweek);else t=[0,1,2,3,4,5,6];return this._tradingDays=[...new Set(t)],this._tradingDays.sort(),this._tradingDays},e.Market.prototype.getSessionNames=function(){if(this.rules){if(!this.sessions){var t=[],e=[];this.rules.map((function(i){i.name&&-1===t.indexOf(i.name)&&(t.push(i.name),e.push({name:i.name,enabled:!!i.enabled&&i.enabled}))})),this.sessions=e}}else this.sessions=[];return this.sessions.slice()},e.Market.prototype._find_next_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),s=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz});if(this._wasOpenIntraDay(i)){var n=this.zseg_match.close_parts.hours,r=this.zseg_match.close_parts.minutes;i.setHours(n),i.setMinutes(r),s=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})}return s.next()},e.Market.prototype._find_prev_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),s=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),n=this._wasOpenIntraDay(i);if(null===n?(i=new Date(i-6e4),n=this._wasOpenIntraDay(i)):(e&&i.getHours()===this.zseg_match.open_parts.hours&&i.getMinutes()===this.zseg_match.open_parts.minutes||!e&&i.getHours()===this.zseg_match.close_parts.hours&&i.getMinutes()===this.zseg_match.close_parts.minutes)&&(i=s.previous()),n){var r=this.zseg_match.open_parts.hours,a=this.zseg_match.open_parts.minutes;return i.setHours(r),i.setMinutes(a),i=(s=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})).previous(),this.zseg_match.close_parts.hours===r&&this.zseg_match.close_parts.minutes===a?e?s.next():i:this.zseg_match.adjacent_child?i:e?s.next():i}return s.previous()},e.Market.prototype.disableSession=function(t,e){var i=!1;if(void 0!==e&&e&&(i=!0),t){for(var s=0;s<this.normalHours.length;s++)delete this.normalHours[s]._refid,this.normalHours[s].name===t&&(this.normalHours[s].enabled=i);for(s=0;s<this.extraHours.length;s++)delete this.extraHours[s]._refid,this.extraHours[s].name===t&&(this.extraHours[s].enabled=i)}this._zseg_matches&&this._zseg_matches.clear()},e.Market.prototype.enableSession=function(t){this.disableSession(t,"enable_instead")},e.Market.prototype.enableAllAvailableSessions=function(){for(var t=this.getSessionNames(),e=0;e<t.length;e++)this.enableSession(t[e].name)},e.Market.prototype.getClose=function(t,e,i,s){if(!this.market_def)return null;if(!this.rules)return null;var n=t;if(t||(n=new Date,i=null),n=this._convertToMarketTZ(n,i),void 0!==e){if(this._wasOpenIntraDay(n)&&this.zseg_match.name===e)return n.setHours(this.zseg_match.close_parts.hours,this.zseg_match.close_parts.minutes,0,0),n=this._convertFromMarketTZ(n,s)}else if(this._wasOpenDaily(n)){for(var r=this.zseg_match;r.child_;)r=r.child_;for(;!r.enabled;)r=r.parent_;return n.setHours(r.close_parts.hours,r.close_parts.minutes,0,0),n=this._convertFromMarketTZ(n,s)}return null},e.Market.prototype.getNextClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var s=t;(t||(s=new Date,e=null),s=this._convertToMarketTZ(s,e),this._wasOpenIntraDay(s))||(s=this.newIterator({begin:s,interval:1,inZone:this.market_tz,outZone:this.market_tz}).next());for(var n=s.getDate(),r=this.zseg_match;r.adjacent_child;)r=r.adjacent_child,n+=1;return s.setDate(n),s.setHours(r.close_parts.hours,r.close_parts.minutes,0,0),s=this._convertFromMarketTZ(s,i)},e.Market.prototype.getNextOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var s=t;return t||(s=new Date,e=null),s=this._convertToMarketTZ(s,e),s=this._find_next_segment(s),this.zseg_match.adjacent_parent?(s=this.getNextOpen(s,this.market_tz,this.market_tz),s=this._convertFromMarketTZ(s,i)):(s.setHours(this.zseg_match.open_parts.hours),s.setMinutes(this.zseg_match.open_parts.minutes),s=this._convertFromMarketTZ(s,i))},e.Market.prototype.getOpen=function(t,e,i,s){if(!this.market_def)return null;if(!this.rules)return null;var n=t;if(t||(n=new Date,i=null),n=this._convertToMarketTZ(n,i),void 0!==e){if(this._wasOpenIntraDay(n)&&this.zseg_match.name==e)return n.setHours(this.zseg_match.open_parts.hours,this.zseg_match.open_parts.minutes,0,0),n=this._convertFromMarketTZ(n,s)}else if(this._wasOpenDaily(n)){for(var r=this.zseg_match;r.parent_;)r=r.parent_;for(;!r.enabled;)r=r.child_;return n.setHours(r.open_parts.hours,r.open_parts.minutes,0,0),n=this._convertFromMarketTZ(n,s)}return null},e.Market.prototype.getNormalOpen=function(){const{market_def:t,rules:e}=this;return t&&e?t.normal_daily_open?t.normal_daily_open:"FOREX"===t.name?"17:00":e.find((({name:t})=>!t||""===t)).open:"00:00"},e.Market.prototype.getNormalClose=function(){const{market_def:t,rules:e}=this;return t&&e?t.normal_daily_close?t.normal_daily_close:"FOREX"===t.name?"17:00":e.filter((({dayofweek:t,name:e})=>t&&(!e||""===e))).pop().close:"24:00"},e.Market.prototype.getPreviousClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var s=t;return t||(s=new Date,e=null),s=this._convertToMarketTZ(s,e),s=this._find_prev_segment(s,!1),this.zseg_match.adjacent_child?this.getPreviousClose(s,this.market_tz,this.market_tz):(s.setHours(this.zseg_match.close_parts.hours),s.setMinutes(this.zseg_match.close_parts.minutes),s=this._convertFromMarketTZ(s,i))},e.Market.prototype.getPreviousOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var s=t;return t||(s=new Date,e=null),s=this._convertToMarketTZ(s,e),s=this._find_prev_segment(s,!0),this.zseg_match.adjacent_parent?this.getPreviousOpen(s,this.market_tz,this.market_tz):(s.setHours(this.zseg_match.open_parts.hours),s.setMinutes(this.zseg_match.open_parts.minutes),s=this._convertFromMarketTZ(s,i))},e.Market.prototype.getSession=function(t,e){return t=this._convertToMarketTZ(t,e),this._wasOpenIntraDay(t)&&this.zseg_match?this.zseg_match.name:null},e.Market.prototype.marketZoneNow=function(){return this._convertToMarketTZ(new Date)},e.Market.prototype.isHourAligned=function(){return this.hour_aligned},e.Market.prototype.isOpen=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenIntraDay(t)},e.Market.prototype.isMarketDay=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenDaily(t)},e.Market.prototype.isMarketDate=function(t){return this._wasOpenDaily(t)},e.Market.prototype.isFirstMarketDayOfMonth=function(t){if(!this.isMarketDate(t))return!1;let e=new Date(+t),i=t.getDate();for(let s=1;s<i;s++)if(e.setDate(s),this.isMarketDate(e))return!1;return!0},e.Market.prototype.isFirstMarketDayOfWeek=function(t){if(!this.isMarketDate(t))return!1;const e=this.tradingDays(),i=Math.max(this.beginningDayOfWeek,e[0])||0,s=new Date(+t);for(;s.getDay()!==i;)if(s.setDate(s.getDate()-1),this.isMarketDate(s))return!1;return!0},e.Market.prototype.newIterator=function(t){var i=!1;t.periodicity?i=t.periodicity:t.multiple&&(i=t.multiple);var s=t.interval;return s||(s="minute"),"hour"==s&&(s=60),i||(i=1),t.begin||(t.begin=new Date,t.inZone=null),s==parseInt(s,10)&&(s=parseInt(s,10),t.periodicity<1/60?(i=i*s*6e4,s="millisecond"):t.periodicity<1?(i=i*s*60,s="second"):(i*=s,s="minute")),t.timeUnit&&("millisecond"===t.timeUnit||"second"===t.timeUnit?s=t.timeUnit:"tick"===t.timeUnit&&(s="second")),"tick"==s&&(s="second"),t.interval=s,t.multiple=i,t.market=this,new e.Market.Iterator(t)},e.Market.prototype._wasOpenDaily=function(t){return this._was_open(t,!1)},e.Market.prototype._wasOpenIntraDay=function(t){return this._was_open(t,!0)},e.Market.prototype._was_open=function(t,e){void 0===e&&(e=!0);var i=this.zseg_match;if(this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null,!this.market_def||!this.rules)return this.zclose_hour=24,!0;if(this.tradingDays().indexOf(t.getDay())<0)return null;this._zseg_matches||(this._zseg_matches=new Map);var s=this._zseg_matches.get(+t*(e?1:-1));if(null===s)return null;if(s)return s=this._zseg_matches.get(s),Object.assign(this,s),this.zseg_match;var n,r,a,o=!1,h=!1,u=t.getFullYear(),_=t.getMonth()+1,l=t.getDay(),c=t.getDate(),m=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds();for(a=0;a<this.normalHours.length;a++)if((n=this.normalHours[a]).enabled&&((o=n.dayofweek===l)&&e&&(o=m>=n.open&&m<n.close),o)){if(!e&&this.zseg_match&&(n.open_parts.hours>this.zopen_hour||n.open_parts.hours==this.zopen_hour&&n.open_parts.minutes>this.zopen_minute))continue;if(n===i||n.adjacent_parent||n.adjacent_child||(this.shouldResetToBeginningOfSegment=!0),r=a+1,this.zopen_hour=n.open_parts.hours,this.zopen_minute=n.open_parts.minutes,this.zclose_hour=n.close_parts.hours,this.zclose_minute=n.close_parts.minutes,this.zmatch_open=m===n.open,this.zseg_match=n,e)break}for(a=0;a<this.extraHours.length;a++)if((n=this.extraHours[a]).enabled&&("*"===n.year||u===n.year)&&_===n.month&&c===n.day&&(!(h=!e&&n.open||m>=n.open&&m<n.close)&&this.zseg_match&&(o=!1,this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null),h)){if(!e&&this.zseg_match&&(n.open_parts.hours>this.zopen_hour||n.open_parts.hours==this.zopen_hour&&n.open_parts.minutes>this.zopen_minute))continue;if(r=-(a+1),this.zopen_hour=n.open_parts.hours,this.zopen_minute=n.open_parts.minutes,this.zclose_hour=n.close_parts.hours,this.zclose_minute=n.close_parts.minutes,this.zmatch_open=m===n.open,this.zseg_match=n,e)break}var p=null;return this.zseg_match&&(this.zseg_match._refid||(this.zseg_match._refid=r,this._zseg_matches.set(this.zseg_match._refid,{zopen_hour:this.zopen_hour,zopen_minute:this.zopen_minute,zclose_hour:this.zclose_hour,zclose_minute:this.zclose_minute,zmatch_open:this.zmatch_open,zseg_match:this.zseg_match})),p=this.zseg_match._refid),this._zseg_matches.set(+t*(e?1:-1),p),this.zseg_match},e.Market.prototype._wasClosed=function(t){return!this._was_open(t,!0)},e.Market.prototype._wasOpen=function(t){return this._was_open(t,!0)},e.Market.prototype._tzDifferenceMillis=function(t,e,i){var s=t;return 60*(t.getTimezoneOffset()-s.getTimezoneOffset())*1e3},e.Market._createTimeSegments=function(t){for(var e,i=function(t,i){if(24===t.close_parts.hours&&0===i.open_parts.hours&&0===i.open_parts.minutes){if(e.dayofweek===r.dayofweek-1)return!0;if(6===e.dayofweek&&0===r.dayofweek)return!0}return!1},s=0;s<t.rules.length;s++){var n=JSON.parse(JSON.stringify(t.rules[s]));void 0===n.open&&void 0===n.close&&(n.open="00:00",n.close="00:00"),n.hasOwnProperty("name")||(n.name="");try{var r;if(void 0!==n.dayofweek?(n.year="*",r=o._createDayOfWeekSegment(t,n),e&&(e.dayofweek===r.dayofweek?(e.child_=r,r.parent_=e):i(e,r)&&(e.adjacent_child=r,r.adjacent_parent=e)),e=r):void 0!==n.date?(n.isDayOfWeek=!1,n.dayofweek=-1,r=o._createDateTimeSegment(t,n)):console.log("Error, unknown rule type "+n),t.enabled_by_default)for(var a=0;a<t.enabled_by_default.length;a++){var h=t.enabled_by_default[a];if(r.name===h){r.enabled=!0;break}}}catch(u){console.log("Error, creating market rules "+u)}}},e.Market._timeSegment={};var o=e.Market._timeSegment;o.re_wild_card_iso=/^(\*)-(\d\d)-(\d\d)$/,o.re_regular_iso=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o.re_split_hours_minutes=/^(\d\d):(\d\d)$/,o.re_split_hour_minutes=/^(\d):(\d\d)$/,o._hashCode=function(t){var e,i,s=0;if(0===t.length)return s;for(e=0,i=t.length;e<i;e++)s=(s<<5)-s+t.charCodeAt(e),s|=0;return s},o._splitHoursMinutes=function(t){var e=o.re_split_hour_minutes.exec(t),i={hours:NaN,minutes:NaN};return null===e&&null===(e=o.re_split_hours_minutes.exec(t))||(i.hours=parseInt(e[1],10),i.minutes=parseInt(e[2],10)),i},o._createDayOfWeekSegment=function(t,e){var i={name:e.name,isDayOfWeek:!0,dayofweek:e.dayofweek,date_str:"*",open_parts:o._splitHoursMinutes(e.open),close_parts:o._splitHoursMinutes(e.close),open:o._secSinceMidnight(t,e.open,!0),close:o._secSinceMidnight(t,e.close,!1),child_:!1,parent_:!1,adjacent_child:!1,adjacent_parent:!1,enabled:!1};return""===i.name&&(i.enabled=!0),i.hash_code=this._hashCode((i.open+i.close).toString()),t.normalHours.push(i),i},o._createDateTimeSegment=function(t,e){var i,s=this.re_regular_iso.exec(e.date);if(null===s){if(null===(s=this.re_wild_card_iso.exec(e.date)))return void console.log("Warning: invalid date format on rule -> "+e.date);i="*"}else i=parseInt(s[1],10);var n={name:e.name,isDayOfWeek:!1,dayofweek:-1,year:i,month:parseInt(s[2],10),day:parseInt(s[3],10),date_str:e.date,open_parts:o._splitHoursMinutes(e.open),close_parts:o._splitHoursMinutes(e.close),open:o._secSinceMidnight(t,e.open,!0),close:o._secSinceMidnight(t,e.close,!1),enabled:!1};return""===n.name&&(n.enabled=!0),n.hash_key=this._hashCode(n.date_str+n.open+n.close),t.extraHours.push(n),n},o._secSinceMidnight=function(t,e,i){var s=e.split(":"),n=parseInt(s[0],10),r=60*n*60+60*parseInt(s[1],10);return i||24===n&&(r=60*n*60+1),r},e.Market.prototype._convertToMarketTZ=function(t,e){var i;return(i=e?new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e):new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())).setTimezone&&i.setTimezone(this.market_tz),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())},e.Market.prototype._convertFromMarketTZ=function(t,e){var i=new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),this.market_tz);return e?(i.setTimezone&&i.setTimezone(e),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(i.getTime())},e.Market.Iterator=function(t){this.market=t.market,this.begin=t.begin,this.interval=t.interval,this.multiple=t.multiple,this.inZone=t.inZone,this.outZone=t.outZone,this.clock=new e.Market.Iterator._Clock(t.market,t.interval,t.multiple),this.intraDay=this.clock.intra_day,this.intraDay&&(this.begin=this.market._convertToMarketTZ(this.begin,t.inZone)),this.clock._setStart(this.begin),this.clock.minutes_aligned=!1,this.clock.minimumScanMS=6e4*t.market.minimumSessionLength},e.Market.Iterator.prototype.date=function(){return this.clock._date()},e.Market.Iterator.prototype.futureTick=function(t){this.clock.skip=1;var e,i=0;e=this.intraDay?this.market._convertToMarketTZ(t.end,this.inZone).getTime():t.end.getTime();var s=this.clock.ctime;if(e===s)return i;var n=2,r=0;t.sample_size&&(n=t.sample_size);var a,o=(new Date).getTime();if(e>s){for(this.clock.forward=!0;this.clock.ctime<e;)if(i+=1,r+=1,this.clock._findNext(),1e3===r&&(r=0,(new Date).getTime()-o>=n)){a=(this.clock.ctime-s)/i,i=Math.floor((e-s)/a);break}this.clock.ctime>e&&i--}else for(this.clock.forward=!1;this.clock.ctime>e;)if(i+=1,r+=1,this.clock._findPrevious(),1e3===r&&(r=0,(new Date).getTime()-o>=n)){a=(s-this.clock.ctime)/i,i=Math.floor((s-e)/a);break}return i},e.Market.Iterator.prototype.isHourAligned=function(){return!this.intraDay||this.market.isHourAligned()},e.Market.Iterator.prototype.isOpen=function(){return this.market.isOpen()},e.Market.Iterator.prototype.next=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!0;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findNext();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator.prototype.peek=function(){return this.clock._peek()},e.Market.Iterator.prototype.previous=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!1;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findPrevious();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator._Clock=function(t,e,i){i%60==0&&"second"===e&&(e="minute",i/=60),this.market=t,this.interval=e,this.multiple=i,this.intra_day=!1,this.intervals=[],this.max_iters=10080;var s=r,a=this._dayImpl;"millisecond"===e?(a=this._millisImpl,s=1):"second"===e?(a=this._secondImpl,s=1e3):"minute"===e?(a=this._minuteImpl,s=6e4):"hour"===e?(a=this._hourImpl,s=n):"day"===e?(a=this._dayImpl,s=r):"week"===e?(a=this._weekImpl,s=6048e5):"month"===e?(a=this._monthImpl,s=2592e6):console.log('Periodicity ERROR: "'+e+'" is not a valid interval. Please see setPeriodicity() for details.'),this.tick_time=s*i,this.intra_day=this.tick_time<r,this._findPrevious=this._findNext=a};var h=e.Market.Iterator._Clock.prototype;h._total_minutes=function(t,e,i,s){return 60*(i-t)-e+s},h._alignMinutes=function(){var t=this.market.isHourAligned();if(!this.market.market_def&&!t||void 0===this.market.zopen_minute)return[];var e=this.market.zopen_minute,i=this.market.zseg_match;i&&i.adjacent_parent?e=i.adjacent_parent.open/60-1440:t&&this.multiple%60==0&&(e=0);for(var s=this._total_minutes(this.market.zopen_hour,e,this.market.zclose_hour,this.market.zclose_minute),n=[],r=0;r<s;)n.push(e+r),r+=this.multiple;return n},h._alignBaseZero=function(t){for(var e=0,i=[e];!((e+=this.multiple)>=t);)i.push(e);return i},h._date=function(){var t=Math.round(this.ctime),e=new Date(t);return this.intra_day?this.display_date=new Date(t+this.shift_millis):this.display_date=e,e},h._alignToBoundary=function(t,e){for(var i=0,s=0,n=e,r=0;r<t.length-1&&(i=t[r],s=t[r+1],e!==i&&e!==s);r++){if(e>i&&e<s){n=i;break}r+1===t.length-1&&(n=s)}return n},h._peek=function(){return this._date().toString()},h._seekHr=function(){this.forward?this.ctime-=n:this.ctime+=n},h._setStart=function(t){var e=this.market._tzDifferenceMillis(t),i=new Date(t.getTime()+e);this.shift_millis=e,this.ctime=i.getTime(),this.shift_millis=0,this.ctime=t.getTime()},h._tickTock=function(){this.forward?this.ctime+=this.tick_time:this.ctime-=this.tick_time},h._tockTick=function(){this.forward?this.ctime-=this.tick_time:this.ctime+=this.tick_time},h._tickTock24=function(){this.ctime+=r},h._tockTick24=function(){this.ctime-=r},h._windMaybe=function(t,e){for(var i=0,s=new Date(this.ctime),n=!1;!t.call(this.market,s);)if(e.call(this),n=!0,s=new Date(this.ctime),(i+=1)>this.max_iters){var r="Warning! max iterations ("+this.max_iters;r+=") reached with no rule match.",console.log(r);break}return n},h._millisImpl=function(){var t=!1;if(!this.mperiods_aligned){var e=this._alignBaseZero(1e3),i=new Date(this.ctime),s=i.getMilliseconds();s=this._alignToBoundary(e,s),i.setMilliseconds(0),this.ctime=i.getTime()+s,this.mperiods_aligned=!0,t=!0}var n=this._date().getMinutes();this._tickTock();var r=this._date().getMinutes();if((t||n!=r)&&!this.market._wasOpenIntraDay(this._date())){var a=this._date().getSeconds(),o=this._date().getMilliseconds(),h=this.tick_time;this.tick_time=6e4;var u=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=h,this.multiple=u,this.ctime+=1e3*a+o}return this._date()},h._secondImpl=function(){var t=!1;if(!this.speriod_aligned){var e=this._alignBaseZero(60),i=new Date(this.ctime),s=i.getSeconds();s=this._alignToBoundary(e,s),i.setSeconds(s),i.setMilliseconds(0),this.ctime=i.getTime(),this.speriod_aligned=!0,t=!0}var n=this._date().getMinutes();this._tickTock();var r=this._date().getMinutes();if((t||n!=r)&&!this.market._wasOpenIntraDay(this._date())){var a=this._date().getSeconds(),o=this.tick_time;this.tick_time=6e4;var h=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=o,this.multiple=h,this.ctime+=1e3*a}return this._date()},h._minuteImpl=function(){var t=this._windMaybe(this.market._wasOpenIntraDay,this._tockTick),e=new Date(this.ctime),i=e.getTimezoneOffset(),s=e.getMinutes(),n=e.getHours(),r=this._alignMinutes(),a=this._total_minutes(this.market.zopen_hour,this.market.zopen_minute,n,s)+this.market.zopen_minute;a=t?this.forward?r[r.length-1]:r[0]:this._alignToBoundary(r,a),n=Math.floor(a/60)+this.market.zopen_hour,e.setHours(n,a%60,0,0);var o=e.getTimezoneOffset()-i;(this.forward&&o<0||!this.forward&&o>0)&&e.setTime(e.getTime()-6e4*o),this.ctime=e.getTime();var h=this.market.zseg_match;this._tickTock();var u=this.market.hour_aligned&&this.multiple%60==0;t=this._scanForNextSession();var _=h!==this.market.zseg_match,l=h&&h.adjacent_child,c=this.shouldResetToBeginningOfSegment||_&&!l;if(t||c&&!u){if(e=new Date(this.ctime),this.forward)e.setMinutes(this.market.zopen_minute),e.setHours(this.market.zopen_hour);else{var m=(r=this._alignMinutes())[r.length-1];e.setMinutes(m%60),e.setHours(Math.floor(m/60)+this.market.zopen_hour)}this.ctime=e.getTime()}return this._date()},h._hourImpl=function(){this._windMaybe(this.market._wasOpenIntraDay,this._tockTick);var t=new Date(this.ctime);this.market.isHourAligned()?t.setMinutes(0):t.setMinutes(this.market.zopen_minute),t.setSeconds(0),t.setMilliseconds(0),this.ctime=t.getTime(),this._tickTock();var e=this.market.zseg_match;if(this._scanForNextSession()||!this.market.hour_aligned&&e!=this.market.zseg_match){var i=new Date(this.ctime);if(this.forward)i.setMinutes(this.market.zopen_minute),i.setHours(this.market.zopen_hour);else{var s=this._alignMinutes(),n=s[s.length-1];i.setMinutes(n%60),i.setHours(Math.floor(n/60)+this.market.zopen_hour)}this.ctime=i.getTime()}return this._date()},h._dayImpl=function(){this._windMaybe(this.market._wasOpenDaily,this._seekHr);var t=new Date(this.ctime);t.setHours(12,0,0,0),this.ctime=t.getTime();for(var e=0;e<this.multiple;)this.forward?this._tickTock24():this._tockTick24(),this.market._wasOpenDaily(this._date())&&(e+=1);return(t=new Date(this.ctime)).setHours(0),this.ctime=t.getTime(),this._date()},h._weekImpl=function(){var t=this.market,e=new Date(this.ctime);for(e.setHours(12),this.ctime=e.getTime(),this._tickTock(),e=new Date(this.ctime);e.getDay()!==t.beginningDayOfWeek;)this._tockTick24(),e=new Date(this.ctime);return this._windMaybe(t._wasOpenDaily,this._tickTock24),(e=new Date(this.ctime)).setHours(0,0,0,0),this.ctime=e.getTime(),this._date()},h._monthImpl=function(){var t=new Date(this.ctime);return t.setDate(15),this.ctime=t.getTime(),this._tickTock(),(t=new Date(this.ctime)).setDate(1),t.setHours(12),this.ctime=t.getTime(),this._windMaybe(this.market._wasOpenDaily,this._tickTock24),(t=new Date(this.ctime)).setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},h._findNext=null,h._findPrevious=null,h._scanForNextSession=function(){return this._windMaybe(this.market._wasOpenIntraDay,function(){this.ctime+=this.forward?this.minimumScanMS:-this.minimumScanMS}.bind(this))}})("undefined"!=typeof window?window:i.g)}}]);