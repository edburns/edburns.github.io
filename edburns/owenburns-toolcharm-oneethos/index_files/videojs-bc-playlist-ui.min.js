/*! @name @brightcove/videojs-bc-playlist-ui @version 5.1.1 @license UNLICENSED */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js"),require("@brightcove/loscore")):"function"==typeof define&&define.amd?define(["video.js","@brightcove/loscore"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).videojsBcPlaylistUi=e(t.videojs,t.videojs.bc_)}(this,(function(t,e){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=s(t),n=s(e);let l=t=>{const e=t.playlist.autoadvance_;e.timeout&&t.clearTimeout(e.timeout),e.trigger&&t.off("ended",e.trigger),e.timeout=null,e.trigger=null};const a=(t,e)=>{var s;(l(t),"number"==typeof(s=e)&&!isNaN(s)&&s>=0&&s<1/0)?(t.playlist.autoadvance_.delay=e,t.playlist.autoadvance_.trigger=function(){const s=()=>a(t,e);t.one("play",s),t.playlist.autoadvance_.timeout=t.setTimeout((()=>{l(t),t.off("play",s),t.playlist.next()}),1e3*e)},t.one("ended",t.playlist.autoadvance_.trigger)):t.playlist.autoadvance_.delay=null};let o=1;const r=t=>{let e=t;return t&&"object"==typeof t||(e=Object(t),e.originalValue=t),e.playlistItemId_=o++,e},d=t=>t.map(r),h=(t,e)=>{let s=t,i=e;return"object"==typeof t&&(s=t.src),"object"==typeof e&&(i=e.src),/^\/\//.test(s)&&(i=i.slice(i.indexOf("//"))),/^\/\//.test(i)&&(s=s.slice(s.indexOf("//"))),s===i},c=(t,e)=>{for(let s=0;s<t.length;s++){const i=t[s].sources;if(Array.isArray(i))for(let t=0;t<i.length;t++){const n=i[t];if(n&&h(n,e))return s}}return-1};function u(t,e,s=0){let n=null,o=!1;const r=t.playlist=(e,s=0)=>{if(o)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(e)){const i=Array.isArray(n)?n.slice():null;n=d(e),o=!0,t.trigger({type:"duringplaylistchange",nextIndex:s,nextPlaylist:e,previousIndex:r.currentIndex_,previousPlaylist:i||[]}),o=!1,-1!==s&&r.currentItem(s),i&&t.setTimeout((()=>{t.trigger({type:"playlistchange",action:"change"})}),0)}return n.map((t=>t.originalValue||t))};return t.on("loadstart",(()=>{-1===r.currentItem()&&l(t)})),r.currentIndex_=-1,r.player_=t,r.autoadvance_={},r.repeat_=!1,r.currentPlaylistItemId_=null,r.currentItem=e=>{if(o)return r.currentIndex_;if("number"==typeof e&&r.currentIndex_!==e&&e>=0&&e<n.length)return r.currentIndex_=e,((t,e)=>{const s=!t.paused()||t.ended();t.trigger("beforeplaylistitem",e.originalValue||e),e.playlistItemId_&&(t.playlist.currentPlaylistItemId_=e.playlistItemId_),t.poster(e.poster||""),t.src(e.sources),(t=>{const e=t.remoteTextTracks();let s=e&&e.length||0;for(;s--;)t.removeRemoteTextTrack(e[s])})(t),t.ready((()=>{if((e.textTracks||[]).forEach(t.addRemoteTextTrack.bind(t)),t.trigger("playlistitem",e.originalValue||e),s){const e=t.play();void 0!==e&&"function"==typeof e.then&&e.then(null,(t=>{}))}a(t,t.playlist.autoadvance_.delay)}))})(r.player_,n[r.currentIndex_]),e>0&&t.poster(""),r.currentIndex_;const s=r.player_.currentSrc()||"";if(r.currentPlaylistItemId_){const t=((t,e)=>{for(let s=0;s<t.length;s++)if(t[s].playlistItemId_===e)return s;return-1})(n,r.currentPlaylistItemId_),e=n[t];if(e&&Array.isArray(e.sources)&&c([e],s)>-1)return r.currentIndex_=t,r.currentIndex_;r.currentPlaylistItemId_=null}return r.currentIndex_=r.indexOf(s),r.currentIndex_},r.add=(e,s)=>{if(o)throw new Error("cannot modify a playlist that is currently changing");("number"!=typeof s||s<0||s>n.length)&&(s=n.length),Array.isArray(e)||(e=[e]),n.splice(s,0,...d(e)),t.trigger({type:"playlistchange",action:"add"}),t.trigger({type:"playlistadd",count:e.length,index:s})},r.remove=(e,s=1)=>{if(o)throw new Error("cannot modify a playlist that is currently changing");"number"!=typeof e||e<0||e>n.length||(n.splice(e,s),t.trigger({type:"playlistchange",action:"remove"}),t.trigger({type:"playlistremove",count:s,index:e}))},r.contains=t=>-1!==r.indexOf(t),r.indexOf=t=>{if("string"==typeof t)return c(n,t);const e=Array.isArray(t)?t:t.sources;for(let t=0;t<e.length;t++){const s=e[t];if("string"==typeof s)return c(n,s);if(s.src)return c(n,s.src)}return-1},r.currentIndex=()=>r.currentItem(),r.lastIndex=()=>n.length-1,r.nextIndex=()=>{const t=r.currentItem();if(-1===t)return-1;const e=r.lastIndex();return r.repeat_&&t===e?0:Math.min(t+1,e)},r.previousIndex=()=>{const t=r.currentItem();return-1===t?-1:r.repeat_&&0===t?r.lastIndex():Math.max(t-1,0)},r.first=()=>{if(o)return;const t=r.currentItem(0);if(n.length)return n[t].originalValue||n[t];r.currentIndex_=-1},r.last=()=>{if(o)return;const t=r.currentItem(r.lastIndex());if(n.length)return n[t].originalValue||n[t];r.currentIndex_=-1},r.next=()=>{if(o)return;const t=r.nextIndex();if(t!==r.currentIndex_){const e=r.currentItem(t);return n[e].originalValue||n[e]}},r.previous=()=>{if(o)return;const t=r.previousIndex();if(t!==r.currentIndex_){const e=r.currentItem(t);return n[e].originalValue||n[e]}},r.autoadvance=t=>{a(r.player_,t)},r.repeat=t=>void 0===t?r.repeat_:"boolean"==typeof t?(r.repeat_=!!t,r.repeat_):void i.default.log.error("videojs-playlist: Invalid value for repeat",t),r.sort=e=>{n.length&&(n.sort(e),o||t.trigger("playlistsorted"))},r.reverse=()=>{n.length&&(n.reverse(),o||t.trigger("playlistsorted"))},r.shuffle=({rest:e}={})=>{let s=0,i=n;e&&(s=r.currentIndex_+1,i=n.slice(s)),i.length<=1||((t=>{let e=-1;const s=t.length-1;for(;++e<t.length;){const i=e+Math.floor(Math.random()*(s-e+1)),n=t[i];t[i]=t[e],t[e]=n}})(i),e&&n.splice(...[s,i.length].concat(i)),o||t.trigger("playlistsorted"))},Array.isArray(e)?r(e,s):n=[],r}const p=function(t,e){u(this,t,e)};(i.default.registerPlugin||i.default.plugin)("playlist",p),p.VERSION="5.1.0";const m=i.default.getComponent("Component");class y extends m{constructor(t,e,s){if(!e.item)throw new Error("Cannot construct a PlaylistMenuItem without an item option");e.showDescription=s.showDescription,super(t,e),this.item=e.item,this.playOnSelect=s.playOnSelect,this.emitTapEvents(),this.on(["click","tap"],this.switchPlaylistItem_),this.on("keydown",this.handleKeyDown_)}handleKeyDown_(t){13!==t.which&&32!==t.which||this.switchPlaylistItem_()}switchPlaylistItem_(t){this.player_.playlist.currentItem(this.player_.playlist().indexOf(this.item)),this.playOnSelect&&this.player_.play()}createEl(){const t=document.createElement("li"),e=this.options_.item,s=this.options_.showDescription;if("object"==typeof e.data){Object.keys(e.data).forEach((s=>{const i=e.data[s];t.dataset[s]=i}))}if(t.className="vjs-playlist-item",t.setAttribute("tabIndex",0),this.thumbnail=function(t){if(!t){const t=document.createElement("div");return t.className="vjs-playlist-thumbnail vjs-playlist-thumbnail-placeholder",t}const e=document.createElement("picture");if(e.className="vjs-playlist-thumbnail","string"==typeof t){const s=document.createElement("img");s.loading="lazy",s.src=t,s.alt="",e.appendChild(s)}else{for(let s=0;s<t.length-1;s++){const i=t[s],n=document.createElement("source");for(const t in i)n[t]=i[t];e.appendChild(n)}const s=t[t.length-1],i=document.createElement("img");i.loading="lazy",i.alt="";for(const t in s)i[t]=s[t];e.appendChild(i)}return e}(e.thumbnail),t.appendChild(this.thumbnail),e.duration){const s=document.createElement("time"),n=i.default.time.formatTime(e.duration);s.className="vjs-playlist-duration",s.setAttribute("datetime","PT0H0M"+e.duration+"S"),s.appendChild(document.createTextNode(n)),t.appendChild(s)}const n=document.createElement("span"),l=this.localize("Now Playing");n.className="vjs-playlist-now-playing-text",n.appendChild(document.createTextNode(l)),n.setAttribute("title",l),this.thumbnail.appendChild(n);const a=document.createElement("div");a.className="vjs-playlist-title-container",this.thumbnail.appendChild(a);const o=document.createElement("span"),r=this.localize("Up Next");o.className="vjs-up-next-text",o.appendChild(document.createTextNode(r)),o.setAttribute("title",r),a.appendChild(o);const d=document.createElement("cite"),h=e.name||this.localize("Untitled Video");if(d.className="vjs-playlist-name",d.appendChild(document.createTextNode(h)),d.setAttribute("title",h),a.appendChild(d),this.thumbnail.getElementsByTagName("img").alt=h,s){const t=document.createElement("div"),s=e.description||"";t.className="vjs-playlist-description",t.appendChild(document.createTextNode(s)),t.setAttribute("title",s),a.appendChild(t)}return t}}i.default.registerComponent("PlaylistMenuItem",y);const _=function(t){t.addClass("vjs-selected")},g=function(t){t.removeClass("vjs-selected"),t.thumbnail&&i.default.dom.removeClass(t.thumbnail,"vjs-playlist-now-playing")},f=function(t){t.removeClass("vjs-up-next")},v=i.default.getComponent("Component");class E extends v{constructor(t,e){super(t,e),this.items=[],e.horizontal?this.addClass("vjs-playlist-horizontal"):this.addClass("vjs-playlist-vertical"),e.supportsCssPointerEvents&&this.addClass("vjs-csspointerevents"),this.createPlaylist_(),i.default.browser.TOUCH_ENABLED||this.addClass("vjs-mouse"),this.on(t,["loadstart","playlistchange","playlistsorted"],(t=>{"playlistchange"===t.type&&["add","remove"].includes(t.action)||this.update()})),this.on(t,["playlistadd"],(t=>this.addItems_(t.index,t.count))),this.on(t,["playlistremove"],(t=>this.removeItems_(t.index,t.count))),this.on(t,"adstart",(()=>{this.addClass("vjs-ad-playing")})),this.on(t,"adend",(()=>{this.removeClass("vjs-ad-playing")})),this.on("dispose",(()=>{this.empty_(),t.playlistMenu=null})),this.on(t,"dispose",(()=>{this.dispose()}))}createEl(){return i.default.dom.createEl("div",{className:this.options_.className})}empty_(){this.items&&this.items.length&&(this.items.forEach((t=>t.dispose())),this.items.length=0)}createPlaylist_(){const t=this.player_.playlist()||[];let e=this.el_.querySelector(".vjs-playlist-item-list"),s=this.el_.querySelector(".vjs-playlist-ad-overlay");e||(e=document.createElement("ol"),e.className="vjs-playlist-item-list",this.el_.appendChild(e)),this.empty_();for(let s=0;s<t.length;s++){const i=new y(this.player_,{item:t[s]},this.options_);this.items.push(i),e.appendChild(i.el_)}s||(s=document.createElement("li"),s.className="vjs-playlist-ad-overlay"),e.appendChild(s);const n=this.player_.playlist.currentItem();if(this.items.length&&n>=0){_(this.items[n]);const t=this.items[n].$(".vjs-playlist-thumbnail");t&&i.default.dom.addClass(t,"vjs-playlist-now-playing")}}addItems_(t,e){const s=this.player_.playlist().slice(t,e+t);if(!s.length)return;const i=this.el_.querySelector(".vjs-playlist-item-list"),n=this.el_.querySelectorAll(".vjs-playlist-item")[t]||null,l=s.map((t=>{const e=new y(this.player_,{item:t},this.options_);return i.insertBefore(e.el_,n),e}));this.items.splice(t,0,...l)}removeItems_(t,e){const s=this.items.slice(t,e+t);s.length&&(s.forEach((t=>t.dispose())),this.items.splice(t,e))}update(){const t=this.player_.playlist();if(this.items.length!==t.length)return void this.createPlaylist_();for(let e=0;e<this.items.length;e++)if(this.items[e].item!==t[e])return void this.createPlaylist_();const e=this.player_.playlist.currentItem();for(let t=0;t<this.items.length;t++){const s=this.items[t];t===e?(_(s),document.activeElement!==s.el()&&i.default.dom.addClass(s.thumbnail,"vjs-playlist-now-playing"),f(s)):t===e+1?(g(s),s.addClass("vjs-up-next")):(g(s),f(s))}}}i.default.registerComponent("PlaylistMenu",E);const b={className:"vjs-playlist",playOnSelect:!1,supportsCssPointerEvents:(()=>{const t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents})()},x=i.default.getPlugin("plugin");class C extends x{constructor(t,e){super(t,e),t.usingPlugin("playlist")?(e=this.options_=i.default.obj.merge(b,e),i.default.dom.isEl(e.el)||(e.el=this.findRoot_(e.className)),this.playlistMenu=t.playlistMenu=new E(t,e)):t.log.error("videojs-playlist plugin is required by the videojs-playlist-ui plugin")}dispose(){super.dispose(),this.playlistMenu.dispose()}hasChildEls_(t){for(let e=0;e<t.childNodes.length;e++)if(i.default.dom.isEl(t.childNodes[e]))return!0;return!1}findRoot_(t){const e=document.querySelectorAll("."+t);for(let t=0;t<e.length;t++)if(!this.hasChildEls_(e[t]))return e[t]}}i.default.registerPlugin("playlistUi",C),C.VERSION="5.0.0";const I=i.default.getComponent("Button");i.default.registerComponent("NextButton",class extends I{constructor(t,e){super(t,e),this.controlText(this.localize("Next playlist item")),this.shouldBeEnabled_(),this.on(t,["adstart"],this.disable),this.on(t,["adend","adtimeout"],this.shouldBeEnabled_),this.on(t,["playlistchange","playlistitem"],(()=>{const{ads:e}=t;(!e||e&&!e.isInAdMode())&&this.shouldBeEnabled_()}))}shouldBeEnabled_(){const{playlist:t}=this.player_;t.nextIndex()!==t.currentIndex()?this.enable():this.disable()}buildCSSClass(){return`vjs-next-button ${super.buildCSSClass()}`}createEl(){return super.createEl("button",{innerHTML:'<span class="vjs-icon-placeholder" aria-hidden="true"></span>'})}handleClick(t){this.player_.playlist.next(),this.options_.playOnSelect&&this.player_.play()}});const w=i.default.getComponent("Component");i.default.registerComponent("NextOverlay",class extends w{constructor(t,e){super(t,e),this.haveSeenEnded_=!1,this.haveSeenNoPostroll_=!1,this.closeButton_=this.addChild("CloseButton"),this.on("click",this.handleClick),this.throttledHandleTimeupdate_=n.default.throttle(this.handleTimeupdate_.bind(this),200),this.boundHandleEnded_=this.handleEnded_.bind(this),this.boundHandleLoadstart_=this.handleLoadstart_.bind(this),this.on(this.closeButton_,"close",this.handleClose_),this.on(t,"adstart",this.handleAdStart_),this.on(t,"nopostroll",this.handleNoPostroll_),this.toggleListeners_("on")}createEl(){this.countdownEl_=i.default.dom.createEl("div",{className:"vjs-next-overlay-countdown"}),this.nameEl_=i.default.dom.createEl("div",{className:"vjs-next-overlay-name"}),this.bannerEl_=i.default.dom.createEl("div",{className:"vjs-next-overlay-banner"},{},[this.countdownEl_,this.nameEl_]);const t=super.createEl("div",{className:"vjs-next-overlay vjs-hidden"});return t.appendChild(this.bannerEl_),t}dispose(){this.bannerEl_=null,this.countdownEl_=null,this.nameEl_=null,this.imageEl_&&i.default.off(this.imageEl_),this.imageEl_=null,super.dispose()}handleClick(t){const e=this.closeButton_.el();t.target===e||e.contains(t.target)||this.player_.playlist.next()}handleStateChanged(t){const{changes:e}=t,{name:s,seconds:n,thumbnail:l}=this.state;if(e.seconds){let t=this.localize("Up next");this.canShowCountdown_()&&"number"==typeof n&&(t=this.localize("Up next in {1} seconds",[n])),i.default.dom.textContent(this.countdownEl_,t)}if(e.name&&i.default.dom.textContent(this.nameEl_,s||""),e.thumbnail&&(this.imageEl_&&this.el_.removeChild(this.imageEl_),"string"==typeof l&&/\S/.test(l))){const t=this.imageEl_=new window.Image;t.src=l,t.alt="",i.default.on(t,"load",(()=>{i.default.dom.appendContent(this.el_,t)})),i.default.on(t,"error",(()=>{this.imageEl_=null}))}}shouldShow_(){const t=this.player(),e=t.playlist;return!(this.hiddenByUser_||e.nextIndex()===e.currentIndex()||t.getChild("NextEndscreen")&&t.ended())}canShowCountdown_(){const t=this.player();return"number"==typeof t.playlist.autoadvance_.delay&&(!t.usingPlugin("ads")||this.haveSeenNoPostroll_||this.haveSeenEnded_)}getRemaining_(){const t=this.player(),e=t.duration(),s=t.currentTime();let i;if(i=e>30?e-10:Math.ceil(.6666*e),s<i)return;let n=Math.ceil(e)-Math.ceil(s);return t.playlist.autoadvance_.delay&&(n+=t.playlist.autoadvance_.delay),n}handleClose_(){this.hiddenByUser_=!0,this.hide()}toggleListeners_(t){this[t](this.player_,"ended",this.boundHandleEnded_),this[t](this.player_,"loadstart",this.boundHandleLoadstart_),this[t](this.player_,"timeupdate",this.throttledHandleTimeupdate_)}handleAdStart_(){this.hide(),this.toggleListeners_("off"),this.one(this.player_,["adend","adtimeout"],(()=>{this.toggleListeners_("on")}))}handleNoPostroll_(){this.haveSeenNoPostroll_=!0}handleEnded_(){if(this.haveSeenEnded_=!0,this.clearInterval(this.countdownInterval_),!this.shouldShow_())return void this.hide();let t=this.player().playlist.autoadvance_.delay;if(t>0){let e=Date.now();const s=()=>{const s=Date.now();s-e>=1e3&&(e=s,t--,this.setState({seconds:t}),0===t&&this.clearInterval(this.countdownInterval_))};this.show(),this.state.seconds=null,this.setState({seconds:t}),this.countdownInterval_=this.setInterval(s,100)}}handleLoadstart_(){const t=this.player().playlist,e=t()[t.nextIndex()];this.clearInterval(this.countdownInterval_),this.hiddenByUser_=!1,this.haveSeenEnded_=!1,this.haveSeenNoPostroll_=!1,this.hide(),e&&this.setState({name:e.name,thumbnail:e.thumbnail})}handleTimeupdate_(){this.shouldShow_()?(this.setState({seconds:this.getRemaining_()}),this.state.seconds>=0?this.show():this.hide()):this.hide()}});
/*! @name @brightcove/videojs-endscreen @version 1.2.2 @license UNLICENSED */
var S=function(t,e){return"function"==typeof t.usingPlugin?t.usingPlugin(e):"ads"===e?"object"==typeof t.ads:"playlist"===e?!(!t.playlist||"object"!=typeof t.playlist.autoadvance_):!!t[e]},j=function(t){t.postrollStarted=!1,t.postrollFinished=!1,t.postrollTimedOut=!1,t.sawNoPostrollEvent=!1},P=function(){var t=this;if(!this.endscreenState_){var e=this.endscreenState_={},s=function(){return t.trigger("endscreen")};j(e),this.on("adstart",(function(){var s=t.ended();e.postrollStarted=s,e.postrollFinished=!s})),this.on("adend",(function(){e.postrollFinished=t.ended()})),this.on("adtimeout",(function(){e.postrollTimedOut=t.ended()})),this.on(["endscreen","loadstart"],(function(){t.off("adend",s),j(e)})),this.on("nopostroll",(function(){e.sawNoPostrollEvent=!0})),this.on("ended",(function(){(function(t){if(!S(t,"playlist"))return!1;var e=t.playlist,s=e();return!(0!==e.autoadvance_.delay||!s.length)&&(e.repeat()||e.currentItem()!==s.length-1)})(t)||(!function(t){if(!S(t,"ads"))return!1;var e=t.endscreenState_;return!e.sawNoPostrollEvent&&e.postrollStarted&&!e.postrollFinished&&!e.postrollTimedOut}(t)?s():t.one("adend",s))}))}};P.VERSION="1.2.2",i.default.registerPlugin?i.default.getPlugin("endscreen")||i.default.registerPlugin("endscreen",P):i.default.plugin("endscreen",P);const{Date:N}=window,O=i.default.getComponent("Button"),A=i.default.getComponent("ModalDialog"),T=t=>"string"==typeof t&&/\S/.test(t);class B extends O{buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(t){t.stopPropagation(),this.player_.playlist.next()}}class k extends A{constructor(t,e){super(t,e),t.endscreen(),this.closeable(!1),this.on("click",this.handleClick),this.on(t,"endscreen",this.handleEndscreen_),this.on(t,"loadstart",this.handleLoadstart_),this.on(t,"adstart",this.handleAdStart_)}buildCSSClass(){return`vjs-next-endscreen ${super.buildCSSClass()}`}dispose(){this.countdownEl_=null,this.nameEl_=null,this.thumbPlay_&&this.thumbPlay_.dispose(),this.imageEl_&&i.default.off(this.imageEl_),this.imageEl_=null,this.thumbEl_=null,super.dispose()}content(){return this.countdownEl_=i.default.dom.createEl("div",{className:"vjs-next-endscreen-countdown"}),this.nameEl_=i.default.dom.createEl("div",{className:"vjs-next-endscreen-name"}),this.thumbEl_=i.default.dom.createEl("div",{className:"vjs-next-endscreen-thumbnail"}),T(this.state.name)&&i.default.dom.textContent(this.nameEl_,this.state.name),this.thumbPlay_&&(this.thumbPlay_.dispose(),this.thumbPlay_=null),T(this.state.thumbnail)?(this.imageEl_=new window.Image,this.imageEl_.src=this.state.thumbnail,this.imageEl_.alt="",i.default.on(this.imageEl_,"load",(()=>{this.thumbPlay_=new B(this.player()),i.default.dom.appendContent(this.thumbEl_,[this.imageEl_,this.thumbPlay_.el()])})),i.default.on(this.imageEl_,"error",(()=>{this.imageEl_=null}))):(this.thumbEl_=null,this.imageEl_=null),[this.countdownEl_,this.nameEl_,this.thumbEl_]}handleClick(t){this.player_.playlist.next()}handleStateChanged(t){t.changes.seconds&&this.requestAnimationFrame((()=>{i.default.dom.textContent(this.countdownEl_,this.localize("Up next in {1} seconds",[this.state.seconds]))}))}shouldOpen_(){const t=this.player(),e=t.playlist;return!(t.usingPlugin("customEndscreen")||t.usingPlugin("social")&&t.socialOverlay&&t.socialOverlay.asEndscreen())&&(e.nextIndex()!==e.currentIndex()&&"number"==typeof e.autoadvance_.delay)}handleEndscreen_(){if(this.clearInterval(this.countdownInterval_),!this.shouldOpen_())return void this.close();let t=this.player().playlist.autoadvance_.delay;if(t>0){let e=N.now();const s=()=>{const s=N.now();s-e>=1e3&&(e=s,t--,this.setState({seconds:t}),0===t&&this.clearInterval(this.countdownInterval_))};this.open(),this.setState({seconds:t}),this.countdownInterval_=this.setInterval(s,100)}}handleLoadstart_(){const t=this.player().playlist,e=t()[t.nextIndex()];this.clearInterval(this.countdownInterval_),this.close(),e&&this.setState({name:e.name,seconds:void 0,thumbnail:e.thumbnail})}handleAdStart_(){this.opened()&&(this.clearInterval(this.countdownInterval_),this.setState({seconds:void 0}),this.close())}}k.prototype.options_={fillAlways:!0,pauseOnOpen:!0,temporary:!1},i.default.registerComponent("NextEndscreen",k);const H=i.default.getComponent("Component");class z extends H{createEl(){return this.listEl_=i.default.dom.createEl("div",{className:"vjs-playlist"}),i.default.dom.createEl("div",{className:`vjs-playlist-sidebar vjs-playlist-sidebar-${this.options_.orientation}`},{},this.listEl_)}listEl(){return this.listEl_}toggleHidden(){}}i.default.registerComponent("PlaylistSidebar",z);class M extends z{constructor(t,e){super(t,e),this.setState({hidden:!!e.hideOnStart}),this.on(this.showHideEl_,"click",(()=>this.toggleHidden())),this.on(this.showHideEl_.children[0],["focus","blur"],(()=>{this.toggleClass("vjs-show-hide-focus")})),this.on(t,"play",(()=>this.toggleHidden(!0))),this.on(document.body,["mouseenter","mouseleave"],(t=>{this.hasClass("vjs-show-hide-focus")||this.toggleClass("vjs-playlist-show-hide-hidden","mouseleave"===t.type)}))}createEl(){const t=super.createEl();return this.showHideBtnEl_=i.default.dom.createEl("button"),this.showHideEl_=i.default.dom.createEl("div",{className:"vjs-playlist-show-hide"},{},this.showHideBtnEl_),t.appendChild(this.showHideEl_),t}handleStateChanged(t){if(t.changes.hidden){const e=t.changes.hidden.to;this.toggleClass("vjs-playlist-hidden",e),i.default.dom.textContent(this.showHideBtnEl_,e?"<":">"),this.setState({animating:!0})}if(t.changes.animating){const e=t.changes.animating.to;this.toggleClass("vjs-playlist-animating",e),e&&this.setTimeout((()=>this.setState({animating:!1})),50)}}toggleHidden(t){void 0===t&&(t=!this.state.hidden),this.state.animating||this.setState({hidden:t})}}M.defaultState={hidden:void 0,animating:!1},i.default.registerComponent("CollapsiblePlaylistSidebar",M);const U="vjs-playlist-player-container",D=i.default.getPlugin("plugin"),L={hideOnStart:!1,nextButton:!0,nextOverlay:!0,nextEndscreen:!0,playOnSelect:!1,repeat:!1,shuffle:!1,playlistPicker:!0},{dom:V}=i.default;class q extends D{constructor(t,e){super(t,e),this.options=i.default.obj.merge(L,e),t.addClass("vjs-playlist-enabled"),this.orientation_=this.options.horizontal?"horizontal":"vertical",this.isInIframe_=V.hasClass(document.documentElement,"bc-iframe");const s=t.el().parentNode;this.isInIframe_?(this.containerEl_=document.body,V.addClass(this.containerEl_,U)):V.hasClass(s,U)&&(this.containerEl_=s),this.initPlaylist_(),this.initPlaylistUi_(),this.initNextButton_(),this.initNextEndscreen_(),this.initNextOverlay_(),this.options.playlistPicker&&(this.handlePlaylistChangeBound_=this.handlePlaylistChange_.bind(this),this.on(t,"playlistchange",this.handlePlaylistChangeBound_),this.handlePlaylistChangeBound_())}toggleSidebar(){this.sidebar_&&this.sidebar_.toggleHidden()}dispose(){super.dispose(),["sidebar_","nextButton_","nextOverlay_","nextEndscreen_"].forEach((t=>{this[t]&&this[t].dispose()}))}initNextButton_(){let{nextButton:t,playOnSelect:e}=this.options;if(!t)return;n.default.isObj(t)||(t={}),t.hasOwnProperty("playOnSelect")||(t.playOnSelect=!!e);const s=this.player.getChild("controlBar"),i=s.children().map((t=>t.name())).indexOf("SkipForward")+1;this.nextButton_=s.addChild("NextButton",t,i)}initNextOverlay_(){let{nextOverlay:t}=this.options;t&&(n.default.isObj(t)||(t={}),this.nextOverlay_=this.player.addChild("NextOverlay",t))}initNextEndscreen_(){let{nextEndscreen:t}=this.options;t&&(n.default.isObj(t)||(t={}),this.nextEndscreen_=this.player.addChild("NextEndscreen",t))}initPlaylist_(){const{options:t,player:e}=this;t.shuffle&&e.on("duringplaylistchange",(()=>e.playlist.shuffle())),e.playlist(t.playlist),e.playlist.repeat(!!t.repeat),void 0!==t.autoadvance&&e.playlist.autoadvance(t.autoadvance)}initPlaylistUi_(){const{options:t,player:e}=this,s=e.el().parentNode,n={horizontal:t.horizontal,playOnSelect:t.playOnSelect};this.options.playlistPicker&&(this.containerEl_&&(t.horizontal?this.sidebar_=e.addChild("PlaylistSidebar",{orientation:this.orientation_}):this.sidebar_=e.addChild("CollapsiblePlaylistSidebar",{hideOnStart:t.hideOnStart,orientation:this.orientation_})),this.sidebar_?(s.appendChild(this.sidebar_.el()),n.el=this.sidebar_.listEl(),this.finalizePlaylistUi_(n)):"loading"!==document.readyState?this.finalizePlaylistUi_(n):i.default.one(document,"DOMContentLoaded",(()=>{this.finalizePlaylistUi_(n)})))}finalizePlaylistUi_(t){const{player:e}=this,{bcinfo:s,tagAttributes:i}=e,n=s&&s.playerId||i["data-player"],l=s&&s.embedId||i["data-embed"],a=s&&s.applicationId||i["data-application-id"];if(!e.el())return;const o=document.querySelector(`.vjs-playlist[data-for="${e.id()}"]`);if(o)t.el=o;else if(n&&l){const e=Array.prototype.slice.call(document.querySelectorAll(`.vjs-playlist[data-player="${n}"][data-embed="${l}"]`));for(let s=0;s<e.length;s++){const i=e[s];if(!a){t.el=i;break}if(a===i.getAttribute("data-application-id")){t.el=i;break}}}t.showDescription=this.options.showDescription,e.playlistUi(t)}handlePlaylistChange_(){const t=this.player.playlist().length>0;this.sidebar_&&(t?this.sidebar_.show():this.sidebar_.hide());const e=`vjs-playlist-${this.orientation_}-enabled`;this.containerEl_&&V.toggleClass(this.containerEl_,e,t)}}return i.default.registerPlugin("bcPlaylistUi",q),q.VERSION="5.1.1",q}));
