/*! For license information please see common-bff47d4d.44897127fb1314b8fed9.js.LICENSE.txt */
"use strict";(self.webpackChunk_vzmi_finance_cosaic=self.webpackChunk_vzmi_finance_cosaic||[]).push([[194],{1235:(t,i,e)=>{var s=e(4603);e(8978);(t=>{var i=void 0!==s.mE?s.mE:t.CIQ;i.ChartEngine.prototype.pointerEvents={down:[],up:[]},i.ChartEngine.prototype.manageTouchAndMouse=!0,i.ChartEngine.prototype.registerTouchAndMouseEvents=function(){if(!this.touchAndMouseEventsRegistered){this.touchAndMouseEventsRegistered=!0;var t=this.controls.chartControls||document,e=(t.querySelector(".stx-zoom-in"),t.querySelector(".stx-zoom-out"),this.chart.container),s=this,n=function(t,i,n){s.addDomEventListener(e,t,(function(t){s.mainSeriesRenderer.nonInteractive||i(t)}),n)};i.touchDevice?i.isSurface?(n("mousemove",(function(t){s.msMouseMoveProxy(t)})),n("mouseenter",(function(t){s.msMouseMoveProxy(t)})),n("mousedown",(function(t){s.msMouseDownProxy(t)})),n("mouseup",(function(t){s.msMouseUpProxy(t)})),n("pointerdown",(function(t){return s.startProxy(t)})),n("pointermove",(function(t){s.moveProxy(t)})),n("pointerenter",(function(t){return s.moveProxy(t)})),n("pointerup",(function(t){return s.endProxy(t)}))):(i.isMobile||(n("mousemove",(function(t){s.iosMouseMoveProxy(t)})),n("mouseenter",(function(t){s.iosMouseMoveProxy(t)})),n("mousedown",(function(t){s.iosMouseDownProxy(t)})),n("mouseup",(function(t){s.iosMouseUpProxy(t)}))),n("touchstart",(function(t){s.touchstart(t)}),{passive:!1}),n("touchmove",(function(t){s.touchmove(t)}),{passive:!1}),n("touchend",(function(t){s.touchend(t)})),n("pointerdown",(function(t){s.touchPointerType=t.pointerType}))):(n("mousemove",(function(t){s.mousemove(t)})),n("mouseenter",(function(t){s.mousemove(t)})),n("mousedown",(function(t){s.mousedown(t)})),n("mouseup",(function(t){s.mouseup(t)})));var a=i.wheelEvent;this.captureMouseWheelEvents&&n(a,(function(t){s.mouseWheel(t)}),{passive:!1})}},i.ChartEngine.prototype.mousedown=function(t){if(this.runPrepend("mousedown",arguments))return;if(this.grabOverrideClick=!1,!this.displayInitialized)return;if(!this.displayCrosshairs)return;if(this.repositioningDrawing)return;if(this.editingAnnotation)return;if(t.target&&t.target.closest("[draggable]"))return;if(t.button&&t.button>=2)return;const e=this.container.getBoundingClientRect();if(this.top=e.top,this.left=e.left,this.right=this.left+this.width,this.bottom=this.top+this.height,!(t.clientX>=this.left&&t.clientX<=this.right&&t.clientY>=this.top&&t.clientY<=this.bottom))return void(this.insideChart=!1);if(this.insideChart=!0,!this.currentPanel)return;this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.hasDragged=!1,this.userPointerDown=!0,""===this.openDialog&&this.registerPointerEvent({x:t.clientX,y:t.clientY,time:this.mouseTimer},"down");const{chart:s}=this.currentPanel;for(let a=0;a<this.drawingObjects.length;a++){const t=this.drawingObjects[a];if(t.highlighted&&!t.permanent){if(this.cloneDrawing){const e=new(0,i.ChartEngine.drawingTools[t.name]);return e.reconstruct(this,t.serialize()),this.drawingObjects.push(e),this.activateRepositioning(e),void(e.repositioner=t.repositioner)}const e=this.currentVectorParameters.vectorType;if(!(i.Drawing&&e&&i.Drawing[e]&&(new i.Drawing[e]).dragToDraw))return void this.activateRepositioning(t)}}const{anchorHandles:n}=this.controls;if(n)for(let i in n){let{handle:t,sd:e,highlighted:s}=n[i];if(s)return this.repositioningAnchorSelector={sd:e},void t.classList.add("stx-grab")}this.drawingClick&&(this.currentPanel.subholder===t.target&&this.drawingClick(this.currentPanel,this.cx,this.cy),this.activeDrawing&&this.activeDrawing.dragToDraw)||(this.grabbingScreen=!0,s.spanLock=!1,this.yToleranceBroken=!1,this.grabStartX=t.clientX,this.grabStartY=t.clientY,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=s.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(this.currentPanel),this.grabStartZoom=this.grabStartYAxis?this.grabStartYAxis.zoom:0,this.grabStartPanel=this.currentPanel,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100),this.swipeStart&&this.swipeStart(s),(this.longHoldTime||0===this.longHoldTime)&&this.startLongHoldTimer(),this.runAppend("mousedown",arguments))},i.ChartEngine.prototype.mousemove=function(t){var e=t;i.ChartEngine.crosshairX=e.clientX,i.ChartEngine.crosshairY=e.clientY,e.type.toLowerCase().indexOf("enter")>-1?this.positionCrosshairsAtPointer():this.runPrepend("mousemove",arguments)||this.displayInitialized&&""===this.openDialog&&(this.grabbingScreen&&1!==e.buttons&&(this.cancelLongHold=!0,this.displayDragOK(),this.grabbingScreen=!1,this.findHighlights(!1,!0)),this.mousemoveinner(e.clientX,e.clientY),this.runAppend("mousemove",arguments))},i.ChartEngine.prototype.mouseup=function(t){if(this.runPrepend("mouseup",arguments))return;if(this.swipe.end=!0,this.cancelLongHold=!0,this.repositioningDrawing){if(!this.currentVectorParameters.vectorType||Date.now()-this.mouseTimer>250)return this.changeOccurred("vector"),i.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.adjustDrawings(),void this.draw();this.activateRepositioning(null)}if(this.repositioningAnchorSelector){const{sd:t}=this.repositioningAnchorSelector;return i.Studies.repositionAnchor(this,t),void(this.controls.anchorHandles[t.uniqueId]&&(this.repositioningAnchorSelector=null,this.controls.anchorHandles[t.uniqueId].highlighted=!1,i.Studies.displayAnchorHandleAndLine(this,t,this.chart.dataSegment),Object.values(this.controls.anchorHandles||{}).forEach((({handle:t})=>t.classList.remove("stx-grab"))),this.findHighlights()))}const e=this.userPointerDown;if(this.userPointerDown=!1,!this.displayInitialized)return;const s=this.backOutY(t.clientY),n=this.backOutX(t.clientX),a=t.button&&t.button>=2;""!==this.openDialog||a||this.registerPointerEvent({x:t.clientX,y:t.clientY,time:Date.now()},"up"),this.grabbingScreen=!1,this.highlightedDraggable&&(this.dragPlotOrAxis&&this.dragPlotOrAxis(n,s),this.currentPanel=this.whichPanel(s));const r=this.currentPanel;if(this.grabStartYAxis=null,this.displayDragOK(),""!==this.openDialog)return void(this.insideChart&&this.container.classList.remove("stx-drag-chart"));if(this.grabOverrideClick)return this.overXAxis||this.overYAxis||!this.swipeRelease||this.swipeRelease(),this.container.classList.remove("stx-drag-chart"),this.grabOverrideClick=!1,this.doDisplayCrosshairs(),void this.updateChartAccessories();if(this.insideChart&&this.container.classList.remove("stx-drag-chart"),i.ChartEngine.resizingPanel)return void this.releaseHandle();if(a||t.ctrlKey){if(this.anyHighlighted&&!0!==this.bypassRightClick){if(this.overYAxis){const t=r.yaxisLHS.concat(r.yaxisRHS).find((t=>!0===t.highlight));t&&t.showContextMenu&&t.showContextMenu(i.ChartEngine.crosshairX,i.ChartEngine.crosshairY)}return this.rightClickHighlighted(),t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t.stopPropagation(),!1}return this.dispatch("rightClick",{stx:this,panel:r,x:n,y:s}),!0}if(t.clientX<this.left||t.clientX>this.right)return;if(t.clientY<this.top||t.clientY>this.bottom)return;const h=r&&r.subholder===t.target;if(this.isDoubleClick()&&(h||this.overYAxis||this.overXAxis))this.doubleClick(t.button,n,s),this.resetClickState();else if(e&&h&&(!this.drawingClick||this.longHoldTookEffect&&!this.activeDrawing||this.drawingClick(r,n,s),this.longHoldTookEffect||!this.activeMarker||this.activeMarker.params.noInteraction||this.activeMarker.click({cx:n,cy:s,panel:r})),!this.longHoldTookEffect&&!this.activeDrawing){let t=!0;this.anyHighlighted&&this.leftClickPinTooltip&&this.allowPinning&&this.highlightedPlot&&this.allowPinning(this.highlightedPlot.type)&&(t=!this.leftClickPinTooltip({cx:n,cy:s})),t&&this.dispatch("tap",{stx:this,panel:r,x:n,y:s})}this.runAppend("mouseup",arguments)},i.ChartEngine.prototype.registerPointerEvent=function(t,i){this.pointerEvents[i].length>1&&this.pointerEvents[i].pop(),this.pointerEvents[i].unshift(t)},i.ChartEngine.prototype.resetPointerEvent=function(t){this.pointerEvents[t].splice(0)},i.ChartEngine.prototype.resetClickState=function(){this.resetPointerEvent("up"),this.resetPointerEvent("down"),this.cancelTouchSingleClick=!0},i.ChartEngine.prototype.isDoubleClick=function(t){const e=t?35:20,{up:[s,n],down:[a,r]}=this.pointerEvents,h=n&&r&&a.time-n.time<this.doubleClickTime&&i.withinRadius(r,a,e)&&i.withinRadius(n,a,e)&&n.time-r.time<this.longHoldTime&&s.time-a.time<this.longHoldTime;return this.cancelTouchSingleClick=h,h},i.ChartEngine.prototype.doubleClick=function(t,e,s){if(this.runPrepend("doubleClick",arguments))return;if(this.editingAnnotation)return;if(i.ChartEngine.drawingLine)return"continuous"==this.currentVectorParameters.vectorType&&i.ChartEngine.completeDrawing(this),this.undo();if(this.activeDrawing)return;this.activeMarker&&this.activeMarker.doubleClick({cx:e,cy:s,panel:this.currentPanel})||this.dispatch("doubleClick",{stx:this,button:t,x:e,y:s}),this.runAppend("doubleClick",arguments)},i.ChartEngine.prototype.handleMouseOut=function(t){if(!(t=t||window.event).relatedTarget||!i.withinElement(this.chart.container,t.pageX,t.pageY)){if(this.runPrepend("handleMouseOut",arguments))return;if(this.grabbingScreen||this.findHighlights(null,!0),this.undisplayCrosshairs(),this.touches=[],this.touching=!1,this.activeDrawing&&this.userPointerDown){this.userPointerDown=!1,this.drawingLine=!1;var e=this.backOutY(t.pageY),s=this.backOutX(t.pageX);this.drawingClick(this.currentPanel,s,e)}const{sd:a,tapToAdd:r}=this.repositioningAnchorSelector||{};a&&!r&&(this.repositioningAnchorSelector=null,this.controls.anchorHandles[a.uniqueId].highlighted=!1,i.Studies.displayAnchorHandleAndLine(this,a,this.chart.dataSegment),this.draw()),this.insideChart=!1,this.overYAxis=!1,this.overXAxis=!1,this.displaySticky();var n=this.controls.dragOk;n&&(n.style.display="none"),this.runAppend("handleMouseOut",arguments)}},i.ChartEngine.prototype.startLongHoldTimer=function(t){var i=this;this.cancelLongHold=!1,this.longHoldTimeout&&clearTimeout(this.longHoldTimeout);var e=function(){i.cancelLongHold||(i.longHoldTookEffect=!0,t&&t(),i.dispatch("longhold",{stx:i,panel:i.currentPanel,x:i.cx,y:i.cy}),i.displayDragOK())};this.longHoldTime?this.longHoldTimeout=setTimeout(e,this.longHoldTime):0===this.longHoldTime&&e()},i.ChartEngine.prototype.grabHandle=function(t){this.runPrepend("grabHandle",arguments)||t&&(i.ChartEngine.crosshairY=this.resolveY(t.top),i.ChartEngine.resizingPanel=t,t.handle.classList.add("stx-grab"),this.runAppend("grabHandle",arguments))},i.ChartEngine.prototype.grabbingHand=function(){this.allowScroll&&this.grabbingScreen&&(i.touchDevice||this.container.classList.add("stx-drag-chart"))},i.ChartEngine.prototype.releaseHandle=function(){if(this.runPrepend("releaseHandle",arguments))return!0;i.clearCanvas(this.chart.tempCanvas,this),this.resizePanels(),i.ChartEngine.resizingPanel&&i.ChartEngine.resizingPanel.handle.classList.remove("stx-grab"),i.ChartEngine.resizingPanel=null,this.runAppend("releaseHandle",arguments)},i.ChartEngine.prototype.findHighlights=function(t,e){var s=this.preferences[t?"highlightsTapRadius":"highlightsRadius"];this.highlightViaTap=t;var{cx:n,cy:a}=this;if(this.anyHighlighted=!1,this.currentPanel){var{chart:r}=this.currentPanel;this.activeDrawing&&(e=!0);var h,o,l,c,g,d=!1,u=null,p=e?{}:{forceShow:!0,type:"drawing"},m={x0:this.tickFromPixel(n-s,r),x1:this.tickFromPixel(n+s,r),y0:this.valueFromPixel(a-s,this.currentPanel),y1:this.valueFromPixel(a+s,this.currentPanel),cx0:n-s,cx1:n+s,cy0:a-s,cy1:a+s,r:s};if(this.repositioningDrawing&&m.x1-m.x0<2?(m.x1++,m.x0--):m.x1==m.x0&&(m.x0-=.5,m.x1+=.5),!r.hideDrawings)for(var v=this.drawingObjects.length-1;v>=0;v--){var f=this.drawingObjects[v],y=this.panels[f.panelName];if(f.hidden||!y||f.field&&!this.getYAxisByField(y,f.field))f.highlighted=!1;else if(!this.repositioningDrawing||this.repositioningDrawing==f){var x=f.highlighted,b=f.panelName==this.currentPanel.name||f.spanPanels;b&&(f.repositioner=f.intersected(this.crosshairTick,this.crosshairValue,m)),b=b&&f.repositioner&&!this.overXAxis&&!this.overYAxis,!e&&b?(x?(u=f,this.anyHighlighted&&this.singleDrawingHighlight&&(f.highlighted=!1),f.highlighted&&f.highlighted!=x&&(d=!0)):x!=f.highlight(!0)&&(u||(u=f),this.anyHighlighted&&this.singleDrawingHighlight&&(f.highlighted=!1),d=!0),this.anyHighlighted=!0):x!=f.highlight(!1)&&(d=!0),f.highlighted&&(p.noDelete=f.permanent,p.noEdit=!this.callbackListeners.drawingEdit.length,p.noText=p.noEdit||!f.edit,p.message=this.translateIf(i.capitalize(f.name)))}}for(h in this.layout.studies)(o=this.layout.studies[h]).prev=o.highlight,o.highlight=this.yaxisMatches(o,this.grabStartYAxis);for(h in r.seriesRenderers){var w=r.seriesRenderers[h];w.params.highlight=this.yaxisMatches(w,this.grabStartYAxis);for(var C=0;C<w.seriesParams.length;C++)(g=w.seriesParams[C]).prev=g.highlight,g.highlight=w.params.highlight}var{anchorHandles:S}=this.controls;if(S)for(var k in S)S[k].highlighted=!1;var P,D=this.markerHelper&&this.markerHelper.visibleCanvasMarkers;if(D)for(l=0;l<D.length;l++)c=D[l],this.activeMarker=null,c.prev=c.highlight,c.highlight=!1;if(this.markerHelper&&(this.markerHelper.highlighted=[]),this.highlightedDataSetField=null,this.highlightedPlot={},this.highlightedDraggable=null,!e&&!this.anyHighlighted&&S)for(let t in S){const e=S[t];if(!1!==i.getFromNS(e,"sd.signalData.reveal")){if(!this.anyHighlighted){const{sd:t,currentPixel:r}=e,h=r-s,o=r+s,l=this.panels[t.panel],{top:c,bottom:g}=l.yAxis;if(i.boxIntersects(h,c,o,g,n,a,n,a)){this.anyHighlighted=!0,e.highlighted=!0,d=!0,p={message:t.name,type:"anchorHandle",noDelete:!0};continue}}!0===e.highlighted&&(e.highlighted=!1,d=!0)}}if(!e&&!this.anyHighlighted&&r.dataSegment){var H=this.barFromPixel(n);if(H>=0&&H<r.dataSegment.length){var E,A=i.convertBoxToPixels(this,this.currentPanel.name,m),M=Number.MAX_VALUE;if(D)for(l=0;l<D.length;l++){var T=(c=D[l]).params.box;if(T&&c.params.panelName===this.currentPanel.name){if(i.boxIntersects(A.x0,A.y0,A.x1,A.y1,T.x0,T.y0,T.x1,T.y1)){var O=Math.pow(a-(T.y1+T.y0)/2,2)+Math.pow(n-(T.x1+T.x0)/2,2);O<=M&&(M=O,this.activeMarker=c),this.anyHighlighted=!0,p={},c.highlight=!0,this.markerHelper.highlighted.push(c)}c.prev!=c.highlight&&(d=!0)}}if(!this.anyHighlighted){M=Number.MAX_VALUE;var z=null;for(h in this.overlays){if(D&&this.markerHelper.highlighted.length)break;if((!(o=this.overlays[h]).signalData||o.signalData.reveal)&&!o.disabled&&o.panel==this.currentPanel.name&&!1!==o.study.isHighlighted)if("function"!=typeof o.study.isHighlighted){if(r.dataSegment[H])for(var Y in o.outputMap){var L=st.call(this,H,m,Y,o.getYAxis(this));!1!==L&&L<=M&&(z={o,out:Y},M=L)}}else{var R=o.study.isHighlighted(this,n,a);if(R){z={o,out:!0===R?o.study.name:R},M=0;break}}}for(h in r.seriesRenderers){if(this.highlightedDataSetField)break;var X=r.seriesRenderers[h],I=X.params.panel;if((this.leftClickPinTooltip||X!=this.mainSeriesRenderer)&&((X.params.highlightable||this.currentVectorParameters.vectorType)&&I==this.currentPanel.name))for(l=0;l<X.seriesParams.length;l++)if(!(g=X.seriesParams[l]).disabled){var F=g.field||this.defaultPlotField||"Close";g.symbol&&g.subField&&(F+="--\x3e"+g.subField);var _=X.params.yAxis;if(!_&&I&&(_=this.panels[I].yAxis),X.params.step&&H>0){if(!X.caches[g.id])continue;if(!(E=X.caches[g.id][H])&&0!==E)continue;var W=X.caches[g.id][H-1];if((W||0===W)&&a+s>=E&&a-s<=W||a-s<=E&&a+s>=W){z={s:g,fullField:F};break}}else{var B=st.call(this,H,m,F,_,X,g.id);!1!==B&&B<=M&&(z={s:g,fullField:F},M=B)}}}z&&(this.highlightedPlot=z,(o=z.o)?(z.type="study",o.name!=o.panel&&(this.anyHighlighted=!0),o.highlight=z.out,this.highlightedDataSetField=z.out):(z.type="series",this.anyHighlighted=!0,z.s.highlight=!0,this.highlightedDataSetField=z.fullField))}}}var q,N=this.preferences.dragging;for(h in this.overlays){if((o=this.overlays[h]).highlight){this.anyHighlighted=!0;var j=o.inputs.display||o.name;p={message:j=this.translateIf(j),noDelete:o.permanent,noEdit:!o.editFunction,noText:!o.textFunction,noDrag:o.undraggable&&o.undraggable(this),type:"study",backgroundColor:nt(r.legendColorMap[o.name]&&r.legendColorMap[o.name].color)},u=null,(!0===N||N&&N.study)&&(o.undraggable(this)||(P=o)),q=o.getYAxis(this)}o.prev!=o.highlight&&(d=!0)}for(h in r.seriesRenderers)for(var V=r.seriesRenderers[h],Z=V.params.yAxis?V.params.yAxis.textStyle:null,K=0;K<V.seriesParams.length;K++){if(g=V.seriesParams[K],V.params.highlightable&&g.highlight){this.anyHighlighted=!0;var U=r.legendColorMap[h]&&r.legendColorMap[h].color||g.color||Z;U=nt(U,g.opacity),p={message:g.display||g.symbol,backgroundColor:U,noDelete:V.params.permanent||g.permanent,noDrag:V.undraggable&&V.undraggable(this),type:"series"},u=null,(!0===N||N&&N.series)&&(P=V,V.params.highlight=!0),q=V.getYAxis(this)}g.prev!=g.highlight&&(d=!0)}for(h in this.plugins){var G=this.plugins[h],Q={};G.findHighlights&&((Q=G.findHighlights(this,t,e)).somethingChanged&&(d=!0),Q.anyHighlighted&&(this.anyHighlighted=!0,p=Q.stickyArgs||{}))}var J=this.whichPanel(a),$=this.whichYAxis(J,n);q||(q=$),this.currentBaseline&&(q=this.currentBaseline.getYAxis(this)),q&&(q.highlight||(d=!0),q.highlight=!0);var tt=[];for(var it in this.panels)tt=tt.concat(this.panels[it].yaxisLHS).concat(this.panels[it].yaxisRHS);for(h=0;h<tt.length;h++)(q!=tt[h]||e)&&(tt[h].highlight&&(d=!0),tt[h].highlight=!1);if((!0===N||N&&N.yaxis)&&$&&!$.noDraw&&(this.anyHighlighted=!0,P=$,p={}),d&&(this.draw(),p.panel=J,this.anyHighlighted&&!this.grabStartYAxis?p.panel=J:p={},this.displaySticky(p),this.clearMeasure(),u&&u.measure()),this.anyHighlighted?this.controls.mSticky&&(p&&p.positioner?p.positioner.call(this,this.controls.mSticky):this.positionSticky(this.controls.mSticky)):this.setMeasure(),P&&J&&!J.noDrag){if(this.longHoldTookEffect&&!this.cancelLongHold){if(P.params)for(h in P.params.dependentOf&&((P=r.seriesRenderers[P.params.dependentOf]).params.highlight=!0),r.seriesRenderers)r.seriesRenderers[h].params.dependentOf==P.params.name&&(r.seriesRenderers[h].params.highlight=!0);if(this.highlightedDraggable=P,P.getDependents){var et=P.getDependents(this,!0);for(h in this.overlays)o=this.overlays[h],et.indexOf(o)>-1&&(o.highlight=!0)}}p.noDrag||this.container.classList.add("stx-draggable")}else this.container.classList.remove("stx-draggable");this.highlightedDataSetField=this.adjustHighlightedDataSetField(this.highlightedDataSetField),this.displayDrawOK()}function st(t,e,s,r,h,o){var l=this,c=l.chart,g=l.currentPanel;r||(r=g.yAxis);var d=s.split("--\x3e"),u=d[0],p=d[1];function m(t){if(!t)return null;var i=t[u];return i&&(i[p]||0===i[p])&&(i=i[p]),h&&h.getBasis&&(i+=h.getBasis(t,u,p)),c.transformFunc&&r==c.yAxis?t.transform&&u in t.transform?((i=t.transform[u])&&(i[p]||0===i[p])&&(i=i[p]),i):c.transformFunc(l,c,i):i}p||(p="Close");var v,f,y,x,b,w=c.dataSegment[H],C=null,S=null,k=null,P=new Array(3),D=h&&h.caches[o];if(w&&D){var E;for(y=D[H],C=w.tick,(y||0===y)&&(P[0]=1),E=H-1;E>=0;E--)if(D[E]||0===D[E]){x=D[E],S=C-(H-E),P[1]=1;break}for(E=H+1;E<c.dataSegment.length;E++)if(D[E]||0===D[E]){b=D[E],k=C-(H-E),P[2]=1;break}}if(null===S&&(v=l.getPreviousBar.call(l,c,s,H))&&(S=v.tick,x=m(v)),null===k&&(f=l.getNextBar.call(l,c,s,H))&&(k=f.tick,b=m(f)),null===S&&null===k)return!1;D||(y=m(w),x=m(v),b=m(f),C=w.tick,v&&(S=v.tick),f&&(k=f.tick)),x||0===x||(x=0,S=0),b||0===b||(y||0===y?(b=y,P[2]=P[0]):(b=x,P[2]=P[1]),k=o&&c.series[o]&&c.series[o].parameters.extendToEndOfDataSet?c.dataSet.length-1:S),y||0===y||(y=b,C=k,P[0]=P[2],0===x&&0===S&&(x=y,S=C,P[1]=P[0]));var A=l.pixelFromTransformedValue.bind(l),M=l.valueFromPixel.bind(l);y=M(P[0]?y:A(y,g,r),g),x=M(P[1]?x:A(x,g,r),g),b=M(P[2]?b:A(b,g,r),g);var T=i.convertBoxToPixels(l,g.name,e),O=i.convertBoxToPixels(l,g.name,{x0:S,y0:x,x1:C,y1:y}),z=i.convertBoxToPixels(l,g.name,{x0:C,y0:y,x1:k,y1:b});return!(!i.boxIntersects(T.x0,T.y0,T.x1,T.y1,O.x0,O.y0,O.x1,O.y1,"segment")&&!i.boxIntersects(T.x0,T.y0,T.x1,T.y1,z.x0,z.y0,z.x1,z.y1,"segment"))&&Math.min(Math.pow(a-(O.y1+O.y0)/2,2)+Math.pow(n-(O.x1+O.x0)/2,2),Math.pow(a-(z.y1+z.y0)/2,2)+Math.pow(n-(z.x1+z.x0)/2,2))}function nt(t,e){if(Array.isArray(t)){for(var s="linear-gradient(to right, ",n=0,a=Math.min(3,t.length);n<a;n++)s+=t[n]+" "+Math.round(100*n/a)+"%, ",s+=t[n]+" "+Math.round(100*(n+1)/a)+"%, ";return s+="transparent)"}return"auto"==t&&(t=this.defaultColor),e&&1!==e&&(t=i.hexToRgba(i.colorToHex(t),parseFloat(e))),t}},i.ChartEngine.prototype.rightClickHighlighted=function(){this.runPrepend("rightClickHighlighted",arguments)||(this.deleteHighlighted(!0),this.runAppend("rightClickHighlighted",arguments))},i.ChartEngine.prototype.deleteHighlighted=function(t,e,s){if(!this.runPrepend("deleteHighlighted",arguments)){this.cancelTouchSingleClick=!0,i.clearCanvas(this.chart.tempCanvas,this);var n=!1===this.bypassRightClick;if(n||!this.bypassRightClick.drawing)for(var a=this.drawingObjects.length-1;a>=0;a--){var r=this.drawingObjects[a];if(r.highlighted)if(t)this.rightClickDrawing(r,e,s);else if(!r.permanent){if(!r.abort()){var h=this.exportDrawings();this.drawingObjects.splice(a,1),this.undoStamp(h,this.exportDrawings())}this.changeOccurred("vector")}}if(n||!this.bypassRightClick.study)for(var o in this.overlays){var l=this.overlays[o];(l.overlay||l.underlay)&&l.highlight&&!l.permanent&&(t||e?this.rightClickOverlay(o,e):this.removeOverlay(o))}var c=this.currentPanel&&this.currentPanel.chart;if(c&&(n||!this.bypassRightClick.series))for(var g in c.seriesRenderers){var d=c.seriesRenderers[g];if(d.params.highlightable&&!d.params.permanent)for(var u=this.panels[d.params.panel],p=u&&u.yAxis.name,m=d.seriesParams.length-1;m>=0;m--){var v=d.seriesParams[m];if((d.params.highlight||v.highlight)&&!v.permanent&&(d.removeSeries(v.id),d.seriesParams.length<1))if(this.removeSeriesRenderer(d),d.params.name==p)this.electNewPanelOwner(d.params.panel);else{this.checkForEmptyPanel(d.params.panel);var f=this.getYAxisByName(u,d.params.name);f&&(f.name=f.studies[0]||f.renderers[1])}}}this.draw(),t||e||this.resizeChart(),this.clearMeasure();var y=this.controls.mSticky;y&&(y.style.display="none",y.querySelector(".mStickyInterior").innerHTML=""),this.runAppend("deleteHighlighted",arguments)}},i.ChartEngine.prototype.displayDragOK=function(t){var i=this;function e(t){var e=i.translateIf(t.querySelector(".field").getAttribute("text")),s=i.whichYAxis(i.whichPanel(i.cy),i.cx,i.cy);s&&"all"==s.dropzone&&(e+="--\x3e"+i.translateIf(s.name)),t.querySelector(".field").innerHTML=e}var s=this.controls.dragOk;if(s){t||this.tapForHighlighting&&this.touching&&!this.anyHighlighted||this.findHighlights(this.highlightViaTap);var n=this.highlightedDraggable,a=n&&n.undraggable&&n.undraggable(this),r=this.cx,h=this.cy,o=n&&!a&&this.longHoldTookEffect;if(t)o&&this.insideChart&&(s.style.display="inline-block");else{if(o&&!this.cancelLongHold){var l=n.inputs&&n.inputs.display||n.params&&(n.params.display||n.params.name)||n.name;s.querySelector(".field").setAttribute("text",l),e.call(this,s),s.style.display="inline-block",this.draw(),this.displaySticky(),this.grabStartYAxis?this.container.classList.replace("stx-drag-chart","stx-drag-axis"):this.container.classList.replace("stx-drag-chart","stx-drag-series")}else for(var c in s.style.display="none",this.draw(),this.container.classList.remove("stx-drag-series"),this.container.classList.remove("stx-drag-axis"),this.panels){var g,d=this.panels[c].subholder.classList;for(d.remove("dropzone"),d.remove("all"),d.remove("left"),d.remove("right"),d.remove("top"),d.remove("bottom"),g=0;g<this.panels[c].yaxisLHS.length;g++)this.panels[c].yaxisLHS[g].dropzone=null;for(g=0;g<this.panels[c].yaxisRHS.length;g++)this.panels[c].yaxisRHS[g].dropzone=null}this.draw()}if(n){var u=h+s.offsetHeight,p=Math.max(0,r-s.offsetWidth);s.style.top=u+"px",s.style.left=p+"px",e.call(this,s)}}},i.ChartEngine.prototype.displayDrawOK=function(){var t=this.controls.drawOk;if(t&&i.Drawing){var e=i.Drawing[this.currentVectorParameters.vectorType];if(e&&(e=new e),this.highlightedDataSetField&&e&&e.isAllowed(this,this.highlightedDataSetField)){t.style.display="inline-block";var s=this.cy+t.offsetHeight,n=this.cx-t.offsetWidth;t.style.top=s+"px",t.style.left=n+"px",t.querySelector(".field").innerHTML=this.translateIf(this.highlightedDataSetField)}else t.style.display="none"}},i.ChartEngine.prototype.mouseWheel=function(t){if(!this.runPrepend("mouseWheel",arguments)&&(t.preventDefault&&t.preventDefault(),""===this.openDialog)){var e=t.deltaX,s=t.deltaY;if(Math.abs(s)>Math.abs(e)?e=0:s=0,this.lastMouseWheelEvent=Date.now(),0!==Math.abs(e)||0!==Math.abs(s)){var n;if(t.shiftKey&&s&&(e=s,s=0),this.allowSideswipe&&0!==e){this.lastMove="horizontal";var a=e;return this.grabbingScreen=!0,this.currentPanel||(this.currentPanel=this.chart.panel),this.grabStartX=i.ChartEngine.crosshairX,this.grabStartY=i.ChartEngine.crosshairY,this.grabStartScrollX=this.chart.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartMicropixels=this.micropixels,this.grabStartPanel=this.currentPanel,this.mouseWheelAcceleration&&(a*=n=Math.max(Math.pow(Math.abs(a),.3),1)),this.mousemoveinner(i.ChartEngine.crosshairX-a,i.ChartEngine.crosshairY),i.ChartEngine.crosshairX=this.crosshairX=t.clientX,this.updateChartAccessories(),void(this.grabbingScreen=!1)}if(this.lastMove="vertical",this.allowZoom&&(!this.activeDrawing||this.allowDrawingZoom)&&this.displayInitialized){s||("mousewheel"==i.wheelEvent?(s=-1/40*t.wheelDelta,t.wheelDeltaX&&(e=-1/40*t.wheelDeltaX)):s=t.detail),void 0===t.deltaMode&&(t.deltaMode="MozMousePixelScroll"==t.type?0:1);var r=-s;1==t.deltaMode&&(r*=33);var h=null,o=null;if(this.mouseWheelAcceleration&&(n=Math.max(Math.pow(Math.abs(r),.3),1),o=1/(h=Math.max(Number.MIN_VALUE,1-.1*n))),this.zoomInitiatedByMouseWheel=!0,r>0?this.reverseMouseWheel?this.zoomOut(null,o):this.zoomIn(null,h):r<0&&(this.reverseMouseWheel?this.zoomIn(null,h):this.zoomOut(null,o)),!this.runAppend("mouseWheel",arguments))return!1}}}},i.ChartEngine.handleContextMenu=function(t){for(var e=i.ChartEngine.registeredContainers,s=0;s<e.length;s++)if(t.target.ownerDocument===e[s].ownerDocument){var n=e[s].stx;if(n&&n.anyHighlighted)return t.preventDefault&&t.preventDefault(),!1}},i.ChartEngine.registerGlobalEvent("contextmenu",i.ChartEngine.handleContextMenu),i.ChartEngine.htmlControls={annotationSave:'<span class="stx-btn stx_annotation_save" style="display: none;"></span>',annotationCancel:'<span class="stx-btn stx_annotation_cancel" style="display: none; margin-left:10px;"></span>',mSticky:'\n\t\t<div class="stx_sticky">\n\t\t\t<span class="label">\n\t\t\t\t<span class="mStickyThumbnail"></span>\n\t\t\t\t<span class="mStickyInterior"></span>\n\t\t\t</span>\n\t\t\t<span class="mousePinTooltip">(left-click to pin tooltip)</span>\n\t\t\t<span class="mStickyRightClick">\n\t\t\t\t<span class="overlayText stx-btn" style="display:none">\n\t\t\t\t\t<span>&nbsp;</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="overlayEdit stx-btn" style="display:none">\n\t\t\t\t\t<span>&nbsp;</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="overlayTrashCan stx-btn" style="display:none">\n\t\t\t\t\t<span>&nbsp;</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="mouseDeleteInstructions">\n\t\t\t\t\t<span>(</span>\n\t\t\t\t\t<span class="mouseDeleteText">right-click to delete</span>\n\t\t\t\t\t<span class="mouseManageText">right-click to manage</span>\n\t\t\t\t\t<span>)</span>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t\t<span class="stickyLongPressText">(long-press to drag)</span>\n\t\t\t<span class="customInstructions">\n\t\t\t\t<span>(</span>\n\t\t\t\t<span class="dragAnchorText" type="anchorHandle">\n\t\t\t\t\tdrag to change anchor time\n\t\t\t\t</span>\n\t\t\t\t<span>)</span>\n\t\t\t</span>\n\t\t</div>\n\t',drawOk:'<div class="stx_draw_ok"><div class="icon"></div><div class="field"></div></div>',dragOk:'<div class="stx_drag_ok"><div class="icon"></div><div class="field"></div></div>',crossX:'<div class="stx_crosshair stx_crosshair_x" style="display: none;"></div>',crossY:'<div class="stx_crosshair stx_crosshair_y" style="display: none;"></div>',chartControls:'<div class="stx_chart_controls" style="display: none;">\n\t\t<div class="chartSize">\n\t\t\t<span class="stx-zoom-out" role="button" aria-label="Zoom Out"></span>\n\t\t\t<span class="stx-zoom-in" role="button" aria-label="Zoom In"></span>\n\t\t</div></div>',home:'<div class="stx_jump_today" role="button" aria-label="Home" style="display:none"><span></span></div>',floatDate:'<div class="stx-float-date" style="visibility: hidden;"></div>',handleTemplate:'<div class="stx-ico-handle" style="display: none;"><span></span></div> ',iconsTemplate:'<div class="stx-panel-control"><div class="stx-panel-title"></div><div class="stx-panel-legend"></div><div class="stx-btn-panel"><span class="stx-ico-up"></span></div><div class="stx-btn-panel"><span class="stx-ico-focus"></span></div><div class="stx-btn-panel"><span class="stx-ico-down"></span></div><div class="stx-btn-panel"><span class="stx-ico-edit"></span></div><div class="stx-btn-panel"><span class="stx-ico-close"></span></div></div>',baselineHandle:'<div class="stx-baseline-handle" style="display: none;"></div>',notificationTray:'<div class="stx_notification_tray"><template><div><span class="icon"></span><span class="message"></span></div></template></div>'},i.ChartEngine.prototype.registerChartControl=function(t,e,s){var n=this.controls;if(n&&n.chartControls&&!n.chartControls.querySelector("."+t)){var a=null,r=n.chartControls.querySelector(".stx-zoom-in");return r?((a=document.createElement("span")).ariaLabel=e,a.role="button",a.innerHTML='<div class="stx-tooltip" aria-hidden="true">'+e+"</div>",a.className="stx-chart-control-button "+t,r.parentNode.appendChild(a),s&&i.safeClickTouch(a,s,{keyboardClick:!0}),a):void 0}},i.ChartEngine.prototype.zoomOut=function(t,i){if(!this.runPrepend("zoomOut",arguments)){this.preferences.zoomOutSpeed?i=this.preferences.zoomOutSpeed:i||(i=1/.7),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var e=this;for(var s in this.charts){var n=this.charts[s],a=n.width*i/this.layout.candleWidth;!1===n.allowScrollFuture&&!1===n.allowScrollPast&&a>n.dataSet.length&&(a=n.dataSet.length);var r=this.chart.width/a;this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(h(n),this.layout.candleWidth,r,!1,this.ownerWindow)}}function h(t){return function(i){if(e.zoomSet(i,t),e.animations.zoom.hasCompleted){if(e.runAppend("zoomOut",arguments))return;e.changeOccurred("layout"),e.continuousZoom&&e.continuousZoom.execute(!0)}}}},i.ChartEngine.prototype.zoomIn=function(t,i){if(!this.runPrepend("zoomIn",arguments)){this.preferences.zoomInSpeed?i=this.preferences.zoomInSpeed:i||(i=.7),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var e=this;for(var s in this.charts){var n=this.charts[s],a=n.width*i/this.layout.candleWidth;n.maxTicks-a<1&&(a=n.maxTicks-1),a<this.minimumZoomTicks&&(a=this.minimumZoomTicks);var r=this.chart.width/a;this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(h(n),this.layout.candleWidth,r,!1,this.ownerWindow)}}function h(t){return function(i){if(e.zoomSet(i,t),e.animations.zoom.hasCompleted){if(e.runAppend("zoomIn",arguments))return;e.changeOccurred("layout"),e.continuousZoom&&e.continuousZoom.execute()}}}},i.ChartEngine.prototype.createCrosshairs=function(){if(!this.runPrepend("createCrosshairs",arguments)&&this.manageTouchAndMouse&&!this.mainSeriesRenderer.nonInteractive){var t=this.controls.crossX,i=this.controls.crossY;t&&(t.onmousedown||(t.onmousedown=function(t){return t.preventDefault&&t.preventDefault(),!1})),i&&(i.onmousedown||(i.onmousedown=function(t){return t.preventDefault&&t.preventDefault(),!1})),this.runAppend("createCrosshairs",arguments)}};let e=!1;i.ChartEngine.prototype.mousemoveinner=i.ChartEngine.prototype.mousemoveinner||function(t,i){e||console.error("interaction feature requires activating movement feature."),e=!0}})("undefined"!=typeof window?window:e.g)}}]);