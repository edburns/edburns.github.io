/*! For license information please see common-60a025ce.e927d800b8a5bdc17b13.js.LICENSE.txt */
"use strict";(self.webpackChunk_vzmi_finance_cosaic=self.webpackChunk_vzmi_finance_cosaic||[]).push([[7023],{1414:(e,t,a)=>{var i=a(4603);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l,o,u;l="undefined"!=typeof window?window:a.g,o=void 0!==i.mE?i.mE:l.CIQ,u=void 0!==i.vn?i.vn:l.timezoneJS,o.ChartEngine&&(o.ChartEngine.prototype.rightClickOverlay=function(e,t){if(!this.runPrepend("rightClickOverlay",arguments)){var a=this.overlays[e];a.editFunction?a.editFunction(t):this.removeOverlay(e),this.runAppend("rightClickOverlay",arguments)}},o.ChartEngine.prototype.addOverlay=function(e){this.runPrepend("addOverlay",arguments)||(this.overlays[e.name]=e,this.runAppend("addOverlay",arguments))},o.ChartEngine.prototype.removeOverlay=function(e){if(!this.runPrepend("removeOverlay",arguments)){var t=this.overlays[e];if(t){for(var a in this.overlays){var i=this.overlays[a],r=["Field"];o.Studies&&(r=o.Studies.getFieldInputs(i));for(var n=0;n<r.length;n++){var s=i.inputs[r[n]],l=t.inputs.Series;l&&"series"!==l&&(s=s.replace(" ["+l+"]","")),s in t.outputMap&&this.removeOverlay(i.name)}}this.cleanupRemovedStudy(t),this.panels[t.panel],delete this.overlays[e],this.checkForEmptyPanel(t.panel)}this.currentlyImporting||(this.displaySticky(),this.createDataSet(),this.changeOccurred("layout")),this.resetDynamicYAxis(),this.runAppend("removeOverlay",arguments)}},o.ChartEngine.prototype.cleanupRemovedStudy=function(e){if(!e)return;e.study.removeFN&&e.study.removeFN(this,e);for(let a in this.plugins)a.indexOf("{"+e.id+"}")>-1&&delete this.plugins[a];e.removeSignals&&e.removeSignals();for(let a in e.outputMap)this.getMarkerArray("field",a).forEach((e=>e.remove()));this.layout.studies&&delete this.layout.studies[e.name],this.chart.state.studies.sorted=null,delete this.overlays[e.name];const{sd:t}=this.repositioningAnchorSelector||{};if(t&&t===e){this.repositioningAnchorSelector=null;const{anchorHandles:t}=this.controls;t&&t[e.uniqueId]&&(t[e.uniqueId].highlighted=!1,o.Studies.displayAnchorHandleAndLine(this,e,this.chart.dataSegment))}o.Studies&&o.Studies.removeStudySymbols(e,this),this.quoteDriver&&this.quoteDriver.updateSubscriptions()},o.ChartEngine.prototype.getStudies=function(e){const{studies:t}=this.layout;var a=[];if(t)for(let i in t){const r=t[i];if(r.name===e.name||r.type===e.type)a.push(r);else{const{outputMap:t}=r;t&&t[e.output]&&a.push(r)}}return a}),o.Studies=o.Studies||function(){},o.Studies.DEFAULT_INPUTS={Period:14},o.Studies.DEFAULT_OUTPUTS={Result:"auto"},o.Studies.impliedVolatilityAvailable=!1,o.Studies.useTranslationDelimiter=!0,o.Studies.sortForProcessing=e=>{let t=[];const a=e.layout.studies;return a&&function t(a,i){a.forEach((a=>{if(-1==i.indexOf(a)){let r=a.getDependents(e);r.length&&t(r,i),i.unshift(a)}}))}(Object.values(a),t),t},o.Studies.getQuoteFieldValue=function(e,t,a="Close"){return o.ChartEngine.getQuoteFieldValue(e,t,a)},o.Studies.StudyDescriptor=function(e,t,a,i,r,n){this.name=e,this.disabled=!1,this.type=t,this.panel=a,this.inputs=i,this.outputs=r,this.parameters=n,this.outputMap={},this.min=null,this.max=null,this.startFrom=0,this.subField="Close";var s=o.Studies.studyLibrary[t];s||(s={},("chart"==a||!a&&n&&"chart"==n.chartName)&&(this.overlay=!0)),void 0===s.inputs&&(s.inputs=o.clone(o.Studies.DEFAULT_INPUTS)),void 0===s.outputs&&(s.outputs=o.clone(o.Studies.DEFAULT_OUTPUTS)),this.study=s,this.libraryEntry=s},o.Studies.StudyDescriptor.prototype.toggleDisabledState=function(e){let{disabled:t,study:a,signalData:i}=this;const{chart:r}=e;this.disabled=t=!t,t?r.customChart&&r.customChart.owner===this.name&&a.calculateFN(e,this):(this.startFrom=0,this.error=null,a&&a.calculateFN&&a.calculateFN(e,this),this.flagSignals&&this.flagSignals()),i&&i[t?"hide":"show"](),e.changeOccurred("layout"),e.draw()},o.Studies.StudyDescriptor.prototype.getYAxis=function(e){var t,a=this.yAxis;if(this.parameters&&(t=this.parameters.yAxis?this.parameters.yAxis.name:this.parameters.yaxisDisplayValue),!a){var i=e.panels[this.panel];if(i){var r=e.getYAxisByName(i,this.name);a=e.getYAxisByName(i,t)||t&&r||o.Studies.getFieldInputs(this).map((t=>e.getYAxisByField(i,this.inputs[t]))).filter((e=>e))[0]||r||i.yAxis}}return a||(a=e.getYAxisByName(e.chart.panel,t)||e.chart.panel.yAxis),a},o.Studies.StudyDescriptor.prototype.getContext=function(e){return e.chart.context},o.Studies.StudyDescriptor.prototype.getDependents=function(e,t){var a=[];for(var i in e.layout.studies){var r=e.layout.studies[i];if(r!=this)for(var n=o.Studies.getFieldInputs(r),s=0;s<n.length;s++){var l=r.inputs[n[s]].toLowerCase().replace(/\u200c/g,"").replace(/\[(.+)\]/g,"($1)"),u=this.name.toLowerCase().replace(/\u200c/g,"");if(l.includes(u)){if(t&&r.parameters&&r.parameters.panelName)continue;a.push(r),a=a.concat(r.getDependents(e,t));break}}}return a},o.Studies.StudyDescriptor.prototype.undraggable=function(e){if(this.signalData)return!0;var t=this.study.attributes;if(t){if(t.panelName&&t.panelName.hidden)return!0;if(t.yaxisDisplayValue&&t.yaxisDisplayValue.hidden)return!0}return!1},o.Studies.StudyDescriptor.prototype.appendFutureTicks=function(e,t){var a=e.chart.scrubbed;if(a.length){var i,r,n=e.standardMarketIterator(a[a.length-1].DT);for(i=t.length-1;i>=0;i--){for(var s in r=t[i])if(r[s]||0===r[s]){i=-1;break}if(-1==i)break;t.pop()}for(i=0;i<t.length;i++)(r=t[i]).DT||(r.DT=n.next()),r.displayDate||e.setDisplayDate(r),r.futureTick=!0,a.push(r)}},o.Studies.generateID=function(e,t,a,i,r){var n=o.Studies.studyLibrary[t],s=r||t;o.Studies.useTranslationDelimiter&&(s="‌"+s+"‌");var l=s;if(n&&n.customRemoval)return l;if(!o.isEmpty(a)){var u=!0;for(var d in a)if(!["id","display","Shading","Anchor Selector"].includes(d)){var p=a[d];"field"!=p&&("Series"!=d||"Primary"!=p&&"series"!=p)&&(p=p.toString(),void 0!==o.Studies.prettify[p]&&(p=o.Studies.prettify[p]),u?(u=!1,l+=" ("):p&&(l+=","),l+=p)}u||(l+=")")}if(i===l||i&&0===i.indexOf(l+"-"))return i;if(e.layout.studies&&e.layout.studies[l])for(var c=2;c<50;c++){var h=l+"-"+c;if(!e.layout.studies[h]){l=h;break}}return l},o.Studies.DialogHelper=function(e){const t=this.stx=e.stx;let a=this.sd=e.sd;this.name=a?a.type:e.name,this.signal=1,this.inputs=[],this.outputs=[],this.parameters=[];const i=this.libraryEntry=a?a.study:o.Studies.studyLibrary[e.name];void 0===i.inputs&&(i.inputs=o.clone(o.Studies.DEFAULT_INPUTS)),void 0===i.outputs&&(i.outputs=o.clone(o.Studies.DEFAULT_OUTPUTS));const r=a&&t.panels[a.panel]||t.chart.panel,s=r.chart;this.title=t.translateIf(i.name),this.attributes=o.clone(i.attributes),this.attributes||(this.attributes={});for(let n in this.attributes){const e=this.attributes[n];for(let t in e)"function"==typeof e[t]&&(e[t]=e[t].call(a||i))}function l(e,t){const a=this;a.attributes[e]||(a.attributes[e]={}),t&&(a.attributes[e].hidden=!0)}const u=[],d=t.layout.studies;let p=[];a&&(p=Array.prototype.concat(a,a.getDependents(t)));for(let n in d)if(!(d[n].signalData||p.indexOf(d[n])>-1))for(let e in d[n].outputMap){const t=o.Studies.useTranslationDelimiter?"‌":"";d[n].inputs.Series&&"series"!==d[n].inputs.Series&&(e=`${t}${e}${t} [${d[n].inputs.Series}]`),u.push(e)}for(let g in i.inputs){const e={};this.inputs.push(e),e.name=g,e.heading=t.translateIf(g);const r=i.inputs[g];if(a&&a.inputs&&void 0!==a.inputs[g]&&null!==a.inputs[g]?e.value=a.inputs[g]:e.value=i.inputs[g],e.defaultInput=i.inputs[g],this.attributes[g]||(this.attributes[g]=o.Studies.inputAttributeDefaultGenerator(e.defaultInput)),r.constructor==Number)e.type="number";else if(r.constructor==String){const a=o.Studies.movingAverageHelper(t,e.defaultInput);if(a){e.type="select",e.defaultInput=a;let i=o.Studies.movingAverageHelper(t,e.value);i||(i=e.value),e.value=i,e.options=o.Studies.movingAverageHelper(t,"options")}else if("field"==r){const a=t.chart.series,i=[];for(let e in a){const{parameters:t}=a[e];t&&t.isComparison&&i.push(e)}e.type="select",e.options={};const r=["Open","High","Low","Close","hl/2","hlc/3","hlcc/4","ohlc/4",s.defaultPlotField].concat(u,i);t.layout.adj&&r.splice(4,0,"Adj_Close");for(let n=0;n<r.length;n++){const a=r[n];e.options[a]=t.translateIf(a)}"field"==e.value&&(e.value="Close"),"field"==e.defaultInput&&(e.defaultInput="Close")}else"series"==r?(e.options=Object.keys(t.chart.series).reduce(((e,a)=>{const{display:i,parameters:r}=t.chart.series[a],s=(r||{}).symbol||a;return n(n({},e),{},{[s]:i||a})}),{Primary:"Primary"}),e.value&&"series"!==e.value&&"field"!==e.value||(e.value="Primary"),e.type="select","field"==e.defaultInput&&(e.defaultInput="Primary")):(e.type="text","yyyy-mm-dd"==this.attributes[g].placeholder?e.type="date":"hh:mm:ss"==this.attributes[g].placeholder&&(e.type="time"))}else if(r.constructor==Boolean)e.type="checkbox",!0!==e.value&&"true"!=e.value&&"on"!=e.value||(e.value=!0);else if(r.constructor==Array){e.type="select",e.options={};for(let a=0;a<r.length;a++)e.options[r[a]]=t.translateIf(r[a]);e.value.constructor==Array&&(e.value=e.value[0]),this.attributes[g].defaultSelected?e.defaultInput=this.attributes[g].defaultSelected:e.defaultInput=r[0]}}this.dateTimeInputs=[];for(let n=0;n<this.inputs.length;n++){const e=this.inputs[n];if("date"==e.type){const t=e.name.substring(0,e.name.indexOf(" Date"));for(let e=0;e<this.inputs.length;e++){const a=this.inputs[e];if("time"==a.type&&a.name==t+" Time"){this.dateTimeInputs.push(t);break}}}}this.adjustInputTimesForDisplayZone();for(let n in i.outputs){const e={name:n,heading:t.translateIf(n)};e.color=e.defaultOutput=i.outputs[n],a&&a.outputs&&a.outputs[n]&&(e.color=a.outputs[n]),"auto"==e.color&&(e.color=t.defaultColor,e.isAuto=!0),this.outputs.push(e)}const c=a?a.parameters:null;if(i.parameters){const e=i.parameters.init;if(e){let a;void 0!==e.studyOverZonesEnabled&&(a={name:"studyOverZones",heading:t.translateIf("Show Zones"),defaultValue:e.studyOverZonesEnabled,value:e.studyOverZonesEnabled},c&&(c.studyOverZonesEnabled||!1===c.studyOverZonesEnabled)&&(a.value=c.studyOverZonesEnabled),a.type="checkbox",this.parameters.push(a)),void 0!==e.studyOverBoughtValue&&(a={name:"studyOverBought",heading:t.translateIf("OverBought"),defaultValue:e.studyOverBoughtValue,value:e.studyOverBoughtValue,defaultColor:e.studyOverBoughtColor,color:e.studyOverBoughtColor},c&&c.studyOverBoughtValue&&(a.value=c.studyOverBoughtValue),c&&c.studyOverBoughtColor&&(a.color=c.studyOverBoughtColor),"auto"==a.color&&(a.color=t.defaultColor,a.isAuto=!0),a.type="text",this.parameters.push(a)),void 0!==e.studyOverSoldValue&&(a={name:"studyOverSold",heading:t.translateIf("OverSold"),defaultValue:e.studyOverSoldValue,value:e.studyOverSoldValue,defaultColor:e.studyOverSoldColor,color:e.studyOverSoldColor},c&&c.studyOverSoldValue&&(a.value=c.studyOverSoldValue),c&&c.studyOverSoldColor&&(a.color=c.studyOverSoldColor),"auto"==a.color&&(a.color=t.defaultColor,a.isAuto=!0),a.type="text",this.parameters.push(a)),this.attributes.studyOverBoughtValue||(this.attributes.studyOverBoughtValue={}),this.attributes.studyOverSoldValue||(this.attributes.studyOverSoldValue={})}}function h(e){const a={},i=e.defaults,r={name:e.name,heading:t.translateIf(e.label),defaultValue:i[0],value:e.value,options:a,type:"select"};for(let n=0;n<i.length;n++)a[i[n]]=t.translateIf(i[n]);return void 0!==e.color&&(r.defaultColor=t.defaultColor,r.color=e.color),r}function y(e){return{name:e.name,heading:t.translateIf(e.label),defaultValue:e.defaults,value:e.value,type:"checkbox"}}let m=this.panelSelect=e.panelSelect,f=this.axisSelect=e.axisSelect;function v(e){function a(e,t){return"Panel "+t.toString()}if("alias"==m){let i=1;for(let r in t.panels){if(r==e)return a(0,i);i++}}return e}if(e.addWhenDone&&(f=m=!1),f||m){a||(a=o.Studies.addStudy(t,e.name,null,null,{calculateOnly:!0}),o.Studies.removeStudy(t,a)),m&&this.parameters.push(h({label:"Panel",name:"panelName",defaults:function(){const e=[];e.push("Auto");for(let i in t.panels)i==a.panel&&c&&c.panelName||t.panels[i].noDrag||e.push(v(i));return t.checkForEmptyPanel(a.panel,!0,a)||e.push("New panel"),e}(),value:c&&c.panelName?v(c.panelName):"Auto"}),y({label:"Show as Underlay",name:"underlay",defaults:!1,value:a.underlay||a.parameters&&a.parameters.underlayEnabled}));const n=t.getYAxisByName(r,a.name);f&&this.parameters.push(h({label:"Y-Axis",name:"yaxisDisplay",defaults:function(){const e=r.yaxisLHS.concat(r.yaxisRHS),t=[];t.push("default","right","left","none","shared");for(let a=0;a<e.length;a++)e[a]!=n&&t.push(e[a].name);return t}(),value:c&&c.yaxisDisplayValue||n&&n.position||(n?"default":"shared"),color:n&&n.textStyle||"auto"}),y({label:"Invert Y-Axis",name:"flipped",defaults:!1,value:c&&void 0!==c.flippedEnabled?c.flippedEnabled:!!n&&n.flipped})),l.call(this,"flippedEnabled",!n&&a.panel!=a.name),l.call(this,"underlayEnabled",i.underlay),l.call(this,"panelName",null===i.seriesFN),l.call(this,"yaxisDisplayValue",null===i.seriesFN||i.yAxis&&i.yAxis.noDraw)}},o.Studies.DialogHelper.prototype.updateStudy=function(e){var t={},a=this.sd,i=this.libraryEntry;i||(i={}),a||(a=i),t.inputs=o.clone(a.inputs),t.outputs=o.clone(a.outputs),t.parameters=o.clone(a.parameters),this.adjustInputTimesForDisplayZone(e),e.parameters&&e.parameters.panelName&&(e.parameters.panelName=function(e){if("alias"==this.panelSelect){var t=function(e){var t=e.match(/.{0,50} (\d)/);return t&&t[1]}(e);if(t)for(var a in this.stx.panels)if(! --t)return a}return e}.call(this,e.parameters.panelName)),o.extend(t,e),t.parameters||(t.parameters={}),a=t.inputs&&t.inputs.id?o.Studies.replaceStudy(this.stx,t.inputs.id,this.name,t.inputs,t.outputs,t.parameters,null,a.study):o.Studies.addStudy(this.stx,this.name,t.inputs,t.outputs,t.parameters,null,a.study);var r=new o.Studies.DialogHelper({stx:this.stx,sd:a,axisSelect:this.axisSelect,panelSelect:this.panelSelect});for(var n in r)"signal"!=n&&(this[n]=r[n]);this.signal*=-1},o.Studies.DialogHelper.prototype.adjustInputTimesForDisplayZone=function(e){if(this.stx.displayZone)for(var t=0;t<this.dateTimeInputs.length;t++){var a,i,r,n,s=this.dateTimeInputs[t],l="";for(e&&e.inputs&&((i=e.inputs[s+" Date"])&&(l=i),(r=e.inputs[s+" Time"])&&(l+=r)),a=0;a<this.inputs.length;a++)n=this.inputs[a],i||""===i||n.name!=s+" Date"?r||""===r||n.name!=s+" Time"||(l+=n.value):l=n.value+l;if((l=l.replace(/\D/g,"")).length<12)return;var u,d=o.strToDateTime(l);if(!isNaN(d.valueOf()))if(e)e.inputs||(e.inputs={}),u=o.convertTimeZone(d,this.stx.displayZone),e.inputs[s+" Date"]=o.yyyymmdd(u),e.inputs[s+" Time"]=o.hhmmss(u);else for(u=o.convertTimeZone(d,null,this.stx.displayZone),a=0;a<this.inputs.length;a++)(n=this.inputs[a]).name==s+" Date"&&(n.value=o.yyyymmdd(u)),n.name==s+" Time"&&(n.value=o.hhmmss(u))}},o.Studies.prepareStudy=function(e,t,a){if(void 0===t.calculateFN&&(t.useRawValues=!0),o.isEmpty(a.outputMap))for(var i in a.outputs)t.useRawValues?a.outputMap[i]=i:a.outputMap[i+" "+a.name]=i},o.Studies.rejiggerDerivedStudies=function(e,t,a){for(var i=t.name,r=(t.panel,t.getDependents(e)),n=0;n<r.length;n++){var s=r[n],l=o.clone(s.inputs),u=l.id;if(u){for(var d=o.Studies.getFieldInputs(s),p=0;p<d.length;p++)l[d[p]]=l[d[p]].replace(i,a);delete o.Studies.replaceStudy(e,u,s.type,l,s.outputs,o.extend(s.parameters,{rejiggering:!0}),null,s.study).parameters.rejiggering}}},o.Studies.removeStudySymbols=function(e,t){if(e.series)for(var a in e.series)t.deleteSeries(e.series[a],null,{action:"remove-study"})},o.Studies.replaceStudy=function(e,t,a,i,r,n,s,l){n||(n={}),t&&(n.replaceID=t),t=n.replaceID;var u,d=e.layout.studies[t];o.Studies.removeStudySymbols(d,e),d.attribution&&e.removeFromHolder(d.attribution.marker),e.quoteDriver&&e.quoteDriver.updateSubscriptions(),i&&(i.id==i.display&&delete i.display,delete i.id),(u=o.Studies.addStudy(e,a,i,r,n,s,l)).highlight=d.highlight,u.uniqueId=d.uniqueId,d.signalData&&(u.signalData=d.signalData,u.signalData.updateConditions&&u.signalData.updateConditions(t,u.inputs.id));var p,c={};for(p in e.layout.studies)p==t?c[u.name]=u:c[p]=e.layout.studies[p];for(p in e.layout.studies=c,c={},e.overlays)p==t?(u.overlay||u.underlay)&&(c[u.name]=u):c[p]=e.overlays[p];e.overlays=c,e.overlays[u.name]||!u.overlay&&!u.underlay||e.addOverlay(u);var h=Object.keys(d.outputMap),y=Object.keys(u.outputMap);d.panel!==u.panel&&h.forEach((function(t){e.moveMarkers(d.panel,u.panel,e.getMarkerArray("field",t))})),e.getMarkerArray("panelName",d.panel).forEach((function(e,t){h.indexOf(e.params.field)>-1&&-1===y.indexOf(e.params.field)&&(e.params.field=y[t])})),e.checkForEmptyPanel(d.panel),n.rejiggering||(e.initializeDisplay(e.chart),o.Studies.rejiggerDerivedStudies(e,d,u.inputs.id,u.panel));var m={outputMap:o.clone(d.outputMap),panel:d.panel};o.transferObject(d,u),e.layout.studies[u.name]=d,e.overlays[u.name]=d,e.chart.state.studies.sorted=null;var f=!1;for(var v in e.drawingObjects){var g=e.drawingObjects[v];m.outputMap&&m.outputMap.hasOwnProperty(g.field)?(g.field=g.field.replace(t,d.inputs.id),d.parameters&&d.parameters.panelName?g.panelName=d.parameters.panelName:g.panelName=d.panel,f=!0):m.panel&&m.panel==g.panelName&&(g.panelName=g.panelName.replace(t,d.inputs.id),f=!0)}return f&&e.changeOccurred("vector"),n.rejiggering||(d.currentlyImporting||n.calculateOnly||!d.chart.dataSet||e.createDataSet(null,d.chart),e.changeOccurred("layout"),e.drawWithRange()),d},o.Studies.addStudy=function(e,t,a,i,r,n,s){var l=s||o.Studies.studyLibrary[t];if(r||(r={}),l){if(l.inputs){var u=o.clone(l.inputs);for(var d in u)u[d]instanceof Array&&(l.attributes&&l.attributes[d]&&l.attributes[d].defaultSelected?u[d]=l.attributes[d].defaultSelected:u[d]=u[d][0]);a=o.extend(u,a)}l.outputs&&(i=o.extend(o.clone(l.outputs),i));var p=l.parameters;p&&p.init&&(r=o.extend(o.clone(p.init),r)),p&&!r.display&&(r.display=p.display)}a||(a=o.clone(o.Studies.DEFAULT_INPUTS)),i||(i=o.clone(o.Studies.DEFAULT_OUTPUTS)),r.chartName||(r.chartName="chart"),"Auto"!=r.panelName&&"Default panel"!=r.panelName||(r.panelName=""),a.Period<1&&(a.Period=1);var c=null;if(e.layout.studies||(e.layout.studies={}),c=l&&l.initializeFN?l.initializeFN(e,t,a,i,r,n,s):o.Studies.initializeFN(e,t,a,i,r,n,s)){if("abort"!==c){s=c.study,c.chart=e.charts[r.chartName],c.type=t,c.permanent=s.permanent,c.customLegend=s.customLegend,c.uniqueId=o.uniqueID(),o.Studies.prepareStudy(e,s,c);var h,y=e.chart.state.studies;if(y||(y=e.chart.state.studies={}),y.sorted=null,r.replaceID?(h=!0,delete r.replaceID):(e.layout.studies[c.inputs.id]=c,(c.overlay||c.underlay)&&e.addOverlay(c),e.currentlyImporting||r.calculateOnly||!c.chart.dataSet||e.createDataSet(null,c.chart)),e.quoteDriver&&e.quoteDriver.updateSubscriptions(),r.calculateOnly)return e.changeOccurred("layout"),c;var m=e.panels[c.panel],f=!1,v=!(c.overlay||c.underlay);if(v&&s.horizontalCrosshairFieldFN&&(m.horizontalCrosshairField=s.horizontalCrosshairFieldFN(e,c)),e.editCallback?f=!0:v?e.callbackListeners.studyPanelEdit&&e.callbackListeners.studyPanelEdit.length&&(f=!0):e.callbackListeners.studyOverlayEdit&&e.callbackListeners.studyOverlayEdit.length&&(f=!0),f){r.editMode=!0;var g,S=!1;for(var x in c.inputs)if("id"!=x&&"display"!=x){S=!0;break}if(!S)for(var b in c.outputs){S=!0;break}S&&(void 0!==c.study.edit?c.study.edit&&(g=function(e,t,a,i,r){return function(){o.clearCanvas(e.chart.tempCanvas,e),t.study.edit(t,{stx:e,inputs:a,outputs:i,parameters:r})}}(e,c,a,i,r),e.setPanelEdit(m,g),c.editFunction=g):v?e.editCallback?(g=function(e,a,i,r,n){return function(){var s=e.editCallback(e,a);o.clearCanvas(e.chart.tempCanvas,e),o.Studies.studyDialog(e,t,s,{inputs:i,outputs:r,parameters:n})}}(e,c,a,i,r),"chart"!=m.name&&e.setPanelEdit(m,g)):(g=function(e,t,a,i,r){return function(){o.clearCanvas(e.chart.tempCanvas,e),e.dispatch("studyPanelEdit",{stx:e,sd:t,inputs:a,outputs:i,parameters:r})}}(e,c,a,i,r),"chart"!=m.name&&(e.setPanelEdit(m,g),c.editFunction=g)):(g=function(e,t,a,i,r){return function(n){o.clearCanvas(e.chart.tempCanvas,e),e.dispatch("studyOverlayEdit",{stx:e,sd:t,inputs:a,outputs:i,parameters:r,forceEdit:n})}}(e,c,a,i,r),c.editFunction=g))}return e.changeOccurred("layout"),h||e.drawWithRange(),c}}else console.log("CIQ.Studies.addStudy: initializeFN() returned null for "+t)},o.Studies.removeStudy=function(e,t){var a=e.panels[t.panel],i=a&&a.yAxis.name;(t.overlay||t.underlay)&&e.removeOverlay(t.name);var r=e.panels[t.panel];if(t.attribution&&e.removeFromHolder(t.attribution.marker),e.cleanupRemovedStudy(t),r&&!e.checkForEmptyPanel(r)){i==t.name&&e.electNewPanelOwner(r);var n=e.getYAxisByName(t.panel,t.name);n&&(n.name=n.studies[1]||n.renderers[0])}e.drawWithRange(),e.resizeChart()},o.Studies.getPanelFromFieldName=function(e,t){var a=o.Studies.getFieldInputs(t);if(!a.length)return null;var i=e.layout.studies;if(!i)return null;var r={};for(var n in i)for(var s in i[n].outputMap){var l=i[n].inputs.Series;l&&"series"!==l&&(s+=" ["+l+"]"),r[s.replace(/\u200c/g,"")]=i[n].panel}for(var u in e.chart.series)r[u]=e.chart.series[u].parameters.panel;for(var d=0;d<a.length;d++){var p=t.inputs[a[d]];if(p){var c=r[p.replace(/\u200c/g,"")];if(c)return c}}return null},o.Studies.createLibraryHash=function(){return Object.keys(o.Studies.studyLibrary).join("|")},o.Studies.displayStudies=function(e,t,a){a&&(t.studyLibraryHash=o.Studies.createLibraryHash());var i=e.layout.studies;if(i){var r={};for(var n in r[t.name]=!0,i){var s=i[n],l=s.study;if(l&&!(s.disabled||s.signalData&&!s.signalData.reveal)){var u=s.underlay||s.parameters&&s.parameters.underlayEnabled;if(!(a&&!u||!a&&u)){var d=o.clone(l.renderer);!d||d instanceof Array||(d=[d]);var p=e.panels[s.panel];if(p){if(p.chart==t&&!p.hidden){if(!r[p.name]){var c=s.permanent||!e.manageTouchAndMouse;p.closeX?c&&(p.closeX.style.display="none"):p.close&&c&&(p.close.style.display="none"),p.edit&&c&&(p.edit.style.display="none"),r[p.name]=c}var h=s.chart.dataSegment;if(!(s.panel!=s.parameters.chartName||s.parameters&&s.parameters.panelName)){var y=o.Studies.getPanelFromFieldName(e,s);y&&s.panel!=y&&(s.panel=y)}if(void 0===l.seriesFN){if(d){s.overlay||o.Studies.createYAxis(e,s,h,p);for(var m=0;m<d.length;m++){var f=d[m];for(var v in s.outputMap)s.outputMap[v]==f.field&&(f.field=v);if(f.field){f.panel=s.panel;var g=f.binding;if(g)for(var S in g){var x=o.Studies.determineColor(s.outputs[g[S]]);x&&"auto"!=x&&(f[S]=x)}f.yAxis=null;var b=o.Renderer.produce(f.type,f);b.stx=e,b.attachSeries(null,f).draw()}}}else o.Studies.displaySeriesAsLine(e,s,h);p&&o.Studies.displayError(e,s)}else p&&(l.seriesFN&&l.seriesFN(e,s,h),o.Studies.displayError(e,s));var A=Object.values(s.outputs).slice(0,3).map(D);e.chart.legendColorMap[s.name]={color:A,display:s.name,components:Object.keys(s.outputs).slice(0,3)}}}else e.currentlyImporting&&delete i[n]}}}}function D(t){var a=t.color||t;return"auto"===a?e.defaultColor:a}},o.Studies.displayError=function(e,t,a){if(t.error){var i=a&&a.panel?a.panel:t.panel,r=!0===t.error?e.translateIf("Not enough data to compute ")+e.translateIf(t.study.name):e.translateIf(t.error);!a||"center"===a.h&&"bottom"===a.v?e.displayErrorAsWatermark(i,r):e.watermark(i,a)}},o.Studies.calculateMinMaxForDataPoint=function(e,t,a){for(var i=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,n=0;n<a.length;n++){var s=a[n][t];null!=s&&(isNaN(s)||(i=Math.min(s,i),r=Math.max(s,r)))}return{min:i,max:r}},o.Studies.getYAxisParameters=function(e,t){var a={},i=e.layout.studies&&e.layout.studies[t.name];if(i){var r=i.study;r.yaxis||r.yAxisFN?a.noDraw=!0:(r.parameters&&r.parameters.excludeYAxis&&(a.noDraw=!0),a.ground=r.yAxis&&r.yAxis.ground,t&&("bypass"!=r.range&&("0 to 100"==r.range?a.range=[0,100]:"-1 to 1"==r.range?a.range=[-1,1]:"0 to max"==r.range?a.range=[0,Math.max(0,t.high)]:(r.centerline||0===r.centerline)&&(a.range=[Math.min(r.centerline,t.low),Math.max(r.centerline,t.high)])),a.range&&(t.low=a.range[0],t.high=a.range[1]),i.min&&(t.min=i.min),i.max&&(t.max=i.max),i.parameters&&i.parameters.studyOverZonesEnabled&&(a.noDraw=!0)))}return a},o.Studies.doPostDrawYAxis=function(e,t){for(var a in e.layout.studies){var i=e.layout.studies[a],r=e.panels[i.panel];if(r&&!r.hidden&&i.getYAxis(e)==t){var n=i.study;if(t.name==i.name&&(n.yaxis&&n.yaxis(e,i),n.yAxisFN&&n.yAxisFN(e,i)),o.Studies.drawZones(e,i),!i.error){var s=n.centerline;(s||0===s||null!==s&&t.highValue-1e-12>0&&t.lowValue+1e-12<0)&&o.Studies.drawHorizontal(e,i,null,s||0,t)}}}},o.Studies.displaySeriesAsLine=function(e,t,a){if(a.length){var i=e.panels[t.panel];if(i&&!i.hidden)for(var r in t.outputMap)o.Studies.displayIndividualSeriesAsLine(e,t,i,r,a)}},o.Studies.displaySeriesAsHistogram=function(e,t,a){if(a.length){var i=e.panels[t.panel];if(i&&!i.hidden){var r=[];for(var n in t.outputMap){var s=t.outputs[t.outputMap[n]];if(s){var l=.3;"object"==typeof s&&(l=s.opacity,s=s.color);var o={field:n,fill_color_up:s,border_color_up:s,fill_color_down:s,border_color_down:s};t.underlay&&(o.opacity_up=o.opacity_down=l||.3),r.push(o)}}var u=t.getYAxis(e),d=t.inputs,p=d.WidthFactor;if(t.study&&t.study.parameters){var c=t.study.parameters;void 0!==c.widthFactor&&(p=c.widthFactor)}var h={name:t.name,type:d.HistogramType?d.HistogramType:"overlaid",panel:t.panel,yAxis:u,widthFactor:p||.5,bindToYAxis:!0,highlight:t.highlight};e.drawHistogram(h,r)}}},o.Studies.displayIndividualSeriesAsLine=function(e,t,a,i,r){a.height||(a.height=a.bottom-a.top);var n=t.getContext(e),s=t.outputs[t.outputMap[i]];if(s){n.save(),"string"==typeof s&&(s={color:s,width:1}),n.lineWidth=s.width||1;var l=s.color;"auto"==l&&(l=e.defaultColor),n.strokeStyle=l;var u=s.pattern;n.setLineDash(o.borderPatternToArray(n.lineWidth,u)),n.lineDashOffset=0;var d=0,p=t.study,c=t.getYAxis(e);d=e.decimalPlacesFromPriceTick(c.priceTick,c.idealTickSizePixels),(t.overlay||t.underlay)&&(d=null),(c.decimalPlaces||0===c.decimalPlaces)&&(d=c.decimalPlaces);var h=null;t.parameters&&(h=t.parameters.label);var y=p.parameters;y||(y={});var m="step"==y.plotType;if(t.series)for(var f in t.series){var v=t.series[f].parameters.type;v&&(m="step"==v)}y.noLabels&&(h=!1),t.noSlopes||!1===t.noSlopes||(t.noSlopes=y.noSlopes),t.extendToEnd||!1===t.extendToEnd||(t.extendToEnd=y.extendToEnd);var g=h||e.preferences.labels&&!1!==h,S=t.gaplines;!1===S&&(S="transparent");var x=t.inputs.Symbol,b=S?e.getGapColorFunction(x,i,s,S):null;e.plotDataSegmentAsLine(i,a,{yAxis:c,skipTransform:e.panels[t.panel].name!=t.chart.name,label:g,labelDecimalPlaces:d,noSlopes:t.noSlopes,step:m,alignStepToSide:t.alignStepToSide,extendToEndOfLastBar:t.extendToEndOfLastBar,width:t.lineWidth,extendToEndOfDataSet:t.extendToEnd,gapDisplayStyle:S,highlight:t.highlight},b),p.appendDisplaySeriesAsLine&&p.appendDisplaySeriesAsLine(e,t,r,i,a),n.restore()}},o.Studies.drawHorizontal=function(e,t,a,i,r,n){var s=e.panels[t.panel],l=e.getBackgroundCanvas().context;if(s){n||(n=r.textStyle);var o=e.pixelFromPrice(i,s,r);o>r.top&&o<r.bottom&&e.plotLine(s.left,s.right,o,o,n,"segment",l,!1,{opacity:n&&n.opacity?n.opacity:.5})}},o.Studies.displayHistogramWithSeries=function(e,t,a){e.panels[t.panel];var i=.5;t.underlay&&(i=.3),o.Studies.createHistogram(e,t,a,!1,i),o.Studies.displaySeriesAsLine(e,t,a)},o.Studies.drawZones=function(e,t,a){if(t.parameters&&t.parameters.studyOverZonesEnabled){var i=parseFloat(t.parameters.studyOverSoldValue),r=parseFloat(t.parameters.studyOverBoughtValue),n=t.parameters.studyOverSoldColor,s=t.parameters.studyOverBoughtColor,l=t.zoneOutput;l||(l="Result");var u=o.Studies.determineColor(t.outputs[l]);u&&"auto"!=u&&!o.isTransparent(u)||(u=e.defaultColor),n||(n=u),n&&"auto"!=n&&!o.isTransparent(n)||(n=e.defaultColor),s||(s=u),s&&"auto"!=s&&!o.isTransparent(s)||(s=e.defaultColor);var d=e.panels[t.panel],p=t.getYAxis(e),c=p.displayBorder;!1===e.axisBorders&&(c=!1),!0===e.axisBorders&&(c=!0),0===p.width&&(c=!1);var h="left"==e.getYAxisCurrentPosition(p,d),y=p.justifyRight;y||!1===y||(y=e.chart.yAxis.justifyRight||!1===e.chart.yAxis.justifyRight?e.chart.yAxis.justifyRight:h);var m=Math.round(p.left+(h?p.width:0))+.5,f=c?3:0;h&&(f=c?-3:0);var v=e.getBackgroundCanvas().context,g=v.fillStyle;v.globalAlpha=.2,e.startClip(d.name,!0),v.beginPath();var S=Math.round(e.pixelFromPrice(r,d,p))-.5;v.strokeStyle=s,v.moveTo(d.left,S),v.lineTo(d.right,S),v.stroke(),v.closePath(),v.beginPath();var x=Math.round(e.pixelFromPrice(i,d,p))+.5;v.strokeStyle=n,v.moveTo(d.left,x),v.lineTo(d.right,x),v.stroke(),v.closePath();var b=new o.Plotter;if(b.newSeries("border","stroke",e.canvasStyle("stx_grid_border")),c){var A=h?m+f:m-.5,D=h?m+.5:m+f;b.moveTo("border",A,S),b.lineTo("border",D,S),b.moveTo("border",A,x),b.lineTo("border",D,x)}v.fillStyle=g;var F={skipTransform:e.panels[t.panel].name!=t.chart.name,panelName:t.panel,band:l+" "+t.name,yAxis:p,opacity:.3};if(!t.highlight&&e.highlightedDraggable&&(F.opacity*=.3),o.preparePeakValleyFill(e,o.extend(F,{threshold:r,direction:p.flipped?-1:1,color:s})),o.preparePeakValleyFill(e,o.extend(F,{threshold:i,direction:p.flipped?1:-1,color:n})),v.globalAlpha=1,!t.study||!t.study.yaxis){if(c){var T=Math.round(p.bottom)+.5;b.moveTo("border",m,p.top),b.lineTo("border",m,T),b.draw(v,"border")}var w,O=t.chart.dynamicYAxis;[r,i].forEach((function(a){var i=a+" ",r=O&&Math.max(p._width,t.chart.context.measureText(i).width+Math.abs(f)+3);if(O&&r>(p._dynamicWidth||p._width))throw p._dynamicWidth=r,e.calculateYAxisPositions(),e.endClip(),new Error("reboot draw");if(!O&&p._dynamicWidth)throw e.resetDynamicYAxis(),e.endClip(),new Error("reboot draw")}));var C=p.getTitleEnabled&&p.getTitleEnabled();if(0!==p.width){e.canvasFont("stx_yaxis",v),e.canvasColor("stx_yaxis",v),v.textAlign=y?"right":"left";var M=e.getCanvasFontSize("stx_yaxis")/2;C&&(p.fontHeight=2*M),h?(w=p.left+3,y&&(w=p.left+p.width+f-3)):(w=p.left+f+3,y&&(w=p.left+p.width)),S>p.top+M&&(v.fillStyle=s,v.fillText(r,w,S)),x<p.bottom-M&&(v.fillStyle=n,v.fillText(i,w,x)),v.fillStyle=g}if(C){var N=p.textStyle||"stx_yaxis";b.newSeries("text","fill",e.colorOrStyle(N)),e.drawTitleText(d,p,b,w),b.draw(e.getBackgroundCanvas(e.chart).context,"text")}}e.endClip(),v.globalAlpha=1,p.name==t.name&&(p.yAxisPlotter=new o.Plotter)}},o.Studies.createHistogram=function(e,t,a,i,r){var n=e.panels[t.panel],s=t.getContext(e),l=t.getYAxis(e);e.startClip(n.name);var u=e.layout.candleWidth-2;u<2&&(u=1);var d=e.pixelFromPrice(0,n,l);l.min>0&&(d=e.pixelFromPrice(l.min,n,l)),i&&(d=Math.floor(n.top+n.height/2));var p=t.name+"_hist";e.canvasColor("stx_histogram");var c=s.fillStyle;(r||0===r)&&(s.globalAlpha=r),!t.highlight&&e.highlightedDraggable&&(s.globalAlpha*=.3);for(var h=null,y=null,m=t.outputs,f=0;f<a.length;f++){var v=0,g=a[f];if(g){if("stretch"===e.cleanupGaps)for(;a[f+1];){var S=a[f+1][p];if(S||0===S||a[f+1].futureTick)break;v++,f++}g.candleWidth&&(u=Math.floor(Math.max(1,g.candleWidth-2)));var x=Math.floor(e.pixelFromBar(f-v,n.chart)-u/2),b=Math.floor(u+v*e.layout.candleWidth);if(null===h){var A=e.tickFromPixel(x,n.chart)-1;h=A<0?y:e.pixelFromPrice(e.chart.dataSet[A][p],n,l)-d}else h=y;y=e.pixelFromPrice(g[p],n,l)-d;var D=o.Studies.determineColor(m["Decreasing Bar"]),F=o.Studies.determineColor(m["Increasing Bar"]),T=o.Studies.determineColor(m["Positive Bar"]),w=o.Studies.determineColor(m["Negative Bar"]),O=l.flipped;s.fillStyle=c,D&&(O?y<h:y>h)?s.fillStyle=D:F&&(O?y>h:y<h)?s.fillStyle=F:T&&(O?y>0:y<0)?s.fillStyle=T:w&&(O?y<0:y>0)&&(s.fillStyle=w),s.fillRect(x,d,b,Math.floor(y))}}s.globalAlpha=1,e.endClip()},o.Studies.prettify={Close:"C",Open:"O",High:"H",Low:"L",simple:"ma",exponential:"ema",triangular:"tma",VIDYA:"vdma",weighted:"wma","welles wilder":"smma",true:"y",false:"n"},o.Studies.prettyRE=/^.{0,50}\((.{0,50})\).{0,50}$/,o.Studies.prettyDisplay=function(e){var t=o.Studies.prettyRE.exec(e);if(!t)return e;var a=t[1];if(a){for(var i in o.Studies.prettify)a=a.replace(i,o.Studies.prettify[i]);e=e.replace(t[1],a)}return e},o.Studies.getFieldInputs=function(e){var t=[],a=e.study.inputs;for(var i in a)["field","series"].includes(a[i])&&t.push(i);return t},o.Studies.initializeFN=function(e,t,a,i,r,n,s){a||(a={}),r||(r={}),a.id||(a.id=o.Studies.generateID(e,t,a,r.replaceID,r.display)),a.display||(a.display=a.id);var l=new o.Studies.StudyDescriptor(a.id,t,a.id,a,i,r);a.Period&&(l.days=Math.max(1,parseInt(l.inputs.Period,10))),s?(s.inputs||(s.inputs=l.study.inputs),s.outputs||(s.outputs=l.study.outputs),l.study=s):s=l.study,s.display&&(a.display=s.display),"string"==typeof r.panelName&&(n=r.panelName),(n==a.id||n&&!e.panelExists(n))&&(l.underlay=l.overlay=!1),"Own panel"!=n&&"New panel"!=n||(n=null);var u=l.overlay||a.Overlay||!1!==l.overlay&&s.overlay,d=l.underlay||a.Underlay||!1!==l.underlay&&s.underlay;u&&r.underlayEnabled&&(d=!0),d&&(l.underlay=!0),!d&&e.chart.panel&&n==e.chart.panel.name&&(u=!0),u&&(l.overlay=!0);var p=e.preferences.dragging;if((!0===p||p&&p.study)&&(l.overlay=!0),n?r.panelName=n:u||d||(n=a.id),r.calculateOnly)return(u||d)&&(e.panels[r.panelName]?l.panel=r.panelName:l.panel=o.Studies.getPanelFromFieldName(e,l)||r.chartName),l;if(l.panel="",n){var c=o.Studies.smartMovePanel(e,l.inputs,n,r.replaceID,"New panel"==r.panelName);c&&(l.panel=c.name),!r.yaxisDisplayValue||["left","right","none","shared","default"].includes(r.yaxisDisplayValue)||e.getYAxisByName(c,r.yaxisDisplayValue)||(r.yaxisDisplayValue="default")}else(u||d)&&(l.panel=o.Studies.getPanelFromFieldName(e,l)||r.chartName);if(!l.panel){var h=s.panelHeight||null,y=r.yAxis||s.yAxis||{};y.name=l.inputs.id,l.panel=l.inputs.id,e.createPanel(l.inputs.display,l.panel,h,r.chartName,new o.ChartEngine.YAxis(y))}l.parameters&&l.parameters.panelName&&(l.parameters.panelName=l.panel);var m=e.panels[l.panel],f=s?o.clone(s.yAxis):null,v=r.yAxis||f;(v||{}).ground&&(v["initialMargin"+(v.flipped?"Top":"Bottom")]=0);var g=o.Studies.smartCreateYAxis(e,m,l.inputs.id,r.yaxisDisplayValue,v,o.Studies.getFieldInputs(l).map((function(e){return l.inputs[e]})).filter((function(e){return!["field","series"].includes(e)})));return g&&(g.name==r.replaceID&&(g.name=l.inputs.id),r.replaceID||g.name!==l.name||e.calculateYAxisMargins(g),g.allowSharing=!r.yAxis&&!s.yAxis,g.width="none"==g.position?0:o.ChartEngine.YAxis.prototype.width,"shared"==r.yaxisDisplayValue||"default"==r.yaxisDisplayValue?delete r.yaxisDisplayValue:(f&&o.ensureDefaults(g,f),g.name==l.name&&(!(f||{}).textStyle&&!r.yaxisDisplayColor||"auto"==r.yaxisDisplayColor?delete g.textStyle:r.yaxisDisplayColor&&(g.textStyle=o.colorToHex(r.yaxisDisplayColor)),void 0===(f||{}).justifyRight&&(g.justifyRight=null),void 0!==r.flippedEnabled&&(g.flipped=r.flippedEnabled))),g!=m.yAxis?g.displayGridLines=!1:g!=e.chart.yAxis&&(g.displayGridLines=e.displayGridLinesInStudies)),e.resetDynamicYAxis(),e.calculateYAxisPositions(),l},o.Studies.smartMovePanel=function(e,t,a,i,r){var n,s=t.id;if(i&&(n=e.layout.studies[i]),n){var l=e.panels[n.panel];if(l&&l.yAxis.name==i)if((r||a!=i&&a!=s)&&!e.checkForEmptyPanel(l.name,!0,n)){e.electNewPanelOwner(l);var o=n.getYAxis(e);o.name==i&&e.electNewYAxisOwner(o)}else a!=i&&e.panels[a]||(s!=l.name&&e.modifyPanel(l,{name:s,display:t.display}),a=s)}return e.panels[a]},o.Studies.smartCreateYAxis=function(e,t,a,i,r,n){var s=r||{},l=e.getYAxisByName(t,a);if(!i&&r&&(i=r.position),["left","right","none"].indexOf(i)>-1||void 0===i&&r){if(!l||l.isShared(e))if(r instanceof o.ChartEngine.YAxis&&(a=r.name),o.extend(s,{name:a,position:i}),l||e.currentlyImporting||t==t.chart.panel||t.yAxis.studies.length||t.yAxis.renderers.length){var u=l==t.yAxis;l&&(l.name=e.electNewYAxisOwner(l));var d=l||t.yAxis;d.lockScale&&o.extend(s,{zoom:d.zoom,scroll:d.scroll,lockScale:!0}),l=e.addYAxis(t,new o.ChartEngine.YAxis(s)),u&&(t.yAxis=l)}else l=t.yAxis,o.extend(l,s);else r&&o.extend(l,r),l.position=i,l.name=a;return l}if(i&&"default"!==i&&"shared"!==i&&i!==t.yAxis.name){var p=e.getYAxisByName(t,i);return p&&l==t.yAxis&&!l.isShared(e)&&(t.yAxis=p),l&&l.isShared(e)?l.name=e.electNewYAxisOwner(l):l!==t.yAxis&&e.deleteYAxisIfUnused(t,l),p}if(!i&&n&&n.length){for(var c of(e.deleteYAxisIfUnused(t,l),n))if(l=e.getYAxisByField(t,c))return l;return null}return"shared"==i||i==t.yAxis.name||t.yAxis.allowSharing&&(!l||l.allowSharing)?(l&&(l!==t.yAxis&&l.isShared(e)?l.name=e.electNewYAxisOwner(l):(delete l.position,e.deleteYAxisIfUnused(t,l))),e.resizeChart(),t.yAxis):(o.extend(s,{name:a}),l&&(l.name=e.electNewYAxisOwner(l),!l.name&&l!==t.yAxis)?(e.deleteYAxisIfUnused(t,l),null):(!l||l.name?l=e.addYAxis(t,new o.ChartEngine.YAxis(s)):(o.extend(l,s),delete l.position),l))},o.Studies.calculateVolume=function(e,t){if("vol undr"==t.type){if(!e||!e.chart.dataSet)return;var a=e.layout,i=t.parameters.removeStudy,r=a.volumeUnderlay;a.volumeUnderlay=!i,r!=a.volumeUnderlay&&e.changeOccurred("layout"),i&&o.Studies.removeStudy(e,t)}t.outputMap={},t.outputMap.Volume=""},o.Studies.MA=function(e,t,a,i,r,n,s,l){var u=new o.Studies.StudyDescriptor(r+" "+s.name,"ma",s.panel);u.chart=s.chart,u.days=parseInt(t,10),u.startFrom=s.startFrom,l&&(u.subField=l),u.inputs={},e&&(u.inputs.Type=e),a&&(u.inputs.Field=a),i&&(u.inputs.Offset=parseInt(i,10)),o.Studies.calculateMovingAverage(n,u)},o.Studies.movingAverage={conversions:{ma:"simple",sma:"simple",ema:"exponential",tma:"triangular",vdma:"vidya",wma:"weighted",smma:"welles wilder"},translations:{simple:"Simple",exponential:"Exponential",triangular:"Triangular",vidya:"VIDYA",weighted:"Weighted","welles wilder":"Welles Wilder"},typeMap:{ema:"Exponential",exponential:"Exponential",tma:"Triangular",triangular:"Triangular",vdma:"VIDYA",vidya:"VIDYA",wma:"Weighted",weighted:"Weighted",smma:"Exponential","welles wilder":"Exponential"}},o.Studies.movingAverageHelper=function(e,t){if("options"==t){var a={};for(var i in o.Studies.movingAverage.translations)a[i]=e.translateIf(o.Studies.movingAverage.translations[i]);return a}return o.Studies.movingAverage.conversions[t]},o.Studies.createVolumeChart=function(e,t,a){var i=t.panel,r=t.inputs,n=t.underlay,s=o.Studies.determineColor(t.outputs["Up Volume"]),l=o.Studies.determineColor(t.outputs["Down Volume"]),u=n?"stx_volume_underlay":"stx_volume";e.setStyle(u+"_up","color",s),e.setStyle(u+"_down","color",l);var d=t.volumeField||"Volume",p=null,c=r.Series;c&&"Primary"!==c&&"series"!==c&&(p=d,d=c);var h=[{field:d,subField:p,fill_color_up:e.canvasStyle(u+"_up").color,border_color_up:e.canvasStyle(u+"_up").borderLeftColor,opacity_up:e.canvasStyle(u+"_up").opacity,fill_color_down:e.canvasStyle(u+"_down").color,border_color_down:e.canvasStyle(u+"_down").borderLeftColor,opacity_down:e.canvasStyle(u+"_down").opacity,color_function:t.colorFunction}],y=h[0],m={name:"Volume",panel:i,yAxis:t.getYAxis(e),widthFactor:1,bindToYAxis:!0,highlight:t.highlight};o.extend(m,t.study.parameters),o.extend(m,t.parameters),e.colorByCandleDirection&&!t.colorFunction&&(y.color_function=function(e){var t=r.Series;t&&"Primary"!==t&&"series"!==t&&(e=e[t]);var a=e.Open,i=e.Close;return{fill_color:a>i?y.fill_color_down:y.fill_color_up,border_color:a>i?y.border_color_down:y.border_color_up}}),e.drawHistogram(m,h)},o.Studies.calculateStandardDeviation=function(e,t){var a=t.chart.scrubbed;if(a.length<t.days+1)t.error=!0;else{var i=t.inputs.Field;i&&"field"!=i||(i="Close");var r=t.inputs["Moving Average Type"];r||(r=t.inputs.Type),o.Studies.MA(r,t.days,i,t.inputs.Offset,"_MA",e,t);var n=0,s=0,l=0,u=Number(t.inputs["Standard Deviations"]);u<0&&(u=2);var d,p,c,h=t.name;for(var y in t.outputs)h=y+" "+h;for(d=t.startFrom-1,c=0;d>=0&&c<t.days;d--,c++)null===(p=o.Studies.getQuoteFieldValue(a[d],i,t.subField))&&(p=0),n+=Math.pow(p,2),s+=p;for(d=t.startFrom;d<a.length;d++){var m=a[d];if(null===(p=o.Studies.getQuoteFieldValue(m,i,t.subField))&&(p=0),n+=Math.pow(p,2),s+=p,!(d<t.days-1)){if(d>=t.days){var f=o.Studies.getQuoteFieldValue(a[d-t.days],i,t.subField);null===f&&(f=0),n-=Math.pow(f,2),s-=f}((l=m["_MA "+t.name])||0===l)&&(m[h]=Math.sqrt((n+t.days*Math.pow(l,2)-2*l*s)/t.days)*u)}}}},o.Studies.calculateMovingAverage=function(e,t){if(t.chart.scrubbed){var a=t.inputs.Type;"ma"!=a&&"sma"!=a&&a||(a="simple");var i=o.Studies.movingAverage.typeMap;if(a in i)return o.Studies["calculateMovingAverage"+i[a]](e,t);if("simple"===a){var r=t.chart.scrubbed,n=0,s=[],l=t.name;for(var u in t.outputs)l=u+" "+l;var d=t.inputs.Field;d&&"field"!=d||(d="Close");var p=parseInt(t.inputs.Offset,10);isNaN(p)&&(p=0);var c,h,y,m=t.startFrom,f=p;for(c=t.startFrom-1;c>=0;c--)if(null!==(h=o.Studies.getQuoteFieldValue(r[c],d,t.subField)))if(f>0)f--,m=c;else{if(s.length==t.days-1)break;n+=h,s.unshift(h)}s.length<t.days-1&&(s=[],m=0);var v=[];for(c=m;c<r.length;c++){var g=r[c];h=o.Studies.getQuoteFieldValue(g,d,t.subField);var S=c+p>=0&&c+p<r.length?r[c+p]:null;if(null!==h){n+=h,s.push(h),s.length>t.days&&(n-=s.shift());var x=s.length==t.days?n/t.days:null;S?S[l]=x:c+p>=r.length&&((y={})[l]=x,v.push(y))}else S?S[l]=null:c+p>=r.length&&((y={})[l]=null,v.push(y))}t.appendFutureTicks(e,v)}}},o.Studies.calculateMovingAverageExponential=function(e,t){var a=t.inputs.Type,i=t.chart.scrubbed,r=0,n=0,s=0,l=2/(t.days+1);"welles wilder"!==a&&"smma"!==a||(l=1/t.days);var u=null,d=t.name;for(var p in t.outputs)d=p+" "+d;var c=t.inputs.Field;c&&"field"!=c||(c="Close");var h,y,m=parseInt(t.inputs.Offset,10);isNaN(m)&&(m=0);var f=t.startFrom,v=m;for(h=t.startFrom-1;h>=0;h--)if((y=i[h][d])||0===y){if(null===u&&(u=y),s=t.days,v<=0)break;v--,f=h}null===u&&(u=f=0);var g=[];for(h=f;h<i.length;h++){var S=i[h];y=o.Studies.getQuoteFieldValue(S,c,t.subField);var x,b=h+m>=0&&h+m<i.length?i[h+m]:null;if(null===y?x=null:(s==t.days-1?x=n=(r+=y)/t.days:s<t.days-1?(n=(r+=y)/(s+1),x=null):0===s?(n=r+=y,x=null):(u||0===u)&&(x=n=(y-u)*l+u),u=n,s++),b)b[d]=x;else if(h+m>=i.length){var A={};A[d]=x,g.push(A)}}t.appendFutureTicks(e,g)},o.Studies.calculateMovingAverageVIDYA=function(e,t){t.inputs.Type;var a=t.chart.scrubbed,i=2/(t.days+1),r=null,n=t.name;for(var s in t.outputs)n=s+" "+n;var l=t.inputs.Field;l&&"field"!=l||(l="Close"),t.std=new o.Studies.StudyDescriptor(t.name,"sdev",t.panel),t.std.chart=t.chart,t.std.days=5,t.std.startFrom=t.startFrom,t.std.inputs={Field:l,"Standard Deviations":1,Type:"ma"},t.std.outputs={_STD:null},o.Studies.calculateStandardDeviation(e,t.std),o.Studies.MA("ma",20,"_STD "+t.name,0,"_MASTD",e,t);var u,d,p,c=parseInt(t.inputs.Offset,10);isNaN(c)&&(c=0);var h=t.startFrom,y=c;for(u=t.startFrom-1;u>=0;u--)if((d=a[u][n])||0===d){if(null===r&&(r=d),y<=0)break;y--,h=u}null===r&&(r=h=0);var m=[];for(u=h;u<a.length;u++){var f=a[u];d=o.Studies.getQuoteFieldValue(f,l,t.subField);var v=u+c>=0&&u+c<a.length?a[u+c]:null;if(null!==d){if(f["_MASTD "+t.name]||0===f["_MASTD "+t.name]){var g=f["_STD "+t.name]/f["_MASTD "+t.name],S=i*g*d+(1-i*g)*r;r=S,u<t.days&&(S=null),v?v[n]=S:u+c>=a.length&&((p={})[n]=S,m.push(p))}}else v?v[n]=null:u+c>=a.length&&((p={})[n]=null,m.push(p))}t.appendFutureTicks(e,m)},o.Studies.calculateMovingAverageTriangular=function(e,t){var a=t.chart.scrubbed,i=t.inputs.Field;i&&"field"!=i||(i="Close");var r=Math.ceil(t.days/2);o.Studies.MA("simple",r,i,0,"TRI1",e,t),t.days%2==0&&r++,o.Studies.MA("simple",r,"TRI1 "+t.name,0,"TRI2",e,t);var n=t.name;for(var s in t.outputs)n=s+" "+n;var l=parseInt(t.inputs.Offset,10);isNaN(l)&&(l=0);for(var u=l,d=t.startFrom-1;d>=0;d--)if(null!==o.Studies.getQuoteFieldValue(a[d],n)){if(!(u>0))break;u--}var p=[];for(d++;d<a.length;d++)if(d+l>=0)if(d+l<a.length)a[d+l][n]=a[d]["TRI2 "+t.name];else{var c={};c[n]=a[d]["TRI2 "+t.name],p.push(c)}t.appendFutureTicks(e,p)},o.Studies.calculateMovingAverageWeighted=function(e,t){var a=t.chart.scrubbed,i=0,r=0,n=t.inputs.Field;n&&"field"!=n||(n="Close");var s=t.days*(t.days+1)/2,l=t.name;for(var u in t.outputs)l=u+" "+l;var d,p,c,h=parseInt(t.inputs.Offset,10);isNaN(h)&&(h=0);var y=[],m=t.startFrom,f=h;for(d=t.startFrom-1;d>=0;d--)if(null!==(p=o.Studies.getQuoteFieldValue(a[d],n,t.subField)))if(f>0)f--,m=d;else{if(y.length==t.days-1)break;y.unshift(p)}for(y.length<t.days-1&&(y=[],m=0),d=0;d<y.length;d++)i+=(d+1)*y[d],r+=y[d];var v=[];for(d=m;d<a.length;d++){var g=a[d];p=o.Studies.getQuoteFieldValue(g,n,t.subField);var S=d+h>=0&&d+h<a.length?a[d+h]:null;if(null!==p){y.push(p),y.length>t.days&&(i-=r,r-=y.shift()),i+=y.length*p,r+=p;var x=d<t.days-1?null:i/s;S?S[l]=x:d+h>=a.length&&((c={})[l]=x,v.push(c))}else S?S[l]=null:d+h>=a.length&&((c={})[l]=null,v.push(c))}t.appendFutureTicks(e,v)},o.Studies.calculateMultMA=function(e,t){const a=t.chart.scrubbed,i=[Number.MAX_VALUE];if(Object.keys(t.inputs).filter((e=>e.indexOf("Period")>-1)).forEach(((e,a)=>{i[a+1]=t.inputs[e]})),a.length<Math.min(...i)+1)return void(t.error=!0);let r=t.inputs.Field;r&&"field"!=r||(r="Close");let n=t.inputs["Moving Average Type"];n||(n="simple");let s=t.inputs.Offset||0;for(let l=1;l<i.length;l++)o.Studies.MA(n,i[l],r,s,"MA "+l,e,t)},o.Studies.calculateStudyATR=function(e,t){var a=t.chart.scrubbed,i=t.days;if(a.length<i+1)t.error=!0;else for(var r=0,n=t.name,s=Math.max(t.startFrom,1);s<a.length;s++){var l=a[s],o=a[s-1],u=l.trueRange;o["Sum True Range "+n]&&(r=o["Sum True Range "+n]),r+=u,s>i&&(r-=a[s-i]["True Range "+n]),l["True Range "+n]=u,l["Sum True Range "+n]=r,s==i?l["ATR "+n]=r/i:s>i&&(l["ATR "+n]=(o["ATR "+n]*(i-1)+u)/i)}},o.Studies.displayPSAR2=function(e,t,a){var i=e.panels[t.panel],r=t.getYAxis(e),n=r==e.chart.panel.yAxis;e.startClip(i.name);var s=t.getContext(e),l="squarewave"==t.inputs["Plot Type"];for(var u in t.outputs){var d=u+" "+t.name;s.beginPath();for(var p=e.layout.candleWidth,c=Math.max(3,Math.floor(p/4)),h=0;h<a.length;h++){var y=a[h];if(y&&null!==o.Studies.getQuoteFieldValue(y,d)){y.candleWidth&&(p=y.candleWidth),n&&y.transform&&(y=y.transform);var m=e.pixelFromBar(h,i.chart);l&&(m-=p/2);var f=e.pixelFromTransformedValue(y[t.referenceOutput?t.referenceOutput+" "+t.name:d],i,r);if(0!==h&&a[h-1]&&null!==o.Studies.getQuoteFieldValue(a[h-1],d)||s.moveTo(m,f),l){if(s.lineTo(m,f),s.lineTo(m+p,f),a[h+1]){var v=a[h+1];n&&v.transform&&(v=v.transform),null===o.Studies.getQuoteFieldValue(v,d)&&s.lineTo(m+p,e.pixelFromTransformedValue(v[t.referenceOutput?t.referenceOutput+" "+t.name:d],e.panels[t.panel],r))}}else s.moveTo(m-c/2,f),s.lineTo(m+c/2,f)}}s.lineWidth=1,t.highlight&&(s.lineWidth=3);var g=o.Studies.determineColor(t.outputs[u]);"auto"==g&&(g=e.defaultColor),s.strokeStyle=g,!t.highlight&&e.highlightedDraggable&&(s.globalAlpha*=.3),s.stroke(),s.closePath(),s.lineWidth=1}e.endClip()},o.Studies.inputAttributeDefaultGenerator=function(e){return!e&&0!==e||e.constructor!=Number?{}:Math.floor(e)==e?e>0?{min:1,step:1}:{step:1}:e>0?{min:0,step:.01}:{step:.01}},o.Studies.getMarketOffset=function({stx:e,localQuoteDate:t,shiftToDateBoundary:a}){let i;arguments.length>1&&(e=arguments[0],t=arguments[1],i=arguments[2]);const{symbol:r}=e.chart,n=o.getFn("Market.Symbology.isForexMetal")(r);let s;void 0===i&&(i=o.getFn("Market.Symbology.isForexSymbol")(r)),s=e.chart.market?i?"America/New_York":e.chart.market.market_tz:null;var l=new Date(t.getTime()+6e4*t.getTimezoneOffset());s&&-1!=s.indexOf("UTC")||(l=o.convertTimeZone(l,"UTC",s));let u=new Date(l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds()).getTime()-t.getTime();return a&&i&&(u+=60*(n?6:7)*60*1e3),u},o.Studies.getStudyList=function(e){var t={},a={};for(var i in o.extend(a,e),o.Studies.studyLibrary)a[i]||(t[o.Studies.studyLibrary[i].name]=i);return t},o.Studies.determineColor=function(e){return e?"object"==typeof e?e.color:e:null},o.Studies.calculateGenericEnvelope=function(e,t,a,i,r,n){a||(a=0),n||(n=0),i&&"field"!=i||(i="Close"),r||(r=i);var s=t.chart.scrubbed;if(s)for(var l=t.inputs.Field,u=t.startFrom;u<s.length;u++){var d=s[u];if(d){var p=o.Studies.getQuoteFieldValue(d,l),c=null!=p?p:o.Studies.getQuoteFieldValue(d,"Close"),h=o.Studies.getQuoteFieldValue(d,r,t.subField),y=o.Studies.getQuoteFieldValue(d,i);if(null!==y){var m=a*h+n;d[t.type+" Top "+t.name]=y+m,d[t.type+" Bottom "+t.name]=y-m,d[t.type+" Median "+t.name]=y,d["Bandwidth "+t.name]=y?200*m/y:0,d["%b "+t.name]=50*((c-y)/m+1)}}}},o.Studies.displayChannel=function(e,t,a){if(t.inputs["Channel Fill"]){var i={panelName:t.panel};for(var r in t.outputs){var n=r.split(" ").pop();"Top"==n||"High"==n?i.topBand=r+" "+t.name:"Bottom"==n||"Low"==n?i.bottomBand=r+" "+t.name:"Median"!=n&&"Channel"!=n||(i.color=o.Studies.determineColor(t.outputs[r]))}t.parameters&&t.parameters.opacity?i.opacity=t.parameters.opacity:i.opacity=.2;var s=e.panels[t.panel];i.skipTransform=s.name!=t.chart.name,i.yAxis=t.getYAxis(e),!t.highlight&&e.highlightedDraggable&&(i.opacity*=.3),o.prepareChannelFill(e,i)}o.Studies.displaySeriesAsLine(e,t,a)},o.Studies.initAnchorHandle=function(e,t){let{handle:a}=t;if(a)return;e.controls.anchorHandles||(e.controls.anchorHandles={});const{anchorHandles:i,chartControls:r}=e.controls;i[t.uniqueId]?({handle:a}=i[t.uniqueId]):(a=document.createElement("div"),a.classList.add("stx_anchor_handle"),a.setAttribute(t.uniqueId,""),i[t.uniqueId]={handle:a,sd:t},r&&r.parentElement.appendChild(a)),t.anchorHandle=a},o.Studies.removeAnchorHandle=function(e,t){const{handle:a}=(e.controls.anchorHandles||{})[t.uniqueId]||{};a&&(delete e.controls.anchorHandles[t.uniqueId],a.remove())},o.Studies.repositionAnchor=function(e,t){const{currentAnchorTime:a,uniqueId:i}=t,{hoverTick:r}=e.repositioningAnchorSelector||{},{dataSet:n,market:s}=e.chart;e.controls.anchorHandles||(e.controls.anchorHandles={});const{anchorHandles:l}=e.controls;let d={};if(!r&&0!==r)return;{if(r>=n.length)return;const i=!t.inputs.hasOwnProperty("Anchor Date");let l=n[r].DT;const p=o.Studies.getMarketOffset({stx:e,localQuoteDate:l,shiftToDateBoundary:!0});if(a&&i&&new Date(l.getTime()+p).getDate()!==new Date(a.getTime()+p).getDate())return;s.market_def&&s.market_def.market_tz&&(l=new u.Date(l,s.market_def.market_tz));const c=!i&&o.dateToStr(l,"YYYY-MM-dd");d={"Anchor Time":o.dateToStr(l,"HH:mm:ss")},c&&(d["Anchor Date"]=c)}const p=o.Studies.replaceStudy(e,t.inputs.id,t.type,Object.assign(t.inputs,d),t.outputs,t.parameters,t.panel);l[i]&&(l[i].sd=p),e.draw()},o.Studies.cancelRepositionAnchor=function(e){const{sd:t,tapToAdd:a}=e.repositioningAnchorSelector||{};if(!t)return;a&&o.Studies.removeStudy(e,t),e.repositioningAnchorSelector=null;const{anchorHandles:i}=e.controls;i&&i[t.uniqueId]&&(i[t.uniqueId].highlighted=!1,o.Studies.displayAnchorHandleAndLine(e,t,e.chart.dataSegment)),e.draw()},o.Studies.displayAnchorHandleAndLine=function(e,t,a){if(t.signalData&&!t.signalData.reveal)return;if(!a||!a[0])return;const i=(e.repositioningAnchorSelector||{}).sd===t,{hoverTick:r}=i&&e.repositioningAnchorSelector,{chart:n,panels:s,cy:l}=e,{market:d={},symbol:p}=n,c=s[t.panel],{top:h,right:y,left:m,height:f,subholder:v}=c,{bottom:g}=c.yAxis,{inputs:S,anchorHandle:x,currentAnchorTime:b,lineWidth:A=1}=t,{backgroundColor:D,borderLeftColor:F}=e.canvasStyle("stx_anchor_handle"),T=!S["Anchor Date"],w=o.getFn("Market.Symbology.isForexSymbol")(p),O=(r||0===r)&&(e.chart.dataSet[r]||{}).DT,C=o.Studies.getMarketOffset({stx:e,localQuoteDate:a[a.length-1].DT,shiftToDateBoundary:!0}),M=b&&O&&T&&new Date(O.getTime()+C).getDate()!==new Date(b.getTime()+C).getDate(),{floatDate:N,anchorHandles:k={}}=e.controls,I=k[t.uniqueId]||{},{highlighted:P}=I,[E,_]=d.getNormalOpen().split(":").map((e=>parseInt(e))),V=t=>{let a=t?e.tickFromDate(t,null,null,!0):r;return[e.pixelFromTick(a,n),a]},L={y0:h,y1:g,type:"line",confineToPanel:c};let[Y]=V();if(Y&&(Y-=.5,e.plotLine(Object.assign(L,{x0:Y,x1:Y,color:M?F:D,pattern:[6,6],lineWidth:1,opacity:M?.5:1})),o.efficientDOMUpdate(N.style,"visibility",""),e.updateChartAccessories()),x){let i=T?new Date(a[a.length-1].DT):o.strToDate(S["Anchor Date"]);if(d.market_def&&d.market_def.market_tz&&(i=new u.Date(i,d.market_def.market_tz)),!T){let[e,t,a]=(S["Anchor Date"]||"").split("-");a||([,e,t,a]=e.match(/([0-9]{4})([0-9]{2})([0-9]{2})/)),i.setFullYear(e,t-1,a)}let[n=0,s=0,p=0]=(S["Anchor Time"]||"").split(":");s||0===s||([,n,s,p]=n.match(/([0-9]{2})([0-9]{2})([0-9]{2})/)),i.setHours(n,s,p);const c=w&&(i.getHours()>E||i.getHours()===E&&i.getMinutes()>=_);c&&i.setDate(i.getDate()-1);let[b,F]=V(i),O=new Date(i);O.setHours(...d.getNormalClose().split(":")),c&&O.setDate(O.getDate()+1);const[C]=O&&V(O)||[];if(T&&(b>y||C>y)){let e=new Date(i);if(d)do{e.setDate(e.getDate()-1)}while(!d.isMarketDate(e));let[t,a]=V(e);t>m&&(i=e,b=t,F=a)}if(b-=.5,e.plotLine(Object.assign(L,{x0:b,x1:b,color:D,pattern:"solid",lineWidth:A,opacity:P||t.highlight?1:.5})),I.currentPixel=b,P){x.style.display="",x.style.height=Math.max(Math.min(25,f/4),8)+"px";const e=x.getBoundingClientRect(),t=Math.max(Math.min(l-e.height/2,g-3-e.height),h+3);x.style.top=t+"px",x.style.left=(r||0===r?Y:b)-e.width/2+"px",v.style.cursor="ew-resize"}else x.style.display="none",v.style.cursor="auto";t.currentAnchorTime=i,t.currentAnchorTick=F}},o.Studies.assignAliasesToStudies=function(e){const t=this;Object.entries(e).forEach((([e,a])=>(t.studyLibrary[e]||{}).alias=a))},o.Studies.studyScriptLibrary={},o.Studies.studyLibrary=o.Studies.studyLibrary||{},o.extend(o.Studies.studyLibrary,{ma:{name:"Moving Average",overlay:!0,calculateFN:o.Studies.calculateMovingAverage,inputs:{Period:50,Field:"field",Type:"ma",Offset:0},outputs:{MA:"#FF0000"}},"STD Dev":{name:"Standard Deviation",calculateFN:o.Studies.calculateStandardDeviation,inputs:{Period:14,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"True Range":{name:"True Range",calculateFN:o.Studies.calculateStudyATR,inputs:{},outputs:{"True Range":"auto"}},volume:{name:"Volume Chart",range:"0 to max",yAxis:{ground:!0},seriesFN:o.Studies.createVolumeChart,calculateFN:o.Studies.calculateVolume,inputs:{Series:"series"},attributes:{Series:{hidden:function(){return!Object.keys(this.chart.series).length}}},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"}},MACross:{name:"Moving Average Cross",overlay:!0,calculateFN:o.Studies.calculateMultMA,inputs:{"MA 1 Period":20,"MA 2 Period":50,"MA 3 Period":200,Field:"field","Moving Average Type":"ma",Offset:0},outputs:{"MA 1":"#e9088c","MA 2":"#00afed","MA 3":"#f4932f"}}})}}]);